!function t(e,i,n){function r(a,s){if(!i[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[a]={exports:{}};e[a][0].call(c.exports,function(t){var i=e[a][1][t];return r(i?i:t)},c,c.exports,t,e,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(t,e,i){"use strict";{var n=t("elements"),r=t("elements/zen"),o=t("elements/domready"),a=t("agent"),s=t("./ui"),l=t("mout/string/interpolate"),u=t("mout/string/trim"),c=t("mout/queryString/setParam"),h=s.modal,d=s.toastr,p=t("./utils/get-ajax-suffix"),f=t("./utils/flags-state"),m=t("./utils/field-validation"),g=t("./lm"),v=t("./menu");t("./configurations")}t("elements/attributes"),t("elements/events"),t("elements/delegation"),t("elements/insertion"),t("elements/traversal"),t("./fields"),t("./ui/popover"),t("./utils/ajaxify-links"),t("./utils/rAF-polyfill");var b=function(t,e,i){return function(n){var r=Math.floor(n/t),o=e+(r>1?"s":"");return""+r+" "+o+" "+i}},y=[{threshold:-31535999,handler:b(-31536e3,"year","from now")},{threshold:-2591999,handler:b(-2592e3,"month","from now")},{threshold:-604799,handler:b(-604800,"week","from now")},{threshold:-172799,handler:b(-86400,"day","from now")},{threshold:-86399,handler:function(){return"tomorrow"}},{threshold:-3599,handler:b(-3600,"hour","from now")},{threshold:-59,handler:b(-60,"minute","from now")},{threshold:-.9999,handler:b(-1,"second","from now")},{threshold:1,handler:function(){return"just now"}},{threshold:60,handler:b(1,"second","ago")},{threshold:3600,handler:b(60,"minute","ago")},{threshold:86400,handler:b(3600,"hour","ago")},{threshold:172800,handler:function(){return"yesterday"}},{threshold:604800,handler:b(86400,"day","ago")},{threshold:2592e3,handler:b(604800,"week","ago")},{threshold:31536e3,handler:b(2592e3,"month","ago")},{threshold:1/0,handler:b(31536e3,"year","ago")}],w={format:function(t){for(var e=((new Date).getTime()-t.getTime())/1e3,i=0;i<y.length;i++)if(e<y[i].threshold)return y[i].handler(e);throw new Error("exhausted all formatter options, none found")}};window.onbeforeunload=function(){return f.get("pending")?"You haven't saved your changes and by leaving the page they will be lost.\nDo you want to leave without saving?":void 0},o(function(){var t=n("body"),e="The {{type}} {{verb}} been successfully saved! {{extras}}";t.delegate("click","[data-g-close]",function(t,e){t&&t.preventDefault&&t.preventDefault();var i=e.data("g-close");i=i?e.parent(i):e,i.slideUp(function(){i.remove()})}),t.delegate("click","[data-g-extras]",function(t,e){if(t&&t.preventDefault&&t.preventDefault(),!e.PopoverDefined){{var i=e.find("[data-popover-content]")||e.siblings("[data-popover-content]");e.getPopover({style:"extras",width:220,content:r("ul").html(i.html())[0].outerHTML})}e.getPopover().show()}}),t.delegate("mousedown","[data-settings-key]",function(t,e){var i=e.data("settings-key");if(!i)return!0;var n=window.location.search,r=e.attribute("href"),o=window.location.href.split("?");o.length>1&&o[0].match(/index.php$/)&&(n="index.php"+n),n=c(r,i,btoa(n)),e.href(n)}),t.delegate("mouseover",".button-save",function(t,e){return e.lastSaved?void e.addClass("g-tooltip").addClass("g-tooltip-right").data("title","Last Saved: "+w.format(e.lastSaved)):!0}),t.delegate("click",".button-save",function(i,r){i&&i.preventDefault&&i.preventDefault(),r.hideIndicator(),r.showIndicator();var o={},s=[],c=r.data("save"),b="",y=n("[data-lm-root]")?"layout":n("[data-mm-id]")?"menu":"other",w=u(window.location.href,"#")+p();switch(y){case"layout":var k=n("[data-lm-preset]");g.layoutmanager.singles("cleanup",g.builder,!0),g.savestate.setSession(g.builder.serialize(null,!0)),o.preset=k&&k.data("lm-preset")?k.data("lm-preset"):"default",o.layout=JSON.stringify(g.builder.serialize());break;case"menu":o.menutype=n("select.menu-select-wrap").value(),o.settings=JSON.stringify(v.menumanager.settings),o.ordering=JSON.stringify(v.menumanager.ordering),o.items=JSON.stringify(v.menumanager.items),w=r.parent("form").attribute("action")+p();break;case"other":default:var x=r.parent("form");x&&"submit"==r.attribute("type")&&n(x[0].elements).forEach(function(t){t=n(t);var e=t.attribute("name"),i=t.value(),r=t.parent(".settings-param"),a=r?r.find('> input[type="checkbox"]'):null;!e||t.disabled()||a&&!a.checked()||(m(t)||s.push(t),o[e]=i)}),n("#styles")&&(b="<br />The CSS was successfully compiled!")}return s.length?(r.hideIndicator(),r.showIndicator("fa fa-fw fa-exclamation-triangle"),void d.error("Please review the fields in the page and ensure you correct any invalid one.","Invalid Fields")):("other"==y&&n(".settings-param-title, .card.settings-block > h4").hideIndicator(),t.emit("updateOriginalFields"),void a("post",w,o,function(t,i){i.body.success?(h.close(),d.success(l(e,{verb:"s"==c.slice(-1)?"have":"has",type:c,extras:b}),c+" Saved")):h.open({content:i.body.html||i.body,afterOpen:function(t){i.body.html||t.style({width:"90%"})}}),r.hideIndicator(),r.lastSaved=new Date,"layout"==y&&g.layoutmanager.updatePendingChanges(),f.set("pending",!1),f.emit("update:pending")}))}),t.delegate("click","[data-title-edit]",function(t,e){if(e=n(e),e.hasClass("disabled"))return!1;var i,r=e.siblings("[data-title-editable]")||e.previousSiblings().find("[data-title-editable]")||e.nextSiblings().find("[data-title-editable]");if(!r)return!0;i=r[0],r.text(u(r.text())),r.attribute("contenteditable",!0),i.focus();var o,a=document.createRange();a.selectNodeContents(i),o=window.getSelection(),o.removeAllRanges(),o.addRange(a),r.storedTitle=u(r.text()),r.titleEditCanceled=!1,r.emit("title-edit-start",r.storedTitle)}),t.delegate("keydown","[data-title-editable]",function(t,e){switch(e=n(e),t.keyCode){case 13:case 27:return t.stopPropagation(),27==t.keyCode&&"undefined"!=typeof e.storedTitle&&(e.text(e.storedTitle),e.titleEditCanceled=!0),e.attribute("contenteditable",null),window.getSelection().removeAllRanges(),e[0].blur(),e.emit("title-edit-exit",e.data("title-editable"),13==t.keyCode?"enter":"esc"),!1;default:return!0}}),t.delegate("blur","[data-title-editable]",function(t,e){e=n(e),e.attribute("contenteditable",null),e.data("title-editable",u(e.text())),window.getSelection().removeAllRanges(),e.emit("title-edit-end",e.data("title-editable"),e.storedTitle,e.titleEditCanceled)},!0),t.delegate("click","[data-ajax-action]",function(t,e){t&&t.preventDefault&&t.preventDefault();var i=e.attribute("href")||e.data("ajax-action"),r=e.data("ajax-action-method")||"post",o=n(e.data("ajax-action-indicator"))||e;return i?(o.showIndicator(),void a(r,i+p(),function(t,e){return e.body.success?(d.success(e.body.html||"Action successfully completed.",e.body.title||""),void o.hideIndicator()):(h.open({content:e.body.html||e.body,afterOpen:function(t){e.body.html||t.style({width:"90%"})}}),o.hideIndicator(),!1)})):!1})});var k={lm:g,mm:v,assingments:t("./assignments"),ui:t("./ui"),styles:t("./styles"),$:n,domready:t("elements/domready"),particles:t("./particles"),zen:t("elements/zen"),moofx:t("moofx")};window.G5=k,e.exports=k},{"./assignments":3,"./configurations":4,"./fields":5,"./lm":23,"./menu":27,"./particles":35,"./styles":38,"./ui":42,"./ui/popover":44,"./utils/ajaxify-links":49,"./utils/field-validation":53,"./utils/flags-state":54,"./utils/get-ajax-suffix":55,"./utils/rAF-polyfill":59,agent:61,elements:88,"elements/attributes":83,"elements/delegation":85,"elements/domready":86,"elements/events":87,"elements/insertion":89,"elements/traversal":111,"elements/zen":112,moofx:113,"mout/queryString/setParam":218,"mout/string/interpolate":229,"mout/string/trim":236}],2:[function(t,e,i){function n(){c=!1,s.length?u=s.concat(u):h=-1,u.length&&r()}function r(){if(!c){var t=setTimeout(n);c=!0;for(var e=u.length;e;){for(s=u,u=[];++h<e;)s[h].run();h=-1,e=u.length}s=null,c=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function a(){}var s,l=e.exports={},u=[],c=!1,h=-1;l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];u.push(new o(t,e)),c||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=a,l.addListener=a,l.once=a,l.off=a,l.removeListener=a,l.removeAllListeners=a,l.emit=a,l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],3:[function(t,e,i){"use strict";var n=t("elements/domready"),r=t("prime/map")(),o=t("mout/object/merge"),a=t("mout/array/forEach"),s=t("mout/string/trim"),l=t("../utils/elements.utils"),u=r,c={toggleSection:function(t,e){if(t.type.match(/^touch/)&&t.preventDefault(),e.parent("[data-g-global-filter]"))return c.globalToggleSection(t,e);if(e.matches("label"))return c.treatLabel(t,e);var i=e.parent(".card"),n=u.get(i),r=null==e.data("g-assignments-check")?0:1;if(!n||!n.inputs){var s=i.search(".enabler input[type=hidden]");n||(n=u.set(i,{inputs:s}).get(i)),n.inputs||(n=u.set(i,o(u.get(i),{inputs:s})).get(i))}a(n.inputs,function(t){t=l(t),"none"!=t.parent("label").compute("display")&&(t.value(r).emit("change"),l("body").emit("change",{target:t}))})},filterSection:function(t,e,i){if(e.parent("[data-g-global-filter]"))return c.globalFilterSection(t,e);var n=e.parent(".card"),r=u.get(n)||u.set(n,{labels:n.search("label .settings-param-title")}).get(n);if(i=i||e.value(),!r||!r.labels){var h=n.search("label .settings-param-title");r||(r=u.set(n,{labels:h}).get(n)),r.labels||(r=u.set(n,o(u.get(n),{labels:h})).get(n))}return r=l(r.labels),i?void a(r,function(t){t=l(t);var e=s(t.text());e.match(new RegExp("^"+i+"|\\s"+i,"gi"))?t.parent("label").style("display","block"):t.parent("label").style("display","none")}):r.search("!> label").style("display","block")},treatLabel:function(t,e){if(t&&t.stopPropagation&&t.preventDefault&&(t.stopPropagation(),t.preventDefault()),!l(t.target).matches(".knob, .toggle")){var i=e.find('input[type="hidden"]:not([disabled])');if(i){var n=i.value();return n=!!+n,i.value(Number(!n)).emit("change"),l("body").emit("change",{target:i}),!1}}},globalToggleSection:function(t,e){var i=null==e.data("g-assignments-check")?"[data-g-assignments-uncheck]":"[data-g-assignments-check]",n=l("#assignments .card "+i);n&&a(n,function(e){c.toggleSection(t,l(e))})},globalFilterSection:function(t,e){var i=e.value(),n=l('#assignments .card .search input[type="text"]');n&&a(n,function(e){c.filterSection(t,l(e),i)})}};n(function(){var t=l("body");t.delegate("input",'#assignments .search input[type="text"]',c.filterSection),t.delegate("click","#assignments .card label, #assignments [data-g-assignments-check], #assignments [data-g-assignments-uncheck]",c.toggleSection),t.delegate("touchend","#assignments .card label, #assignments [data-g-assignments-check], #assignments [data-g-assignments-uncheck]",c.toggleSection)}),e.exports={}},{"../utils/elements.utils":51,"elements/domready":86,"mout/array/forEach":150,"mout/object/merge":208,"mout/string/trim":236,"prime/map":258}],4:[function(t,e,i){"use strict";var n=t("elements"),r=t("elements/domready"),o=t("mout/string/trim"),a=t("../ui").modal,s=t("../ui").toastr,l=t("agent"),u=t("../utils/get-ajax-suffix"),c=t("../utils/get-ajax-url").global,h=t("../utils/flags-state"),d=c("confirmdeletion")+u(),p={};r(function(){var t=n("body");t.delegate("click","[data-g-config]",function(e,i){var r=i.data("g-config"),o=i.data("g-config-href"),p=window.btoa(o),f=(i.data("g-config-method")||"post").toLowerCase();return e&&e.preventDefault&&e.preventDefault(),"delete"!=r||h.get("free:to:delete:"+p,!1)?(i.hideIndicator(),i.showIndicator(),void l(f,o+u(),{},function(e,r){if(r.body.success){var o=n('[href="'+c("configurations")+'"]');o?t.emit("click",{target:o}):window.location=window.location,s.success(r.body.html||"Action successfully completed.",r.body.title||"")}else a.open({content:r.body.html||r.body,afterOpen:function(t){r.body.html||t.style({width:"90%"})}});i.hideIndicator()})):(h.warning({url:d,callback:function(e,r){var o=r.find("[data-g-delete-confirm]"),s=r.find("[data-g-delete-cancel]");o&&(o.on("click",function(e){return e.preventDefault(),this.attribute("disabled")?!1:(h.get("free:to:delete:"+p,!0),n([o,s]).attribute("disabled"),t.emit("click",{target:i}),void a.close())}),s.on("click",function(t){return t.preventDefault(),this.attribute("disabled")?!1:(n([o,s]).attribute("disabled"),h.get("free:to:delete:"+p,!1),void a.close())}))}}),!1)});var e=function(t,e,i){if(!i&&t!=e){var n=this,r=n.data("g-config-href"),s=(n.data("g-config-method")||"post").toLowerCase(),c=n.parent();c.showIndicator(),c.find("[data-title-edit]").addClass("disabled"),l(s,r+u(),{title:o(t)},function(t,i){i.body.success||(a.open({content:i.body.html||i.body,afterOpen:function(t){i.body.html||t.style({width:"90%"})}}),n.data("title-editable",e).text(e)),c.hideIndicator(),c.find("[data-title-edit]").removeClass("disabled")})}},i=function(t){t&&t.length&&t.forEach(function(t){t=n(t),t.confWasAttached=!0,t.on("title-edit-end",e)})};t.on("statechangeAfter",function(t,e){var r=n("#configurations [data-title-editable]");return r?(r=r.filter(function(t){return"undefined"==typeof n(t).confWasAttached}),void i(r)):!0}),i(n("#configurations [data-title-editable]"))}),e.exports=p},{"../ui":42,"../utils/flags-state":54,"../utils/get-ajax-suffix":55,"../utils/get-ajax-url":56,agent:61,elements:88,"elements/domready":86,"mout/string/trim":236}],5:[function(t,e,i){"use strict";var n,r=t("elements/domready"),o=t("elements/attributes"),a=t("prime/map"),s=t("mout/lang/deepEquals"),l=t("mout/collection/forEach"),u=(t("mout/array/invoke"),t("../utils/history")),c=t("../utils/flags-state"),h=function(t){var e=new a;if(t){var i;return t.forEach(function(t){i=o('[name="'+t+'"]'),i&&e.set(t,i.value().toLowerCase())}),e}var n=o(".settings-block [name]");return n?(n.forEach(function(t){t=o(t),e.set(t.attribute("name"),t.value())},this),e):!1},d=function(t){var e=new a;return l(t,function(t,i){e.set(i,t.toLowerCase())}),e},p={single:function(){},whole:function(){},blanks:function(){},presets:function(){}};r(function(){var t,e=o("body");n=h(),p.single=function(t,e){var i=e.parent(".settings-param")||e.parent("h4"),r=i?i.matches("h4")?i:i.find(".settings-param-title"):null,o=i?i.find(".settings-param-toggle"):!1;i&&r&&n&&null!=n.get(e.attribute("name"))&&(n.get(e.attribute("name"))!==e.value()?(o&&t.forceOverride&&!o.checked()&&o[0].click(),r.showIndicator("changes-indicator font-small fa fa-circle-o fa-fw")):(o&&t.forceOverride&&o.checked()&&o[0].click(),r.hideIndicator()),p.blanks(t,i.find(".settings-param-field")),p.whole(),p.presets())},p.whole=function(){var t=s(n,h()),e=o("[data-save]");e&&(c.set("pending",!t),e[t?"hideIndicator":"showIndicator"]("changes-indicator fa fa-circle-o fa-fw"))},p.blanks=function(t,e){if(e){var i=e.find("[name]"),n=e.find(".g-reset-field");if(!i||!n)return!0;var r=i.value();r?n.removeAttribute("style"):n.style("display","none")}},p.presets=function(){var e,i=o("[data-g-styles]");if(i){t||(t=new a,l(i,function(i,n){i=o(i),e={index:n,map:d(JSON.parse(i.data("g-styles")))},t.set(i,e)}));var n,r;t.forEach(function(t,e){n=h(t.map.keys()),r=s(n,t.map,function(t,e){return t==e}),o(o("[data-g-styles]")[t.index]).parent()[r?"addClass":"removeClass"]("g-preset-match")})}},e.delegate("input",'.settings-block input[name][type="text"], .settings-block textarea[name]',p.single),e.delegate("change",'.settings-block input[name][type="hidden"], .settings-block input[name][type="checkbox"], .settings-block select[name]',p.single),e.delegate("input",".g-urltemplate",function(t,e){var i=e.parent(".settings-param").previousSibling();if(i){i=i.find("[data-g-urltemplate]");var n=i.data("g-urltemplate");i.attribute("href",n.replace(/#ID#/g,e.value()))}}),e.delegate("mouseenter",".settings-param-field",p.blanks,!0),e.delegate("click",".g-reset-field",function(t,i){var n,r=i.parent(".settings-param-field");if(r&&(n=r.find("[name]"))){var o=n.selectizeInstance;o?o.setValue(""):n.value(""),n.emit("change"),e.emit("input",{target:n}),e.emit("keyup",{target:n})}}),e.on("statechangeEnd",function(){u.getState();e.emit("updateOriginalFields")}),e.on("updateOriginalFields",function(){n=h(),p.presets()}),p.presets()}),e.exports={compare:p,collect:h}},{"../utils/flags-state":54,"../utils/history":58,"elements/attributes":83,"elements/domready":86,"mout/array/invoke":154,"mout/collection/forEach":164,"mout/lang/deepEquals":175,"prime/map":258}],6:[function(t,e,i){"use strict";var n=t("prime"),r=t("elements"),o=t("./base"),a=t("elements/zen"),s=t("../../utils/get-ajax-url").config,l=new n({inherits:o,options:{type:"atom"},constructor:function(t){o.call(this,t),this.on("changed",this.hasChanged)},updateTitle:function(t){return this.block.find(".title").text(t),this.setTitle(t),this},layout:function(){var t=s(this.getPageId()+"/layout/"+this.getType()+"/"+this.getId()),e=this.getSubType()?'data-lm-blocksubtype="'+this.getSubType()+'"':"";return'<div class="'+this.getType()+'" data-lm-id="'+this.getId()+'" data-lm-blocktype="'+this.getType()+'" '+e+'><span><span class="title">'+this.getTitle()+'</span><span class="font-small">'+(this.getSubType()||this.getKey()||this.getType())+'</span></span><div class="float-right"><i class="fa fa-cog" data-lm-nodrag data-lm-nodrag data-lm-settings="'+t+'"></i></div></div>'},hasChanged:function(t,e){var i=this.block.find("span > i.changes-indicator:first-child");i&&e&&!e.changeState||(this.block[t?"addClass":"removeClass"]("block-has-changes"),!t&&i&&i.remove(),t&&!i&&a("i.fa.fa-circle-o.changes-indicator").before(this.block.find(".title")))},onRendered:function(t,e){var i=r('[data-lm-disabled][data-lm-subtype="'+this.getSubType()+'"]');(i||0===this.getAttribute("enabled"))&&this.disable()}});e.exports=l},{"../../utils/get-ajax-url":56,"./base":8,elements:88,"elements/zen":112,prime:257}],7:[function(t,e,i){"use strict";var n=t("prime"),r=t("./section"),o=new n({inherits:r,options:{type:"atoms",attributes:{name:"Atoms Section"}},layout:function(){return'<div class="atoms-section" data-lm-id="'+this.getId()+'" data-lm-blocktype="'+this.getType()+'"><div class="section-header clearfix"><h4 class="float-left">'+this.getAttribute("name")+"</h4></div></div>"},getId:function(){return this.id||(this.id=this.options.type)},onDone:function(t){this.block.search("[data-lm-id]")||(this.grid.insert(this.block,"bottom"),this.options.builder.add(this.grid))}});e.exports=o},{"./section":17,prime:257}],8:[function(t,e,i){"use strict";var n=t("prime"),r=t("prime-util/prime/options"),o=t("prime-util/prime/bound"),a=t("prime/emitter"),s=t("mout/random/guid"),l=t("elements/zen"),u=t("mout/string/trim"),c=t("elements"),h=t("mout/object/get"),d=t("mout/object/has"),p=t("mout/object/set");t("elements/traversal");var f=new n({mixin:[o,r],inherits:a,options:{subtype:!1,attributes:{}},constructor:function(t){return this.setOptions(t),this.fresh=!this.options.id,this.id=this.options.id||this.guid(),this.attributes=this.options.attributes||{},this.block=l("div").html(this.layout()).firstChild(),this.on("rendered",this.bound("onRendered")),this},guid:function(){return s()},getId:function(){return this.id||(this.id=this.guid())},getType:function(){return this.options.type||""},getSubType:function(){return this.options.subtype||""},getTitle:function(){return u(this.options.title||"Untitled")},setTitle:function(t){return this.options.title=u(t||"Untitled"),this},getKey:function(){return""},getPageId:function(){var t=c("[data-lm-root]");return t?t.data("lm-page"):"data-root-not-found"},getAttribute:function(t){return h(this.attributes,t)},getAttributes:function(){return this.attributes||{}},updateTitle:function(){return this},setAttribute:function(t,e){return p(this.attributes,t,e),this},setAttributes:function(t){return this.attributes=t,this},hasAttribute:function(t){return d(this.attributes,t)},disable:function(){this.block.title("This particle has been disabled and it won't be rendered on front-end. You can still configure, move and delete."),this.block.addClass("particle-disabled")},enable:function(){this.block.removeAttribute("title"),this.block.removeClass("particle-disabled")},insert:function(t,e){return this.block[e||"after"](t),this},adopt:function(t){return t.insert(this.block),this},isNew:function(t){return"undefined"!=typeof t&&(this.fresh=!!t),this.fresh},dropzone:function(){return"data-lm-dropzone"},addDropzone:function(){this.block.data("lm-dropzone",!0)},removeDropzone:function(){this.block.data("lm-dropzone",null)},layout:function(){},onRendered:function(){},setLayout:function(t){return this.block=t,this}});e.exports=f},{elements:88,"elements/traversal":111,"elements/zen":112,"mout/object/get":204,"mout/object/has":205,"mout/object/set":212,"mout/random/guid":220,"mout/string/trim":236,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256}],9:[function(t,e,i){"use strict";var n=t("prime"),r=t("./base"),o=t("../../utils/elements.utils"),a=t("elements/zen"),s=t("mout/number/enforcePrecision"),l=t("mout/function/bind"),u=new n({inherits:r,options:{type:"block",attributes:{size:100}},constructor:function(t){r.call(this,t),this.on("changed",this.hasChanged)},getSize:function(){return this.getAttribute("size")},setSize:function(t,e){t="undefined"==typeof t?this.getSize():Math.max(0,Math.min(100,parseFloat(t))),e&&this.setAttribute("size",t),o(this.block).style({flex:"0 1 "+t+"%","-webkit-flex":"0 1 "+t+"%","-ms-flex":"0 1 "+t+"%"}),this.emit("resized",t,this)},setAnimatedSize:function(t,e){t="undefined"==typeof t?this.getSize():Math.max(0,Math.min(100,parseFloat(t))),e&&this.setAttribute("size",t),o(this.block).animate({flex:"0 1 "+t+"%","-webkit-flex":"0 1 "+t+"%","-ms-flex":"0 1 "+t+"%"},l(function(){this.block.attribute("style",null),this.setSize(t)},this)),this.emit("resized",t,this)},setLabelSize:function(t){var e=this.block.find("> .particle-size");return e?void e.text(s(t,1)+"%"):!1},layout:function(){return'<div class="g-block" data-lm-id="'+this.getId()+'"'+this.dropzone()+' data-lm-blocktype="block"></div>'},onRendered:function(t,e){if(t.block.find('> [data-lm-blocktype="section"]')&&this.removeDropzone(),e){var i=e.block.parent();(i.data("lm-root")||"container"==i.data("lm-blocktype")&&i.parent().data("lm-root"))&&(a("span.particle-size").text(this.getSize()+"%").top(t.block),t.on("resized",this.bound("onResize")))}},onResize:function(t){this.setLabelSize(t)},hasChanged:function(t){var e,i=this.block.find('> [data-lm-id]:not([data-lm-blocktype="section"]):not([data-lm-blocktype="container"])');if(this.changeState=t,!i)return i=this.block.find("> .particle-size"),e=i.find("i:first-child"),!t&&e&&e.remove(),void(t&&!e&&a("i.fa.fa-circle-o.changes-indicator").top(i));var n=this.options.builder.get(i.data("lm-id"));n&&n.emit("changed",t,this)}});e.exports=u},{"../../utils/elements.utils":51,"./base":8,"elements/zen":112,"mout/function/bind":167,"mout/number/enforcePrecision":195,prime:257}],10:[function(t,e,i){"use strict";var n=t("prime"),r=t("./base"),o=(t("elements"),new n({inherits:r,options:{type:"container"},constructor:function(t){r.call(this,t)},layout:function(){return'<div class="g-lm-container" data-lm-id="'+this.getId()+'" data-lm-blocktype="container"></div>'}}));e.exports=o},{"./base":8,elements:88,prime:257}],11:[function(t,e,i){"use strict";var n=t("prime"),r=t("./base"),o=(t("elements"),t("../../utils/get-ajax-url").config,new n({inherits:r,options:{type:"grid"},constructor:function(t){r.call(this,t),this.on("changed",this.hasChanged)},layout:function(){return'<div class="g-grid nowrap" data-lm-id="'+this.getId()+'" '+this.dropzone()+'  data-lm-samewidth data-lm-blocktype="grid"></div>'},onRendered:function(){var t=this.block.parent();(t&&t.data("lm-root")||"container"==t.data("lm-blocktype")&&t.parent().data("lm-root"))&&this.removeDropzone()},hasChanged:function(t){var e=this.block.parent('[data-lm-blocktype="section"]'),i=e?e.data("lm-id"):!1;this.changeState=t,e&&i&&this.options.builder&&this.options.builder.get(i).emit("changed",t,this)}}));e.exports=o},{"../../utils/get-ajax-url":56,"./base":8,elements:88,prime:257}],12:[function(t,e,i){e.exports={base:t("./base"),atom:t("./atom"),section:t("./section"),offcanvas:t("./offcanvas"),atoms:t("./atoms"),grid:t("./grid"),container:t("./container"),block:t("./block"),particle:t("./particle"),position:t("./position"),pagecontent:t("./pagecontent"),systemmessages:t("./system-messages"),spacer:t("./spacer")}},{"./atom":6,"./atoms":7,"./base":8,"./block":9,"./container":10,"./grid":11,"./offcanvas":13,"./pagecontent":14,"./particle":15,"./position":16,"./section":17,"./spacer":18,"./system-messages":19}],13:[function(t,e,i){"use strict";var n=t("prime"),r=t("./section"),o=t("../../utils/get-ajax-url").config,a=new n({inherits:r,options:{type:"offcanvas",attributes:{name:"Offcanvas Section"}},layout:function(){var t=o(this.getPageId()+"/layout/"+this.getType()+"/"+this.getId());return'<div class="offcanvas-section" data-lm-id="'+this.getId()+'" data-lm-blocktype="'+this.getType()+'"><div class="section-header clearfix"><h4 class="float-left">'+this.getAttribute("name")+'</h4><div class="section-actions float-right"><span class="g-tooltip g-tooltip-right" data-title="Adds a new row in the offcanvas"><i class="fa fa-plus"></i></span> <span class="g-tooltip g-tooltip-right" data-title="Offcanvas settings"><i class="fa fa-cog" data-lm-settings="'+t+'"></i></span></div></div></div>'},getId:function(){return this.id||(this.id=this.options.type)}});e.exports=a},{"../../utils/get-ajax-url":56,"./section":17,prime:257}],14:[function(t,e,i){"use strict";var n=t("prime"),r=t("./particle"),o=new n({inherits:r,options:{type:"pagecontent",title:"Page Content",attributes:{}}});e.exports=o},{"./particle":15,prime:257}],15:[function(t,e,i){"use strict";var n=t("prime"),r=t("elements"),o=t("./atom"),a=(t("mout/function/bind"),t("mout/number/enforcePrecision")),s=t("../../utils/get-ajax-url").config,l=0,u=new n({inherits:o,options:{type:"particle"},constructor:function(t){++l,o.call(this,t)},layout:function(){var t=s(this.getPageId()+"/layout/"+this.getType()+"/"+this.getId()),e=this.getSubType()?'data-lm-blocksubtype="'+this.getSubType()+'"':"";return'<div class="'+this.getType()+'" data-lm-id="'+this.getId()+'" data-lm-blocktype="'+this.getType()+'" '+e+'><span><span class="title">'+this.getTitle()+'</span><span class="font-small">'+(this.getKey()||this.getSubType()||this.getType())+'</span></span><div class="float-right"><span class="particle-size"></span> <i class="fa fa-cog" data-lm-nodrag data-lm-settings="'+t+'"></i></div></div>'},setLabelSize:function(t){var e=this.block.find(".particle-size");return e?void e.text(a(t,1)+"%"):!1},onRendered:function(t,e){var i=e.getSize()||100,n=r('[data-lm-disabled][data-lm-subtype="'+this.getSubType()+'"]');(n||0===this.getAttribute("enabled"))&&this.disable(),this.setLabelSize(i),e.on("resized",this.bound("onParentResize"))},onParentResize:function(t){this.setLabelSize(t)}});e.exports=u},{"../../utils/get-ajax-url":56,"./atom":6,elements:88,"mout/function/bind":167,"mout/number/enforcePrecision":195,prime:257}],16:[function(t,e,i){"use strict";var n=t("prime"),r=t("mout/string/trim"),o=t("./particle"),a=0,s=new n({inherits:o,options:{type:"position"},constructor:function(t){++a,o.call(this,t),this.setAttribute("title",this.getTitle()),this.setAttribute("key",this.getKey()),this.isNew()&&--a},getTitle:function(){return this.options.title||"Position "+a},getKey:function(){return this.getAttribute("key")||r(this.getTitle()).replace(/\s/g,"-").toLowerCase()},updateKey:function(t){return this.options.key=t||this.getKey(),this.block.find(".font-small").text(this.getKey()),this}});e.exports=s},{"./particle":15,"mout/string/trim":236,prime:257}],17:[function(t,e,i){"use strict";var n=t("prime"),r=t("./base"),o=(t("prime-util/prime/bound"),t("./grid")),a=t("elements"),s=t("elements/zen"),l=t("mout/function/bind"),u=t("../../utils/get-ajax-url").config;t("elements/insertion");var c=0,h=new n({inherits:r,options:{},constructor:function(t){++c,this.grid=new o,r.call(this,t),this.on("done",this.bound("onDone")),this.on("changed",this.hasChanged)},layout:function(){var t=u(this.getPageId()+"/layout/"+this.getType()+"/"+this.getId());return'<div class="section" data-lm-id="'+this.getId()+'" data-lm-blocktype="'+this.getType()+'"><div class="section-header clearfix"><h4 class="float-left">'+this.getTitle()+'</h4><div class="section-actions float-right"><span class="g-tooltip g-tooltip-right" data-title="Adds a new row in the section"><i class="fa fa-plus"></i></span> <span class="g-tooltip g-tooltip-right" data-title="Section settings"><i class="fa fa-cog" data-lm-settings="'+t+'"></i></span></div></div></div>'},adopt:function(t){a(t).insert(this.block.find(".g-grid"))},hasChanged:function(t,e){var i=this.block.find("h4 > i:first-child");i&&e&&!e.changeState||(this.block[t?"addClass":"removeClass"]("block-has-changes"),!t&&i&&i.remove(),t&&!i&&s("i.fa.fa-circle-o.changes-indicator").top(this.block.find("h4")))},onDone:function(t){this.block.search("[data-lm-id]")||(this.grid.insert(this.block,"bottom"),this.options.builder.add(this.grid));var e=this.block.find(".fa-plus");e&&e.on("click",l(function(t){return t&&t.preventDefault(),this.block.find(".g-grid:last-child:empty")?!1:(this.grid=new o,this.grid.insert(this.block.find('[data-lm-blocktype="container"]')?this.block.find('[data-lm-blocktype="container"]'):this.block,"bottom"),void this.options.builder.add(this.grid))},this))}});e.exports=h},{"../../utils/get-ajax-url":56,"./base":8,"./grid":11,elements:88,"elements/insertion":89,"elements/zen":112,"mout/function/bind":167,prime:257,"prime-util/prime/bound":253}],18:[function(t,e,i){"use strict";var n=t("prime"),r=t("./particle"),o=new n({inherits:r,options:{type:"spacer",title:"Spacer",attributes:{}}});e.exports=o},{"./particle":15,prime:257}],19:[function(t,e,i){"use strict";var n=t("prime"),r=t("./pagecontent"),o=new n({inherits:r,options:{title:"System Message",attributes:{}}});e.exports=o},{"./pagecontent":14,prime:257}],20:[function(t,e,i){"use strict";var n=t("prime"),r=t("elements"),o=t("prime/emitter"),a=t("./blocks/"),s=(t("mout/object/forOwn"),t("mout/collection/forEach")),l=t("mout/collection/size"),u=(t("mout/lang/isArray"),t("mout/array/flatten"),t("mout/random/guid")),c=t("mout/object/set"),h=t("mout/object/unset"),d=t("mout/object/get"),p=t("mout/object/deepFillIn"),f=t("mout/object/omit");t("elements/attributes"),t("elements/traversal");var m=!1,g=t("mout/string/rpad"),v=t("mout/string/repeat");r.implement({empty:function(){return this.forEach(function(t){for(var e;e=t.firstChild;)t.removeChild(e)})}});var b=new n({inherits:o,constructor:function(t){return t&&this.setStructure(t),this.map={},this},setStructure:function(t){try{this.structure="object"==typeof t?t:JSON.parse(t)}catch(e){console.error("Parsing error:",e)}},add:function(t){var e="string"==typeof t?t:t.id;c(this.map,e,t),t.isNew(!1)},remove:function(t){t="string"==typeof t?t:t.id,h(this.map,t)},get:function(t){var e="string"==typeof t?t:t.id;return d(this.map,e,t)},load:function(t){return this.recursiveLoad(t),this.emit("loaded",t),this},serialize:function(t,e){var i=[];if(t=t||r("[data-lm-root]")){var n,o,a,l,u,c,h=t.search((e?"":"> ")+"[data-lm-id]");return s(h,function(t){if(t=r(t),n=t.data("lm-id"),o=t.data("lm-blocktype"),a=t.data("lm-blocksubtype")||!1,u=t.search("> [data-lm-id]"),c=e?u?u.map(function(t){return r(t).data("lm-id")}):!1:u?this.serialize(t):[],l={id:n,type:o,subtype:a,title:d(this.map,n)?d(this.map,n).getTitle():"Untitled",attributes:d(this.map,n)?d(this.map,n).getAttributes():{},children:c},e){var s={};s[n]=l,
l=s}i.push(l)},this),i}},insert:function(t,e,i){var n=r("[data-lm-root]");if(n){a[e.type]||console[console.error?"error":"log"](e.type+" does not exist");var o=new(a[e.type]||a.section)(p({id:t,attributes:{},subtype:e.subtype||!1,builder:this},f(e,"children")));return o.block.insert(i?r('[data-lm-id="'+i+'"]'):n),"block"===o.getType()&&o.setSize(),this.add(o),o.emit("rendered",o,i?d(this.map,i):null),o}},reset:function(t){this.map={},this.setStructure(t||{}),r("[data-lm-root]").empty(),this.load()},cleanupLonely:function(){var t,e=[],i=r("[data-lm-root] > .g-section > .g-grid > .g-block .g-grid > .g-block, [data-lm-root] > .g-section > .g-grid > .g-block > .g-block");if(i){var n;return i.forEach(function(i){return i=r(i),t=null,n=i.parent().hasClass("g-grid"),n&&i.siblings()?!1:(n&&(e.push(i.data("lm-id")),t=i.parent()),e.push(i.data("lm-id")),i.children().before(t?t:i),void(t?t:i).remove())}),e}},recursiveLoad:function(t,e,i,n){t=t||this.structure,i=i||0,n=n||!1,e=e||this.insert,s(t,function(t){t.id||(t.id=u()),console&&console.log&&m&&console.log(g(v("    ",i)+""+t.type,35)+" ("+g(t.id,36)+") parent: "+n),this.emit("loading",e.call(this,t.id,t,n,i)),t.children&&l(t.children)&&(i++,s(t.children,function(n){this.recursiveLoad([n],e,i,t.id)},this)),this.get(t.id).emit("done",this.get(t.id)),i--},this)}});e.exports=b},{"./blocks/":12,elements:88,"elements/attributes":83,"elements/traversal":111,"mout/array/flatten":149,"mout/collection/forEach":164,"mout/collection/size":166,"mout/lang/isArray":177,"mout/object/deepFillIn":197,"mout/object/forOwn":203,"mout/object/get":204,"mout/object/omit":211,"mout/object/set":212,"mout/object/unset":215,"mout/random/guid":220,"mout/string/repeat":233,"mout/string/rpad":234,prime:257,"prime/emitter":256}],21:[function(t,e,i){"use strict";var n=t("../ui/drag.events"),r=t("prime"),o=(t("prime/emitter"),t("prime-util/prime/bound")),a=t("prime-util/prime/options"),s=t("mout/function/bind"),l=t("mout/lang/isString"),u=t("mout/math/map"),c=t("mout/math/clamp"),h=t("mout/number/enforcePrecision"),d=t("mout/object/get"),p=t("../utils/elements.utils");t("elements/events"),t("elements/delegation");var f=new r({mixin:[o,a],DRAG_EVENTS:n,options:{minSize:5},constructor:function(t,e){this.setOptions(e),this.history=this.options.history||{},this.builder=this.options.builder||{},this.origin={x:0,y:0,transform:null,offset:{x:0,y:0}}},getBlock:function(t){return d(this.builder.map,l(t)?t:p(t).data("lm-id")||"")},getAttribute:function(t,e){return this.getBlock(t).getAttribute(e)},getSize:function(t){return this.getAttribute(p(t),"size")},start:function(t,e,i,n){if(t&&t.type.match(/^touch/i)&&t.preventDefault(),e.LMTooltip&&e.LMTooltip.remove(),t.which&&1!==t.which)return!0;t.preventDefault(),this.element=p(e),this.siblings={occupied:0,elements:i,next:this.element.nextSibling(),prevs:this.element.previousSiblings(),sizeBefore:0},this.siblings.elements.length>1&&(this.siblings.occupied-=this.getSize(this.siblings.next),this.siblings.elements.forEach(function(t){this.siblings.occupied+=this.getSize(t)},this)),this.siblings.prevs&&this.siblings.prevs.forEach(function(t){this.siblings.sizeBefore+=this.getSize(t)},this),this.origin={size:this.getSize(this.element),maxSize:this.getSize(this.element)+this.getSize(this.siblings.next),x:t.changedTouches?t.changedTouches[0].pageX:t.pageX+6,y:t.changedTouches?t.changedTouches[0].pageY:t.pageY};var r=this.element[0].getBoundingClientRect(),o=this.element.parent()[0].getBoundingClientRect();this.origin.offset={clientRect:r,parentRect:{left:o.left,right:o.right},x:this.origin.x-r.right,y:r.top-this.origin.y,down:n},this.origin.offset.parentRect.left=this.element.parent().find("> [data-lm-id]:first-child")[0].getBoundingClientRect().left,this.origin.offset.parentRect.right=this.element.parent().find("> [data-lm-id]:last-child")[0].getBoundingClientRect().right,this.DRAG_EVENTS.EVENTS.MOVE.forEach(s(function(t){p(document).on(t,this.bound("move"))},this)),this.DRAG_EVENTS.EVENTS.STOP.forEach(s(function(t){p(document).on(t,this.bound("stop"))},this))},move:function(t){t&&t.type.match(/^touch/i)&&t.preventDefault();var e=t.clientX||t.touches[0].clientX||0,i=t.clientY||t.touches[0].clientY||0,n=this.origin.offset.parentRect,r=(this.lastX||e)-e,o=(this.lastY||i)-i;this.direction=Math.abs(r)>Math.abs(o)&&r>0&&"left"||Math.abs(r)>Math.abs(o)&&0>r&&"right"||Math.abs(o)>Math.abs(r)&&o>0&&"up"||"down";var a,s=100-this.siblings.occupied,l=e+(this.siblings.prevs?this.siblings.prevs.length:this.origin.offset.x-this.origin.offset.down),d=c(l,n.left,n.right);a=u(d,n.left,n.right,0,100),a-=this.siblings.sizeBefore,a=h(c(a,this.options.minSize,this.origin.maxSize-this.options.minSize),0),s=h(s-a,0),this.getBlock(this.element).setSize(a,!0),this.getBlock(this.siblings.next).setSize(s,!0);var f=this.element.siblings(),m=f?f.length+1:1;if(3==m||6==m||7==m||8==m||9==m||11==m||12==m){var g,v=0;g=p([f,this.element]),g.forEach(function(t,e){t=this.getBlock(t),a=t.getSize(),a%1&&(a=h(100/m,0),t.setSize(a,!0)),v+=a,g.length==e+1&&100!=v&&(s=100-v,t.setSize(a+s,!0))},this)}this.lastX=e,this.lastY=i},stop:function(t){t&&t.type.match(/^touch/i)&&t.preventDefault(),this.DRAG_EVENTS.EVENTS.MOVE.forEach(s(function(t){p(document).off(t,this.bound("move"))},this)),this.DRAG_EVENTS.EVENTS.STOP.forEach(s(function(t){p(document).off(t,this.bound("move"))},this)),this.origin.size!==this.getSize(this.element)&&this.history.push(this.builder.serialize())},evenResize:function(t,e){var i,n=t.length,r=h(100/n,4);"undefined"==typeof e&&(e=!0),t.forEach(function(t){t=p(t),i=this.getBlock(t),i&&i.hasAttribute("size")?i[e?"setAnimatedSize":"setSize"](r,r!==i.getSize()):t&&t[e?"animate":"style"]({flex:"0 1 "+r+"%"})},this)}});e.exports=f},{"../ui/drag.events":40,"../utils/elements.utils":51,"elements/delegation":85,"elements/events":87,"mout/function/bind":167,"mout/lang/isString":185,"mout/math/clamp":189,"mout/math/map":191,"mout/number/enforcePrecision":195,"mout/object/get":204,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256}],22:[function(t,e,i){var n=t("prime"),r=t("prime/emitter"),o=t("mout/array/slice"),a=t("mout/object/merge"),s=t("mout/lang/deepEquals"),l=new n({inherits:r,constructor:function(t){this.index=0,t=a({},t),this.setSession(t)},undo:function(){if(this.index){this.index--;var t=this.get();return this.emit("undo",t,this.index),t}},redo:function(){if(this.index!=this.session.length-1){this.index++;var t=this.get();return this.emit("redo",t,this.index),t}},reset:function(){this.index=0;var t=this.get();return this.emit("reset",t,this.index),t},push:function(t){t=a({},t);var e=this.index<this.session.length-1;return this.index<this.session.length-1&&(this.session=o(this.session,0,-(this.session.length-1-this.index))),t={time:+new Date,data:t},this.equals(t.data)?t:(this.session.push(t),this.index=this.session.length-1,this.emit("push",t,this.index,e),t)},get:function(t){return this.session[t||this.index]||!1},equals:function(t,e){return e||(e=this.get().data),s(t,e)},setSession:function(t){return t=t?[{time:+new Date,data:a({},t)}]:[],this.session=t,this.index=0,this.session},"import":function(){},"export":function(){}});e.exports=l},{"mout/array/slice":159,"mout/lang/deepEquals":175,"mout/object/merge":208,prime:257,"prime/emitter":256}],23:[function(t,e,i){"use strict";var n=t("elements/domready"),r=t("elements/attributes"),o=t("../ui").modal,a=t("../ui").toastr,s=t("agent"),l=t("elements/zen"),u=t("mout/array/contains"),c=t("mout/collection/size"),h=t("mout/string/trim"),d=t("mout/collection/forEach"),p=t("../utils/get-ajax-suffix"),f=t("./builder"),m=(t("../utils/history"),t("../utils/field-validation")),g=t("./history"),v=t("./layoutmanager"),b=t("../utils/save-state");t("../ui/popover");var y,w,k,x;y=new f,k=new g,x=new b,n(function(){var t=r("body");t.delegate("click","[data-lm-back]",function(t,e){return t&&t.preventDefault(),r(e).hasClass("disabled")?!1:void k.undo()}),t.delegate("click","[data-lm-forward]",function(t,e){return t&&t.preventDefault(),r(e).hasClass("disabled")?!1:void k.redo()}),k.on("push",function(t,e,i){var n={back:r("[data-lm-back]"),forward:r("[data-lm-forward]")};e&&n.back&&n.back.hasClass("disabled")&&n.back.removeClass("disabled"),i&&n.forward&&!n.forward.hasClass("disabled")&&n.forward.addClass("disabled"),w.updatePendingChanges()}),k.on("undo",function(t,e){var i=r("#lm-no-layout"),n={back:r("[data-lm-back]"),forward:r("[data-lm-forward]")};i&&i.style({display:c(t.data)?"none":"block"}),y.reset(t.data),n.forward.removeClass("disabled"),e||n.back.addClass("disabled"),w.singles("disable"),w.updatePendingChanges()}),k.on("redo",function(t,e){var i=r("#lm-no-layout"),n={back:r("[data-lm-back]"),forward:r("[data-lm-forward]")};i&&i.style({display:c(t.data)?"none":"block"}),y.reset(t.data),n.back.removeClass("disabled"),e==this.session.length-1&&n.forward.addClass("disabled"),w.singles("disable"),w.updatePendingChanges()})}),n(function(){var t,i=r("body"),n=r("[data-lm-root]");w=new v("body",{delegate:'[data-lm-root] .g-grid > .g-block > [data-lm-blocktype]:not([data-lm-nodrag]) !> .g-block, .g5-lm-particles-picker [data-lm-blocktype], [data-lm-root] [data-lm-blocktype="section"] > [data-lm-blocktype="grid"]:not(:empty):not(.no-move):not([data-lm-nodrag]), [data-lm-root] [data-lm-blocktype="section"] > [data-lm-blocktype="container"] > [data-lm-blocktype="grid"]:not(:empty):not(.no-move):not([data-lm-nodrag]), [data-lm-root] [data-lm-blocktype="offcanvas"] > [data-lm-blocktype="grid"]:not(:empty):not(.no-move):not([data-lm-nodrag]), [data-lm-root] [data-lm-blocktype="offcanvas"] > [data-lm-blocktype="container"] > [data-lm-blocktype="grid"]:not(:empty):not(.no-move):not([data-lm-nodrag])',droppables:"[data-lm-dropzone]",exclude:".section-header .button, .lm-newblocks .float-right .button, [data-lm-nodrag]",resize_handles:"[data-lm-root] .g-grid > .g-block:not(:last-child)",builder:y,history:k,savestate:x}),e.exports.layoutmanager=w,n&&(t=JSON.parse(n.data("lm-root")),t.name&&(t=t.layout),y.setStructure(t),y.load(),w.history.setSession(y.serialize()),w.savestate.setSession(y.serialize(null,!0))),i.delegate("click",".g-tabs a",function(t,e){return t.preventDefault(),!1}),i.delegate("mouseup",".g-tabs a",function(t,e){e=r(e),t.preventDefault();var i=0,n=e.parent(".g-tabs"),o=n.siblings(".g-panes"),a=n.search("a");a.forEach(function(t,n){t==e[0]&&(i=n+1)}),o.find(".active").removeClass("active"),n.find(".active").removeClass("active"),o.find(".g-pane:nth-child("+i+")").addClass("active"),n.find("li:nth-child("+i+")").addClass("active")}),i.delegate("statechangeBefore","[data-g5-lm-picker]",function(){o.close()}),i.on("statechangeAfter",function(e,i){return(n=r("[data-lm-root]"))?(t=JSON.parse(n.data("lm-root")),y.setStructure(t),y.load(),w.history.setSession(y.serialize()),w.savestate.setSession(y.serialize(null,!0)),w.eraser.element=r("[data-lm-eraseblock]"),void w.eraser.hide()):!0}),i.delegate("input",".sidebar-block .search input",function(t,e){var i,n,o=r(e).value().toLowerCase(),a=r(".sidebar-block [data-lm-blocktype]");return a?void a.style({display:"none"}).forEach(function(t){t=r(t),n=t.data("lm-blocktype").toLowerCase(),i=h(t.text()).toLowerCase(),(n.substr(0,o.length)==o||i.match(o))&&t.style({display:"block"})},this):!1}),i.delegate("click","[data-lm-samewidth]:not(:empty)",function(t,e){e.LMTooltip&&e.LMTooltip.remove();var i=e[0].getBoundingClientRect();if(!(t.clientX<i.width+i.left)){var n,o=e.search('> [data-lm-blocktype="block"]');o&&1!=o.length&&(o.forEach(function(t){n=r(t).data("lm-id"),y.get(n).setSize(100/o.length,!0)}),k.push(y.serialize()))}}),i.delegate("mouseover","[data-lm-samewidth]:not(:empty)",function(t,e){var i=e[0].getBoundingClientRect(),n=t.clientX||t.touches&&t.touches[0].clientX||0,r={equalize:n+5>i.width+i.left,move:n-5<i.left};if(r.equalize||r.move){var o=r.equalize?"Equalize the width the blocks in this grid":"Sort or Move the Grid",a=l('span.g-tooltip.g-tooltip-force[data-title="'+o+'"]').top(e);r.equalize&&a.addClass("g-tooltip-right"),a.style({position:"absolute",top:26}).style(r.equalize?"right":"left",-30),e.LMTooltip=a}}),i.delegate("mouseout","[data-lm-samewidth]:not(:empty)",function(t,e){e.LMTooltip&&e.LMTooltip.remove()}),i.delegate("click","[data-lm-clear]",function(t,e){t&&t.preventDefault&&t.preventDefault();var i,n;d(y.map,function(t,e){i=t.getType(),n=t.block.find("> [data-lm-id]"),n&&(n=n.data("lm-blocktype")),u(["particle","grid","block"],i)&&"block"==i&&n&&"section"!==n&&"container"!==n&&(y.remove(e),t.block.remove())},this),w.singles("cleanup",y),k.push(y.serialize())}),i.delegate("mouseover","[data-lm-switcher]",function(t,e){if(t&&t.preventDefault&&t.preventDefault(),!e.PopoverDefined){e.getPopover({type:"async",url:e.data("lm-switcher")+p(),allowElementsClick:".g-tabs a"})}}),i.delegate("mousedown","[data-switch]",function(t,e){return t&&t.preventDefault&&t.preventDefault(),e.parent(".g5-popover-content").find("[data-switch] i")?!1:(e.showIndicator(),void s("get",e.data("switch")+p(),function(t,i){if(e.hideIndicator(),!i.body.success)return void o.open({content:i.body.html||i.body,afterOpen:function(t){i.body.html||t.style({width:"90%"})}});var a=i.body.preset||"default",s=i.body.title||"Default",l=i.body.data,u=r("#lm-no-layout"),c=r(".layout-title .title small");n.data("lm-root",JSON.stringify(l)).empty(),n.data("lm-preset",a),u&&u.style({display:"none"}),c&&c.text("("+s+")"),y.setStructure(l),y.load(),k.push(y.serialize()),r("[data-lm-switcher]").getPopover().hide()}))}),i.delegate("click","[data-lm-settings]",function(t,e){e=r(e);var i,n=e.data("lm-blocktype"),l=e.data("lm-settings"),d=null;if("grid"===n){var f=t.clientX||t.touches&&t.touches[0].clientX||0,g=e[0].getBoundingClientRect();if(f+4-g.left<g.width)return!1}e=e.parent("[data-lm-blocktype]"),i=e.parent("[data-lm-blocktype]"),n=e.data("lm-blocktype");var v=e.data("lm-id"),b=i?i.data("lm-id"):!1;u(["block","grid"],n)||(d={},d.type=y.get(e.data("lm-id")).getType()||e.data("lm-blocktype")||!1,d.subtype=y.get(e.data("lm-id")).getSubType()||e.data("lm-blocksubtype")||!1,d.title=(e.find("h4")||e.find(".title")).text()||d.type||"Untitled",d.options=y.get(e.data("lm-id")).getAttributes()||{},d.block=i?y.get(i.data("lm-id")).getAttributes()||{}:{},d.type||delete d.type,d.subtype||delete d.subtype),o.open({content:"Loading",method:"post",data:d,remote:l+p(),remoteLoaded:function(t,e){var i=e.elements.content.find("form"),n=e.elements.content.find('input[type="submit"], button[type="submit"]'),l=[],u=[];return i&&n?void n.on("click",function(t){t.preventDefault(),l=[],u=[],n.hideIndicator(),n.showIndicator(),r(i[0].elements).forEach(function(t){t=r(t);var e=t.attribute("name"),i="checkbox"==t.type()?Number(t.checked()):t.value(),n=t.parent(".settings-param"),o=n?n.find('> input[type="checkbox"]'):null;!e||t.disabled()||o&&!o.checked()||(m(t)||u.push(t),l.push(e+"="+encodeURIComponent(i)))});var d=e.elements.content.find("[data-title-editable]");return d&&l.push("title="+encodeURIComponent(h(d.data("title-editable")))),u.length?(n.hideIndicator(),n.showIndicator("fa fa-fw fa-exclamation-triangle"),void a.error("Please review the fields in the modal and ensure you correct any invalid one.","Invalid Fields")):void s(i.attribute("method"),i.attribute("action")+p(),l.join("&")||{},function(t,e){if(e.body.success){var i=y.get(v),r=null;if(i.setAttributes(e.body.data.options),i.hasAttribute("enabled")&&i[i.getAttribute("enabled")?"enable":"disable"](),"section"!=i.getType()&&(i.setTitle(e.body.data.title||"Untitled"),i.updateTitle(i.getTitle())),"position"==i.getType()&&i.updateKey(),e.body.data.block&&c(e.body.data.block)){r=y.get(b);var s,l=r.block.nextSibling()||r.block.previousSibling(),u=r.getSize();r.setAttributes(e.body.data.block),s=u-r.getSize(),r.setAnimatedSize(r.getSize()),l&&(l=y.get(l.data("lm-id")),l.setAnimatedSize(parseFloat(l.getSize())+s,!0))}k.push(y.serialize()),o.close(),a.success('The particle "'+i.getTitle()+'" settings have been applied to the Layout. <br />Remember to click the Save button to store them.',"Settings Applied")}else o.open({content:e.body.html||e.body,afterOpen:function(t){e.body.html||t.style({width:"90%"})}});n.hideIndicator()})}):!0}})})}),e.exports={$:r,builder:y,layoutmanager:w,history:k,savestate:x}},{"../ui":42,"../ui/popover":44,"../utils/field-validation":53,"../utils/get-ajax-suffix":55,"../utils/history":58,"../utils/save-state":60,"./builder":20,"./history":22,"./layoutmanager":24,agent:61,"elements/attributes":83,"elements/domready":86,"elements/zen":112,"mout/array/contains":142,"mout/collection/forEach":164,"mout/collection/size":166,"mout/string/trim":236}],24:[function(t,e,i){"use strict";var n=t("prime"),r=t("../utils/elements.utils"),o=t("mout/function/bind"),a=t("elements/zen"),s=t("prime/emitter"),l=t("prime-util/prime/bound"),u=t("prime-util/prime/options"),c=t("./blocks"),h=t("../ui/drag.drop"),d=t("../ui/eraser"),p=t("../utils/flags-state"),f=t("./drag.resizer"),m=t("mout/object/get"),g=t("mout/object/keys"),v=(t("mout/array/every"),t("mout/number/enforcePrecision")),b=(t("mout/lang/isArray"),t("mout/lang/deepEquals")),y=t("mout/collection/find"),w=(t("mout/lang/isObject"),{disable:function(){var t=r('[data-lm-root] [data-lm-blocktype="grid"]');t&&t.removeClass("no-hover")},enable:function(){var t=r('[data-lm-root] [data-lm-blocktype="grid"]');t&&t.addClass("no-hover")},cleanup:function(t,e){var i=r('[data-lm-blocktype="section"] > .g-grid:empty, [data-lm-blocktype="container"] > .g-grid:empty, [data-lm-blocktype="offcanvas"] > .g-grid:empty');i&&i.forEach(function(i){i=r(i),(i.nextSibling("[data-lm-id]")||e)&&(t.remove(i.data("lm-id")),i.remove())})}}),k=new n({mixin:[l,u],inherits:s,constructor:function(t,e){t&&(this.dragdrop=new h(t,e),this.resizer=new f(t,e),this.eraser=new d("[data-lm-eraseblock]",e),this.dragdrop.on("dragdrop:start",this.bound("start")).on("dragdrop:location",this.bound("location")).on("dragdrop:nolocation",this.bound("nolocation")).on("dragdrop:resize",this.bound("resize")).on("dragdrop:stop:erase",this.bound("removeElement")).on("dragdrop:stop",this.bound("stop")).on("dragdrop:stop:animation",this.bound("stopAnimation")),this.builder=e.builder,this.history=e.history,this.savestate=e.savestate||null,w.disable())},singles:function(t,e,i){w[t](e,i)},updatePendingChanges:function(){var t=this.savestate.getData(),e=this.builder.serialize(null,!0),i=!1,n=b(t,e),o=r('[data-save="Layout"]'),a=(o.find("i"),o.find(".changes-indicator"));n&&a&&o.hideIndicator(),n||a||o.showIndicator("changes-indicator fa fa-fw fa-circle-o"),p.set("pending",!n);var s,l,u;e.forEach(function(n){u=g(n)[0],s=y(t,function(t){return t[u]}),l=y(e,function(t){return t[u]}),i=!b(s,l),u=this.builder.get(u),u&&u.emit("changed",i)},this)},start:function(t,e){var i=r("[data-lm-root]"),n=r(e).position();this.block=null,this.mode=i.data("lm-root")||"page",i.addClass("moving");var o=r(e).data("lm-blocktype"),s=e[0].cloneNode(!0);if(this.placeholder||(this.placeholder=a("div.block.placeholder[data-lm-placeholder]")),this.placeholder.style({display:"none"}),this.original=r(s).after(e).style({display:"block",opacity:.5}).addClass("original-placeholder").data("lm-dropzone",null),"grid"===o&&this.original.style({display:"flex"}),this.originalType=o,this.block=m(this.builder.map,e.data("lm-id")||"")||new c[o]({builder:this.builder,subtype:e.data("lm-subtype"),title:e.text()}),this.block.isNew()){var l=e.position(),u={top:e.parent()[0].scrollTop,left:e.parent()[0].scrollLeft};this.original.style({position:"absolute",opacity:.5}).style({left:e[0].offsetLeft-u.left,top:e[0].offsetTop-u.top,width:l.width,height:l.height}),this.element=this.dragdrop.element,this.dragdrop.element=this.original}else{if(e.style({position:"absolute",zIndex:1500,opacity:.5,margin:0,width:Math.ceil(n.width),height:Math.ceil(n.height)}).find("[data-lm-blocktype]"),"grid"===this.block.getType()){var h=this.block.block.siblings(":not(.original-placeholder):not(.section-header):not(:empty)");h&&h.search("[data-lm-id]").style({"pointer-events":"none"})}this.placeholder.before(e),this.eraser.show()}var d;"grid"===o&&(d=i.search('[data-lm-dropzone]:not([data-lm-blocktype="grid"])'))&&d.style({"pointer-events":"none"}),w.enable()},location:function(t,e,i){i=r(i),(this.block.isNew()?this.element:this.original).style({transform:"translate(0, 0)"}),this.placeholder||(this.placeholder=a("div.block.placeholder[data-lm-placeholder]").style({display:"none"}));var n,o=i.data("lm-blocktype"),s=this.block.getType();if(!o&&i.data("lm-root")&&(o="root"),!("page"!==this.mode&&"section"===o||"grid"===o&&(i.parent().data("lm-root")||"container"===i.parent().data("lm-blocktype")&&i.parent().parent().data("lm-root")))){var l=':not(.placeholder):not([data-lm-id="'+this.original.data("lm-id")+'"])',u={before:this.original.previousSiblings(l),after:this.original.nextSiblings(l)};if(u.before&&(u.before=r(u.before[0])),u.after&&(u.after=r(u.after[0])),!("block"===o&&(u.before===i&&"after"===e.x||u.after===i&&"before"===e.x)||"grid"===o&&(u.before===i&&"below"===e.y||u.after===i&&"above"===e.y))){var c=i.parent('[data-lm-blocktype="atoms"]'),h=this.block.block.find("[data-lm-id]");if("atom"==(h?h.data("lm-blocktype"):s)){if(!c)return}else if(c)return;var d;switch(o){case"root":case"section":break;case"grid":var p=!i.children(":not(.placeholder)");if("grid"!==s&&!p)return;p?"grid"===s?this.placeholder.before(i):this.placeholder.bottom(i):(d="above"===e.y?"before":"after",this.placeholder[d](i));break;case"block":d="above"===e.y?"top":"bottom",n="other"===e.x?d:e.x,this.placeholder[n](i)}if(this.placeholder.removeClass("in-between").removeClass("in-between-grids").removeClass("in-between-grids-first").removeClass("in-between-grids-last"),this.placeholder.style({display:"block"})["block"!==o?"removeClass":"addClass"]("in-between"),"grid"===s&&"grid"===o){var f=this.placeholder.nextSibling(),m=this.placeholder.previousSibling();this.placeholder.addClass("in-between-grids"),m&&!m.data("lm-blocktype")&&this.placeholder.addClass("in-between-grids-first"),f&&f.data("lm-blocktype")||this.placeholder.addClass("in-between-grids-last")}}}},nolocation:function(t){if((this.block.isNew()?this.element:this.original).style({transform:"translate(0, 0)"}),this.placeholder&&this.placeholder.remove(),this.block){var e=t.type.match(/^touch/i)?document.elementFromPoint(t.touches.item(0).clientX,t.touches.item(0).clientY):t.target;this.block.isNew()||(e=r(e),e.matches(this.eraser.element)||this.eraser.element.find(e)?(this.dragdrop.removeElement=!0,this.eraser.over()):(this.dragdrop.removeElement=!1,this.eraser.out()))}},resize:function(t,e,i,n){this.resizer.start(t,e,i,n)},removeElement:function(t,e){this.dragdrop.removeElement=!1;var i={opacity:0};e.animate(i,{duration:"150ms"});var n,a=r("[data-lm-root]");"grid"===this.block.getType()&&(n=a.search('[data-lm-dropzone]:not([data-lm-blocktype="grid"])'))&&n.style({"pointer-events":"inherit"});var s=this.block.block.siblings(":not(.original-placeholder)");if(s&&"block"==this.block.getType()){var l,u,c,h=this.block.getSize(),d=h/s.length,p=0;s.forEach(function(t,e){t=r(t),u=m(this.builder.map,t.data("lm-id")),e+1==s.length&&(c=u),l=v(u.getSize()+d,0),p+=l,u.setSize(l,!0)},this),100!=p&&c&&(h=c.getSize(),d=100-p,c.setSize(h+d,!0))}this.eraser.hide(),this.dragdrop.DRAG_EVENTS.EVENTS.MOVE.forEach(o(function(t){r("body").off(t,this.dragdrop.bound("move"))},this)),this.dragdrop.DRAG_EVENTS.EVENTS.STOP.forEach(o(function(t){r("body").off(t,this.dragdrop.bound("deferStop"))},this)),this.builder.remove(this.block.getId());var f=this.block.block.search("[data-lm-id]");f&&f.length&&f.forEach(function(t){this.builder.remove(r(t).data("lm-id"))},this),this.block.block.remove(),this.placeholder&&this.placeholder.remove(),this.original&&this.original.remove(),this.element=this.block=null,w.disable(),w.cleanup(this.builder),this.history.push(this.builder.serialize()),a.removeClass("moving")},stop:function(t,e){var i=r(this.dragdrop.lastOvered);if(i&&i.matches(this.eraser.element.find(".trash-zone")))return void this.eraser.hide();if("grid"===this.block.getType()){var n=this.block.block.siblings(":not(.original-placeholder):not(.section-header):not(:empty)");n&&n.search("[data-lm-id]").style({"pointer-events":"inherit"})}if(this.block.isNew()||this.eraser.hide(),!this.dragdrop.matched)return void(this.placeholder&&this.placeholder.remove());e=r(e);var o,a,s=!1,l=this.block.isNew(),u=this.block.getType(),h=e.data("lm-id"),d=h?m(this.builder.map,h)?m(this.builder.map,h).getType():e.data("lm-blocktype"):!1,p=this.placeholder.parent();if(p){var f=p.data("lm-id"),g=m(this.builder.map,f||"")?m(this.builder.map,f).getType():!1,v=!1;if(this.original.remove(),"block"!==u&&"grid"!==u&&("section"===d||"grid"===d||"block"===d&&"block"!==g)&&(o=new c.block({builder:this.builder}).adopt(this.block.block),a=new c[u]({id:this.block.block.data("lm-id"),type:u,subtype:this.element.data("lm-blocksubtype"),title:this.element.text(),builder:this.builder}).setLayout(this.block.block),o.setSize(),this.block=o,this.builder.add(o),this.builder.add(a),a.emit("rendered",a,o),o.emit("rendered",o,null),v={"case":1}),"block"===this.originalType&&"block"===this.block.getType()){v={"case":3};var b=this.block.block.parent('[data-lm-blocktype="grid"]'),y=this.placeholder.parent('[data-lm-blocktype="grid"]');y!==b&&(s={from:this.block.block.siblings(":not(.placeholder)"),to:this.placeholder.siblings(":not(.placeholder)")}),b.find('!> [data-lm-blocktype="container"]')&&(b=b.parent()),b=b.siblings(":not(.original-placeholder)"),!this.block.isNew()&&b.length&&this.resizer.evenResize(b),this.block.block.attribute("style",null),this.block.setSize()}if("grid"===u&&!n){var k=this.block.block.parent('[data-lm-blocktype="section"]').find(".fa-plus");k&&k.emit("click")}if(this.block.hasAttribute("size")&&this.block.setSize(this.placeholder.compute("flex")),this.block.insert(this.placeholder),this.placeholder.remove(),l&&(v&&this.resizer.evenResize(r([this.block.block,this.block.block.siblings()])),this.element.attribute("style",null)),s.from||s.to&&s.to!=this.block.block){var x,S,C=this.block.getSize();s.to||this.block.setSize(100,!0),s.from&&(x=C/s.from.length,s.from.forEach(function(t){t=r(t),S=m(this.builder.map,t.data("lm-id")),S.setSize(S.getSize()+x,!0)},this)),s.to&&(C=100/(s.to.length+1),s.to.forEach(function(t){t=r(t),S=m(this.builder.map,t.data("lm-id")),S.setSize(C,!0)},this),this.block.setSize(C,!0))}w.disable(),w.cleanup(this.builder),this.history.push(this.builder.serialize())}},stopAnimation:function(t){var e=r("[data-lm-root]");if(e.removeClass("moving"),this.original&&this.original.remove(),w.disable(),this.block||(this.block=m(this.builder.map,t.data("lm-id"))),this.block&&"block"===this.block.getType()&&this.block.setSize(),this.block&&this.block.isNew()&&this.element&&this.element.attribute("style",null),"grid"===this.originalType){var i,n;(i=e.search('[data-lm-dropzone]:not([data-lm-blocktype="grid"])'))&&i.forEach(function(t){t=r(t),n=m(this.builder.map,t.data("lm-id")),t.attribute("style",null),n.setSize()},this)}}});e.exports=k},{"../ui/drag.drop":39,"../ui/eraser":41,"../utils/elements.utils":51,"../utils/flags-state":54,"./blocks":12,"./drag.resizer":21,"elements/zen":112,"mout/array/every":145,"mout/collection/find":163,"mout/function/bind":167,"mout/lang/deepEquals":175,"mout/lang/isArray":177,"mout/lang/isObject":182,"mout/number/enforcePrecision":195,"mout/object/get":204,"mout/object/keys":207,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256}],25:[function(t,e,i){"use strict";var n=t("../ui/drag.events"),r=t("prime"),o=(t("prime/emitter"),t("prime-util/prime/bound")),a=t("prime-util/prime/options"),s=t("mout/function/bind"),l=t("mout/lang/isString"),u=t("mout/math/map"),c=t("mout/math/clamp"),h=t("mout/number/enforcePrecision"),d=t("mout/object/get"),p=t("../utils/elements.utils");t("elements/events"),t("elements/delegation");var f=new r({mixin:[o,a],DRAG_EVENTS:n,options:{minSize:5},constructor:function(t,e,i){this.setOptions(e),this.history=this.options.history||{},this.builder=this.options.builder||{},this.map=this.builder.map,this.menumanager=i,this.origin={x:0,y:0,transform:null,offset:{x:0,y:0}}},getBlock:function(t){return d(this.map,l(t)?t:p(t).data("lm-id")||"")},getAttribute:function(t,e){return this.getBlock(t).getAttribute(e)},getSize:function(t){t=p(t);var e=t.matches("[data-mm-id]")?t:t.parent("[data-mm-id]"),i=e.find(".percentage input");return Number(i.value())},setSize:function(t,e,i){t=p(t),i="undefined"==typeof i?!1:i;var n=t.matches("[data-mm-id]")?t:t.parent("[data-mm-id]"),r=n.find(".percentage input");n[i?"animate":"style"]({flex:"0 1 "+e+"%"}),r.value(h(e,1))},start:function(t,e,i,n){if(t&&t.type.match(/^touch/i)&&t.preventDefault(),t.which&&1!==t.which)return!0;t.preventDefault(),this.element=p(e);var r=this.element.parent(".submenu-selector");if(!r)return!1;r.addClass("moving"),this.siblings={occupied:0,elements:i,next:this.element.parent("[data-mm-id]").nextSibling().find("> .submenu-column"),prevs:this.element.parent("[data-mm-id]").previousSiblings(),sizeBefore:0},this.siblings.elements.length>1&&(this.siblings.occupied-=this.getSize(this.siblings.next),this.siblings.elements.forEach(function(t){this.siblings.occupied+=this.getSize(t)},this)),this.siblings.prevs&&this.siblings.prevs.forEach(function(t){this.siblings.sizeBefore+=this.getSize(t)},this),this.origin={size:this.getSize(this.element),maxSize:this.getSize(this.element)+this.getSize(this.siblings.next),x:t.changedTouches?t.changedTouches[0].pageX:t.pageX+6,y:t.changedTouches?t.changedTouches[0].pageY:t.pageY};var o=this.element[0].getBoundingClientRect(),a=this.element.parent()[0].getBoundingClientRect();this.origin.offset={clientRect:o,parentRect:{left:a.left,right:a.right},x:this.origin.x-o.right,y:o.top-this.origin.y,down:n},this.origin.offset.parentRect.left=this.element.parent(".submenu-selector").find("> [data-mm-id]:first-child")[0].getBoundingClientRect().left,this.origin.offset.parentRect.right=this.element.parent(".submenu-selector").find("> [data-mm-id]:last-child")[0].getBoundingClientRect().right,this.DRAG_EVENTS.EVENTS.MOVE.forEach(s(function(t){p(document).on(t,this.bound("move"))},this)),this.DRAG_EVENTS.EVENTS.STOP.forEach(s(function(t){p(document).on(t,this.bound("stop"))},this))},move:function(t){t&&t.type.match(/^touch/i)&&t.preventDefault();var e=t.clientX||t.touches[0].clientX||0,i=t.clientY||t.touches[0].clientY||0,n=this.origin.offset.parentRect,r=(this.lastX||e)-e,o=(this.lastY||i)-i;this.direction=Math.abs(r)>Math.abs(o)&&r>0&&"left"||Math.abs(r)>Math.abs(o)&&0>r&&"right"||Math.abs(o)>Math.abs(r)&&o>0&&"up"||"down";var a,s=100-this.siblings.occupied,l=e+(this.siblings.prevs?this.siblings.prevs.length:this.origin.offset.x-this.origin.offset.down),d=c(l,n.left,n.right);a=u(d,n.left,n.right,0,100),a-=this.siblings.sizeBefore,a=h(c(a,this.options.minSize,this.origin.maxSize-this.options.minSize),0),s=h(s-a,0),this.setSize(this.element,a),this.setSize(this.siblings.next,s);var f=this.siblings.elements,m=f?f.length+1:1;if(3==m||6==m||7==m||8==m||9==m||11==m||12==m){var g,v=0;g=p([f,this.element.parent("[data-mm-id]")]),g.forEach(function(t,e){t=p(t),a=this.getSize(t),a%1&&(a=h(100/m,0),this.setSize(t,a)),v+=a,g.length==e+1&&100!=v&&(s=100-v,this.setSize(t,a+s))},this)}this.lastX=e,this.lastY=i},stop:function(t){t&&t.type.match(/^touch/i)&&t.preventDefault(),this.DRAG_EVENTS.EVENTS.MOVE.forEach(s(function(t){p(document).off(t,this.bound("move"))},this)),this.DRAG_EVENTS.EVENTS.STOP.forEach(s(function(t){p(document).off(t,this.bound("stop"))},this)),this.element.parent(".submenu-selector").removeClass("moving"),this.menumanager.emit("dragEnd",this.menumanager.map,"resize")},updateItemSizes:function(t){var e=this.element?this.element.parent(".submenu-selector"):null;if(!e&&!t)return!1;

var i=t||e.search("> [data-mm-id]"),n=[],r=p(".menu-selector .active"),o=r?r.data("mm-id"):null;return i.forEach(function(t){n.push(this.getSize(t))},this),this.menumanager.items[o].columns=n,this.updateMaxValues(t),n},updateMaxValues:function(t){var e=this.element?this.element.parent(".submenu-selector"):null;if(!e&&!t)return!1;var i,n,r=t||e.search("> [data-mm-id]");r.forEach(function(t){t=p(t);var e=t.nextSibling()||t.previousSibling();e&&(n={block:t.find("input.column-pc"),sibling:e.find("input.column-pc")},i={current:this.getSize(t),sibling:this.getSize(e)},i.total=i.current+i.sibling,n.block.attribute("max",i.total-Number(n.block.attribute("min"))),n.sibling.attribute("max",i.total-Number(n.sibling.attribute("min"))))},this)},evenResize:function(t,e){var i=t.length,n=h(100/i,4);t.forEach(function(t){t=p(t),this.setSize(t,n,"undefined"==typeof e?!1:e)},this),this.updateItemSizes(t),this.menumanager.emit("dragEnd",this.menumanager.map,"evenResize")}});e.exports=f},{"../ui/drag.events":40,"../utils/elements.utils":51,"elements/delegation":85,"elements/events":87,"mout/function/bind":167,"mout/lang/isString":185,"mout/math/clamp":189,"mout/math/map":191,"mout/number/enforcePrecision":195,"mout/object/get":204,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256}],26:[function(t,e,i){"use strict";var n=t("elements"),r=t("elements/zen"),o=t("elements/domready"),a=t("../ui").modal,s=t("../ui").toastr,l=t("agent"),u=t("mout/array/indexOf"),c=t("mout/string/trim"),h=t("../utils/get-ajax-suffix"),d=t("../utils/flags-state"),p=t("mout/lang/deepEquals"),f=null,m=function(t,e){e=e&&e.toLowerCase();for(var i="",n=0,r="a"==e?10:0,o="n"==e?10:62;n++<t;){var a=Math.random()*(o-r)+r<<0;i+=String.fromCharCode(a+=a>9?36>a?55:61:48)}return i},g=function(t,e){if(!this.isNewParticle||"reorder"===e){this.resizer.updateItemSizes(),f=this;var i=n("[data-save]"),o={settings:this.settings,ordering:this.ordering,items:this.items};if(this.isNewParticle||(p(t,o)?(i.hideIndicator(),d.set("pending",!1)):(i.showIndicator("fa fa-fw changes-indicator fa-circle-o"),d.set("pending",!0))),this.isParticle&&this.isNewParticle){var s=this.block.data("mm-blocktype");this.block.attribute("data-mm-blocktype",null).addClass("g-menu-item-"+s).data("mm-original-type",s),r("span.menu-item-type.badge").text(s).after(this.block.find(".menu-item .title")),a.open({content:"Loading",method:"post",remote:n(this.block).find(".config-cog").attribute("href")+h(),remoteLoaded:function(t,e){var i=e.elements.content.find(".search input"),r=e.elements.content.search("[data-mm-type]"),o=e.elements.content.search("[data-mm-filter]");i&&o&&r&&i.on("input",function(){if(!this.value())return void r.removeClass("hidden");r.addClass("hidden");var t,e=[],i=this.value().toLowerCase();o.forEach(function(r){r=n(r),t=c(r.data("mm-filter")).toLowerCase(),t.match(new RegExp("^"+i+"|\\s"+i,"gi"))&&e.push(r.matches("[data-mm-type]")?r:r.parent("[data-mm-type]"))},this),e.length&&n(e).removeClass("hidden")})}})}this.type=void 0}},v=function(t,e,i){var r=e.find("[data-mm-particle-stepone]").data("mm-particle-stepone");l("post",r+h(),t,function(t,r){if(!r.body.success)return a.open({content:r.body.html||r.body,afterOpen:function(t){r.body.html||t.style({width:"90%"})}}),void i.hideIndicator();e.html(r.body.html);var o=n("[data-selectize]");o&&o.selectize();var c=e.find(".g-urltemplate");c&&n("body").emit("input",{target:c});var d=e.find("form"),p=e.find('input[type="submit"], button[type="submit"]'),g=[];return d&&p?void p.on("click",function(t){t.preventDefault(),g=[],p.showIndicator(),n(d[0].elements).forEach(function(t){t=n(t);var e=t.attribute("name"),i=t.value(),r=t.parent(".settings-param"),o=r?r.find('> input[type="checkbox"]'):null;!e||t.disabled()||o&&!o.checked()||g.push(e+"="+encodeURIComponent(i))});var i=e.find("[data-title-editable]");i&&g.push("title="+encodeURIComponent(i.data("title-editable"))),l(d.attribute("method"),d.attribute("action")+h(),g.join("&")||{},function(t,e){if(e.body.success){for(var i=f.element,n=i.data("mm-id")+"-",r=m(5),o=i.parent("[data-mm-base]").data("mm-base"),l=(i.parent("[data-mm-id]").data("mm-id").match(/\d+$/)||[0])[0],c=u(i.parent().children("[data-mm-id]"),i[0]);f.items[n+r];)r=m(5);f.items[n+r]=e.body.item,f.ordering[o][l].splice(c,1,n+r),i.data("mm-id",n+r),e.body.html&&i.html(e.body.html),f.isNewParticle=!1,f.emit("dragEnd",f.map),a.close(),s.success("The Menu Item settings have been applied to the Main Menu. <br />Remember to click the Save button to store them.","Settings Applied")}else a.open({content:e.body.html||e.body,afterOpen:function(t){e.body.html||t.style({width:"90%"})}});p.hideIndicator()})}):!0})};o(function(){var t=n("body");t.delegate("click",".menu-editor-extras [data-lm-blocktype], .menu-editor-extras [data-mm-module]",function(t,e){var i=e.parent(".menu-editor-extras"),n=i.search("[data-lm-blocktype], [data-mm-module]"),r=i.find("[data-mm-select]");n.removeClass("selected"),e.addClass("selected"),r.attribute("disabled",null)}),t.delegate("click",".menu-editor-extras [data-mm-select]",function(t,e){if(t.preventDefault(),e.hasClass("disabled")||e.attribute("disabled"))return!1;var i=e.parent(".menu-editor-extras"),n=i.find("[data-lm-blocktype].selected, [data-mm-module].selected"),r=n.data("mm-type"),o={type:"particle"};switch(r){case"particle":o.particle=n.data("lm-subtype");break;case"module":o.particle=r,o.title=n.find("[data-mm-title]").data("mm-title"),o.options={particle:{module_id:n.data("mm-module")}}}e.showIndicator(),v({item:JSON.stringify(o)},e.parent(".g5-content"),e)})}),e.exports=g},{"../ui":42,"../utils/flags-state":54,"../utils/get-ajax-suffix":55,agent:61,elements:88,"elements/domready":86,"elements/zen":112,"mout/array/indexOf":151,"mout/lang/deepEquals":175,"mout/string/trim":236}],27:[function(t,e,i){"use strict";var n,r=t("elements/domready"),o=t("./menumanager"),a=t("elements"),s=(t("elements/zen"),t("../ui").modal),l=t("../ui").toastr,u=t("./extra-items"),c=t("agent"),h=(t("mout/string/trim"),t("mout/math/clamp")),d=t("mout/array/contains"),p=t("../utils/get-ajax-suffix"),f=t("../utils/field-validation"),m=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,g=m?"focus":"focusin",v=m?"blur":"focusout";r(function(){var t=a("body");n=new o("body",{delegate:".g5-mm-particles-picker ul li, #menu-editor > section ul li, .submenu-column, .submenu-column li, .column-container .g-block",droppables:"#menu-editor [data-mm-id]",exclude:"[data-lm-nodrag], .fa-cog, .config-cog",resize_handles:".submenu-column:not(:last-child)",catchClick:!0}),n.on("dragEnd",u),e.exports.menumanager=n,n.setRoot(),t.delegate("statechangeAfter","#main-header [data-g5-ajaxify], select.menu-select-wrap",function(t,e){n.setRoot(),n.eraser.element=a("[data-mm-eraseparticle]"),n.eraser.hide()}),t.delegate(g,".percentage input",function(t,e){e=a(e),e.currentSize=Number(e.value()),e[0].focus(),e[0].select()},!0),t.delegate("keydown",".percentage input",function(t,e){d([46,8,9,27,13,110,190],t.keyCode)||65==t.keyCode&&(t.ctrlKey===!0||t.ctrlKey===!0)||82==t.keyCode&&(t.ctrlKey===!0||t.metaKey===!0)||t.keyCode>=35&&t.keyCode<=40||(t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()}),t.delegate("keydown",".percentage input",function(e,i){i=a(i);var n=Number(i.value()),r=Number(i.attribute("min")),o=Number(i.attribute("max")),s=38==e.keyCode||40==e.keyCode;s&&(n+=38==e.keyCode?1:-1,n=h(n,r,o),i.value(n),t.emit("keyup",{target:i}))}),t.delegate("keyup",".percentage input",function(t,e){e=a(e);var i=Number(e.value()),r=Number(e.attribute("min")),o=Number(e.attribute("max")),s=n.resizer,l=e.parent("[data-mm-id]"),u=l.nextSibling("[data-mm-id]")||l.previousSibling("[data-mm-id]");if(!(!i||r>i||i>o)){var c={current:Number(e.currentSize),sibling:Number(s.getSize(u))};e.currentSize=i,c.total=c.current+c.sibling,c.diff=c.total-i,s.setSize(l,i),s.setSize(u,c.diff),n.resizer.updateItemSizes(l.parent(".submenu-selector").search("> [data-mm-id]")),n.emit("dragEnd",n.map,"inputChange")}}),t.delegate(v,".percentage input",function(t,e){e=a(e);var i=Number(e.value());(i<Number(e.attribute("min"))||i>Number(e.attribute("max")))&&e.value(e.currentSize)},!0),t.delegate("click",".add-column",function(t,e){t&&t.preventDefault&&t.preventDefault(),e=a(e);var i=e.parent("[data-g5-menu-columns]").find(".submenu-selector"),r=i.children(),o=i.find("> :last-child"),s=r?r.length:0,l=a(".menu-selector .active"),u=l?l.data("mm-id"):null,c=a(o[0].cloneNode(!0));c.data("mm-id","list-"+s),c.find(".submenu-items").empty(),c.after(o),n.ordering[u].push([]),n.resizer.evenResize(a(".submenu-selector > [data-mm-id]"))}),t.delegate("click","[data-g5-menu-columns] .submenu-items:empty",function(t,e){var i=e[0].getBoundingClientRect(),r=t.pageX,o=t.pageY,s={width:36,height:36};if(r>=i.left+i.width-s.width&&r<=i.left+i.width&&Math.abs(window.scrollY-o)-i.top<s.height){var l=e.parent("[data-mm-id]"),u=l.data("mm-id").match(/\d+$/)[0],c=a(".menu-selector .active"),h=c?c.data("mm-id"):null;l.remove(),n.ordering[h].splice(u,1),n.resizer.evenResize(a(".submenu-selector > [data-mm-id]"))}}),t.delegate("click","#menu-editor .config-cog, #menu-editor .global-menu-settings",function(t,e){t.preventDefault();var i={},r=e.hasClass("global-menu-settings");r?i.settings=JSON.stringify(n.settings):i.item=JSON.stringify(n.items[e.parent("[data-mm-id]").data("mm-id")]),s.open({content:"Loading",method:"post",data:i,remote:a(e).attribute("href")+p(),remoteLoaded:function(t,i){var o,u=i.elements.content.find("form"),h=i.elements.content.find('input[type="submit"], button[type="submit"]'),d=[],m=[];return u&&h?void h.on("click",function(t){t.preventDefault(),d=[],m=[],h.hideIndicator(),h.showIndicator(),a(u[0].elements).forEach(function(t){t=a(t);var e=t.attribute("name"),i=t.value();e&&(f(t)||m.push(t),d.push(e+"="+encodeURIComponent(i)))});var g=i.elements.content.find("[data-title-editable]");return g&&d.push((r?"settings[title]":"title")+"="+encodeURIComponent(g.data("title-editable"))),m.length?(h.hideIndicator(),h.showIndicator("fa fa-fw fa-exclamation-triangle"),void l.error("Please review the fields in the modal and ensure you correct any invalid one.","Invalid Fields")):void c(u.attribute("method"),u.attribute("action")+p(),d.join("&"),function(t,i){if(i.body.success){if(i.body.path||i.body.item&&"particle"==i.body.item.type?(o=i.body.path||e.parent("[data-mm-id]").data("mm-id"),n.items[o]=i.body.item):i.body.item&&"particle"==i.body.item.type||(n.settings=i.body.settings),i.body.html){var r=e.parent("[data-mm-id]");r&&r.html(i.body.html)}n.emit("dragEnd",n.map),s.close(),l.success("The Menu Item settings have been applied to the Main Menu. <br />Remember to click the Save button to store them.","Settings Applied")}else s.open({content:i.body.html||i.body,afterOpen:function(t){i.body.html||t.style({width:"90%"})}});h.hideIndicator()})}):!0}})})}),e.exports={menumanager:n}},{"../ui":42,"../utils/field-validation":53,"../utils/get-ajax-suffix":55,"./extra-items":26,"./menumanager":28,agent:61,elements:88,"elements/domready":86,"elements/zen":112,"mout/array/contains":142,"mout/math/clamp":189,"mout/string/trim":236}],28:[function(t,e,i){"use strict";var n=t("prime"),r=t("../utils/elements.utils"),o=t("mout/function/bind"),a=t("elements/zen"),s=t("prime/emitter"),l=t("prime-util/prime/bound"),u=t("prime-util/prime/options"),c=t("../ui/drag.drop"),h=t("../ui/eraser"),d=t("./drag.resizer"),p=(t("mout/object/get"),t("mout/array/every"),t("mout/array/last")),f=t("mout/array/indexOf"),m=(t("mout/lang/isArray"),t("mout/lang/isObject"),t("mout/lang/deepClone")),g=(t("mout/object/equals"),new n({mixin:[l,u],inherits:s,constructor:function(t,e){this.map={},this.setRoot(),this.dragdrop=new c(t,e,this),this.resizer=new d(t,e,this),this.eraser=new h("[data-mm-eraseparticle]",e),this.dragdrop.on("dragdrop:click",this.bound("click")).on("dragdrop:start",this.bound("start")).on("dragdrop:move:once",this.bound("moveOnce")).on("dragdrop:location",this.bound("location")).on("dragdrop:nolocation",this.bound("nolocation")).on("dragdrop:resize",this.bound("resize")).on("dragdrop:stop:erase",this.bound("removeElement")).on("dragdrop:stop",this.bound("stop")).on("dragdrop:stop:animation",this.bound("stopAnimation"))},setRoot:function(){if(this.root=r("#menu-editor"),this.root){this.settings=JSON.parse(this.root.data("menu-settings")),this.ordering=JSON.parse(this.root.data("menu-ordering")),this.items=JSON.parse(this.root.data("menu-items")),this.map={settings:m(this.settings),ordering:m(this.ordering),items:m(this.items)};var t,e=r("[data-g5-menu-columns] .submenu-selector");this.resizer&&e&&(t=e.search("> [data-mm-id]"))&&this.resizer.updateMaxValues(t)}},click:function(t,e){if(e.hasClass("g-block"))return this.stopAnimation(),!0;var i=e.find("> .menu-item");if(i&&"span"==i.tag())return this.stopAnimation(),!0;var n=e.siblings();e.addClass("active"),n&&n.removeClass("active"),e.emit("click");var r=e.find("a");r&&r[0].click()},resize:function(t,e,i,n){this.resizer.start(t,e,i,n)},start:function(t,e){var i=e.parent(".menu-selector")||e.parent(".submenu-column")||e.parent(".submenu-selector")||e.parent(".g5-mm-particles-picker"),n=r(e).position();if(this.block=null,this.targetLevel=void 0,this.addNewItem=!1,this.type=e.parent(".g-toplevel")||e.matches(".g-toplevel")?"main":e.matches(".g-block")?"column":"columns_items",this.isParticle=e.matches("[data-mm-blocktype]")||e.matches("[data-mm-original-type]"),this.wasActive=e.hasClass("active"),this.isNewParticle=e.parent(".g5-mm-particles-picker"),this.ParticleIndex=-1,this.root=i,this.itemID=e.data("mm-id"),this.itemLevel=e.data("mm-level"),this.itemFrom=e.parent("[data-mm-id]"),this.itemTo=null,this.isParticle&&!this.isNewParticle){var o=e.parent().children("[data-mm-id]");this.ParticleIndex=f(o,e[0])}i.addClass("moving");var s=r(e).data("mm-id"),l=e[0].cloneNode(!0);if(this.placeholder||(this.placeholder=a(("column"==this.type?"div":"li")+".block.placeholder[data-mm-placeholder]")),this.placeholder.style({display:"none"}),this.original=r(l).after(e).style({display:"inline-block",opacity:1}).addClass("original-placeholder").data("lm-dropzone",null),this.originalType=s,this.block=e,this.isNewParticle){var u=e.position(),c={top:e.parent()[0].scrollTop,left:e.parent()[0].scrollLeft};this.original.style({position:"absolute",opacity:.5}).style({left:e[0].offsetLeft-c.left,top:e[0].offsetTop-c.top,width:u.width,height:u.height}),this.element=this.dragdrop.element,this.block=this.dragdrop.element,this.dragdrop.element=this.original}else e.style({position:"absolute",zIndex:1500,width:Math.ceil(n.width),height:Math.ceil(n.height)}).addClass("active"),this.placeholder.before(e);!this.isNewParticle&&s&&s.match(/__(module|particle)-[a-z0-9]{5}$/i)&&this.eraser.show(),"column"==this.type&&i.search(".g-block > *").style({"pointer-events":"none"})},moveOnce:function(){this.original&&this.original.style({opacity:.5})},location:function(t,e,i){i=r(i),(this.isNewParticle?this.block:this.original).style({transform:"translate(0, 0)"}),this.placeholder||(this.placeholder=a(("column"==this.type?"div":"li")+".block.placeholder[data-mm-placeholder]").style({display:"none"}));var n=i.parent(".g-toplevel")||i.matches(".g-toplevel")?"main":i.matches(".g-block")?"column":"columns_items",o=i.data("mm-level"),s=this.block.data("mm-level");if(this.isParticle&&"main"===n&&!o)return void(this.dragdrop.matched=!1);if(null===o&&("columns_items"===this.type||this.isParticle)){var l=i.find(".submenu-items");return!l||l.children()||s>2?void(this.dragdrop.matched=!1):(this.placeholder.style({display:"block"}).bottom(l),this.addNewItem=l,this.targetLevel=2,void(this.dragdrop.matched=!1))}if(!this.isParticle){if("column"!==this.type&&s!==o)return void(this.dragdrop.matched=!1);if("column"==this.type&&o)return void(this.dragdrop.matched=!1);if(o>2&&i.parent("ul")!=this.block.parent("ul"))return void(this.dragdrop.matched=!1)}var u=':not(.placeholder):not([data-mm-id="'+this.original.data("mm-id")+'"])',c={before:this.original.previousSiblings(u),after:this.original.nextSiblings(u)};if(c.before&&(c.before=r(c.before[0])),c.after&&(c.after=r(c.after[0])),!("main"===n&&(c.before===i&&"after"===e.x||c.after===i&&"before"===e.x)||"column"===n&&(c.before===i&&"after"===e.x||c.after===i&&"before"===e.x)||"columns_items"===n&&(c.before===i&&"below"===e.y||c.after===i&&"above"===e.y))){switch(n){case"main":case"column":this.placeholder[e.x](i);break;case"columns_items":this.placeholder["above"===e.y?"before":"after"](i)}this.targetLevel=o,this.placeholder.style({display:"block"})["main"!==n?"removeClass":"addClass"]("in-between")}},nolocation:function(t){(this.isNewParticle?this.block:this.original).style({transform:"translate(0, 0)"}),this.placeholder&&this.placeholder.remove(),this.targetLevel=void 0;var e=t.type.match(/^touch/i)?document.elementFromPoint(t.touches.item(0).clientX,t.touches.item(0).clientY):t.target;!this.isNewParticle&&this.itemID.match(/__(module|particle)-[a-z0-9]{5}$/i)&&(e=r(e),e.matches(this.eraser.element)||this.eraser.element.find(e)?(this.dragdrop.removeElement=!0,this.eraser.over()):(this.dragdrop.removeElement=!1,this.eraser.out()))},removeElement:function(t,e){this.dragdrop.removeElement=!1;var i={opacity:0};e.animate(i,{duration:"150ms"}),"column"==this.type&&this.root.search(".g-block > *").style({"pointer-events":"none"}),this.eraser.hide(),this.dragdrop.DRAG_EVENTS.EVENTS.MOVE.forEach(o(function(t){r("body").off(t,this.dragdrop.bound("move"))},this)),this.dragdrop.DRAG_EVENTS.EVENTS.STOP.forEach(o(function(t){r("body").off(t,this.dragdrop.bound("deferStop"))},this));var n=this.block,a=n.parent("[data-mm-base]").data("mm-base"),s=(n.parent("[data-mm-id]").data("mm-id").match(/\d+$/)||[0])[0],l=f(n.parent().children("[data-mm-id]:not(.original-placeholder)"),n[0]);delete this.items[this.itemID],this.ordering[a][s].splice(l,1),this.block.remove(),this.original.remove(),this.root.removeClass("moving"),this.emit("dragEnd",this.map,"reorder")},stop:function(t,e,i){e=r(e);var n=r(this.dragdrop.lastOvered);if(n&&n.matches(this.eraser.element.find(".trash-zone")))return void this.eraser.hide();if(e&&i.removeClass("active"),"column"==this.type&&this.root.search(".g-block > *").attribute("style",null),!this.dragdrop.matched&&!this.addNewItem)return this.placeholder&&this.placeholder.remove(),this.type=void 0,this.targetLevel=!1,this.isParticle=void 0,void this.eraser.hide();var o=this.placeholder.parent();if(!o)return this.type=void 0,this.targetLevel=!1,void(this.isParticle=void 0);this.addNewItem&&this.block.attribute("style",null).removeClass("active");var a=this.block.parent();if(this.eraser.hide(),this.original&&(this.isNewParticle?this.original.attribute("style",null).removeClass("original-placeholder"):this.original.remove()),this.block.after(this.placeholder),this.placeholder.remove(),this.itemTo=this.block.parent("[data-mm-id]"),this.currentLevel=this.itemLevel,this.wasActive&&i.addClass("active"),this.isParticle){var s=p(this.itemID.split("/")),l=e||this.itemTo,u=l[e&&!e.hasClass("g-block")?"parent":"find"]("[data-mm-base]").data("mm-base");this.itemID=u?u+"/"+s:s,this.itemLevel=this.targetLevel,this.block.data("mm-id",this.itemID).data("mm-level",this.targetLevel)}var c,h,d=this.itemID.split("/");if(d.splice(this.itemLevel-1),d=d.join("/"),this.itemFrom||this.itemTo){var f=this.itemFrom==this.itemTo?[this.itemFrom]:[this.itemFrom,this.itemTo];if(f.forEach(function(t){if(t){if(c=t.search("[data-mm-id]"),h=Number(this.block.data("mm-level")>2?0:(t.data("mm-id").match(/\d+$/)||[0])[0]),!c)return void(this.ordering[d][h]=[]);c=c.map(function(t){return r(t).data("mm-id")}),this.ordering[d][h]=c}},this),u=this.itemFrom?null!==this.itemFrom.attribute("data-mm-base")?this.itemFrom:this.itemFrom.find("[data-mm-base]"):null,this.isParticle&&u&&this.targetLevel!=this.currentLevel){var m=(this.itemFrom.data("mm-id").match(/\d+$/)||[0])[0];this.ordering[u.data("mm-base")||""][m].splice(this.ParticleIndex,1)}}if(!this.itemFrom&&!this.itemTo&&!this.isParticle){var g=[],v=r(".g-toplevel [data-mm-id].active").data("mm-id");c=a.search("> [data-mm-id]"),c.forEach(function(t,e){t=r(t);var i=t.data("mm-id"),n=Number((i.match(/\d+$/)||[0])[0]);t.data("mm-id",i.replace(/\d+$/,e)),g.push(this.ordering[v][n])},this),this.ordering[v]=g}a.children()||a.empty();var b=this.block.parent(".submenu-selector");b&&this.resizer.updateItemSizes(b.search("> [data-mm-id]")),this.emit("dragEnd",this.map,"reorder")},stopAnimation:function(){var t=null;"column"==this.type&&(t=this.resizer.getSize(this.block)),this.root&&this.root.removeClass("moving"),this.block&&(this.block.attribute("style",null),t&&this.block.style("flex","0 1 "+t+" %")),this.original&&(this.isNewParticle&&(this.dragdrop.matched||this.targetLevel)?this.original.attribute("style",null).removeClass("original-placeholder"):this.original.remove()),!this.wasActive&&this.block&&this.block.removeClass("active")}}));e.exports=g},{"../ui/drag.drop":39,"../ui/eraser":41,"../utils/elements.utils":51,"./drag.resizer":25,"elements/zen":112,"mout/array/every":145,"mout/array/indexOf":151,"mout/array/last":155,"mout/function/bind":167,"mout/lang/deepClone":174,"mout/lang/isArray":177,"mout/lang/isObject":182,"mout/object/equals":199,"mout/object/get":204,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256}],29:[function(t,e,i){"use strict";var n=t("elements/domready"),r=t("elements"),o=(t("elements/zen"),t("../../ui").modal),a=t("../../ui").toastr,s=t("agent"),l=t("mout/array/last"),u=t("mout/array/indexOf"),c=t("sortablejs"),h=t("mout/string/trim"),d=t("../../utils/get-ajax-suffix"),p=t("../../utils/field-validation");t("elements/insertion"),n(function(){var t=r("body"),e=function(e,i){"enter"==i&&this.CollectionNew&&(this.CollectionNew=!1,t.emit("click",{target:this.parent(".settings-param").find("[data-collection-addnew]")})),"esc"==i&&this.CollectionNew&&(this.CollectionNew=!1,t.emit("click",{target:this.parent("[data-collection-item]").find("[data-collection-remove]")}))},i=function(e){var i=e||r(".collection-list ul");i&&i.forEach(function(e){e=r(e),e.SimpleSort=c.create(e[0],{handle:".fa-reorder",filter:"[data-collection-nosort]",scroll:!1,animation:150,onStart:function(){r(this.el).addClass("collection-sorting")},onEnd:function(e){var i=r(this.el);if(i.removeClass("collection-sorting"),e.oldIndex!==e.newIndex){var n=i.parent(".settings-param").find("[data-collection-data]"),o=n.value();o=JSON.parse(o),o.splice(e.newIndex,0,o.splice(e.oldIndex,1)[0]),n.value(JSON.stringify(o)),t.emit("change",{target:n})}}})})};i(),t.delegate("mouseover",".collection-list ul",function(t,e){e.SimpleSort||i(e)}),t.delegate("click","[data-collection-addnew]",function(i,n){var o,a,s=n.parent(".settings-param"),u=s.find("ul"),c=u.parent().find("[data-collection-editall]"),h=s.find("[data-collection-data]"),d=s.find("[data-collection-template]"),p=u.search("> [data-collection-item]")||[],f=r(l(p)),m=r(d[0].cloneNode(!0));f?m.after(f):m.top(u),p.length&&c&&c.style("display","inline-block"),o=m.find("a"),a=o.find("[data-title-editable]");var g=new RegExp("%id%","g");o.href(o.href().replace(g,p.length)),m.attribute("style",null).data("collection-item",m.data("collection-template")),m.attribute("data-collection-template",null),m.attribute("data-collection-nosort",null),a.CollectionNew=!0,t.emit("click",{target:o.siblings("[data-title-edit]")}),a.on("title-edit-exit",e),t.emit("change",{target:h})}),t.delegate("blur","[data-collection-item] [data-title-editable]",function(e,i){var n=h(i.text()),r=i.parent("[data-collection-item]"),o=r.data("collection-item"),a=i.parent("ul").search("> [data-collection-item]"),s=i.parent(".settings-param").find("[data-collection-data]"),l=s.value(),c=u(a,r[0]);-1!=c&&(l=JSON.parse(l),l[c]||l.splice(c,0,{}),l[c][o]=n,s.value(JSON.stringify(l)),t.emit("change",{target:s}))},!0),t.delegate("click","[data-collection-remove]",function(e,i){e&&e.preventDefault&&e.preventDefault();var n=i.parent("[data-collection-item]"),r=i.parent("ul"),o=r.search("> [data-collection-item]"),a=u(o,n[0]),s=i.parent(".settings-param").find("[data-collection-data]"),l=s.value();l=JSON.parse(l),l.splice(a,1),s.value(JSON.stringify(l)),n.remove(),o.length&&r.parent().find("[data-collection-editall]").style("display","none"),t.emit("change",{target:s})}),t.delegate("click","[data-collection-item] a",function(t,e){e.find("[contenteditable]")&&(t.preventDefault(),t.stopPropagation())}),t.delegate("click","[data-collection-item] .config-cog, [data-collection-editall]",function(e,i){e&&e.preventDefault&&e.preventDefault();var n=i.find("[data-title-editable]");if(n&&n.attribute("contenteditable"))return e.stopPropagation(),!1;var l=null!==i.data("collection-editall"),c=i.parent(".settings-param"),h=c.find("[data-collection-data]"),f=h.value(),m=i.parent("[data-collection-item]"),g=c.search("ul > [data-collection-item]"),v={data:l?f:JSON.stringify(JSON.parse(f)[u(g,m[0])])};o.open({content:"Loading",method:"post",className:"g5-dialog-theme-default g5-modal-collection g5-modal-collection-"+(l?"editall":"single"),data:v,remote:i.attribute("href")+d(),remoteLoaded:function(e,n){var l=n.elements.content.find("form"),c=n.elements.content.find('input[type="submit"], button[type="submit"]'),v=[],b=[],y=JSON.parse(f);return 1==y.length,l&&c?void c.on("click",function(e){e.preventDefault(),v=[],b=[],c.hideIndicator(),c.showIndicator(),r(l[0].elements).forEach(function(t){t=r(t);var e=t.attribute("name"),i=t.value(),n=t.parent(".settings-param"),o=n?n.find('> input[type="checkbox"]'):null;!e||t.disabled()||o&&!o.checked()||(p(t)||b.push(t),v.push(e+"="+encodeURIComponent(i)))});var f,w=n.elements.content.search("[data-title-editable]");return w&&w.forEach(function(t){t=r(t),f=t.data("collection-key")||"title",v.push(f+"="+encodeURIComponent(t.data("title-editable")))}),b.length?(c.hideIndicator(),c.showIndicator("fa fa-fw fa-exclamation-triangle"),void a.error("Please review the fields in the modal and ensure you correct any invalid one.","Invalid Fields")):void s(l.attribute("method"),l.attribute("action")+d(),v.join("&")||{},function(e,n){n.body.success?(m?y[u(g,m[0])]=n.body.data:y=n.body.data,h.value(JSON.stringify(y)),t.emit("change",{target:h}),i.parent(".settings-param-field").search("ul > [data-collection-item]").forEach(function(t,e){t=r(t);var i=t.find("[data-title-editable]"),n=y[e][t.data("collection-item")];i.data("title-editable",n).text(n)}),o.close(),a.success("Collection Item updated","Item Updated")):o.open({content:n.body.html||n.body,afterOpen:function(t){n.body.html||t.style({width:"90%"})}}),c.hideIndicator()})}):!0}})})}),e.exports={}},{"../../ui":42,"../../utils/field-validation":53,"../../utils/get-ajax-suffix":55,agent:61,elements:88,"elements/domready":86,"elements/insertion":89,"elements/zen":112,"mout/array/indexOf":151,"mout/array/last":155,"mout/string/trim":236,sortablejs:272}],30:[function(t,e,i){"use strict";var n=t("prime"),r=t("prime/emitter"),o=t("prime-util/prime/bound"),a=t("prime-util/prime/options"),s=t("elements"),l=t("elements/domready"),u=t("elements/zen"),c=t("../../ui/drag.events"),h=t("mout/collection/forEach"),d=t("mout/function/bind"),p=t("mout/math/clamp"),f=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,m=c.EVENTS.START,g=c.EVENTS.MOVE,v=c.EVENTS.STOP,b=f?"focus":"focusin",y=new n({mixin:[a,o],inherits:r,options:{},constructor:function(t){this.setOptions(t),this.built=!1,this.attach()},attach:function(){var t=s("body");m.forEach(d(function(e){t.delegate(e,".colorpicker i",this.bound("iconClick"))},this)),t.delegate(b,".colorpicker input",this.bound("show"),!0),t.delegate("keydown",".colorpicker input",d(function(t,e){switch(t.keyCode){case 9:this.hide();break;case 13:case 27:this.hide(),e[0].blur()}return!0},this)),t.delegate("keyup",".colorpicker input",d(function(t,e){return this.updateFromInput(!0,e),!0},this)),t.delegate("paste",".colorpicker input",d(function(t,e){setTimeout(d(function(){this.updateFromInput(!0,e)},this),1)},this))},show:function(t,e){var i=s("body");this.built||this.build(),this.element=e,this.reposition(),this.wrapper.addClass("cp-visible"),this.updateFromInput(),g.forEach(d(function(t){i.on(t,this.bound("bodyMove"))},this)),m.forEach(d(function(t){this.wrapper.delegate(t,".cp-grid, .cp-slider, .cp-opacity-slider",this.bound("bodyDown")),i.on(t,this.bound("bodyClick"))},this)),v.forEach(d(function(t){i.on(t,this.bound("targetReset"))},this))},hide:function(){var t=s("body");this.built&&(this.wrapper.removeClass("cp-visible"),g.forEach(d(function(e){t.off(e,this.bound("bodyMove"))},this)),m.forEach(d(function(e){this.wrapper.undelegate(e,".cp-grid, .cp-slider, .cp-opacity-slider",this.bound("bodyDown")),t.off(e,this.bound("bodyClick"))},this)),v.forEach(d(function(e){t.off(e,this.bound("targetReset"))},this)))},iconClick:function(t,e){t.preventDefault();var i=s(e).sibling("input");i[0].focus(),this.show(t,i)},bodyMove:function(t){t.preventDefault(),this.target&&this.move(this.target,t)},bodyClick:function(t){var e=s(t.target);e.parent(".cp-wrapper")||e.parent(".colorpicker")||this.hide()},bodyDown:function(t,e){t.preventDefault(),this.target=e,this.move(this.target,t,!0)},targetReset:function(t){t.preventDefault(),this.target=null},move:function(t,e){var i,n,r,o,a=this.element,s=t.find(".cp-picker"),l=t[0].getBoundingClientRect(),u=l.left+window.scrollX,c=l.top+window.scrollY,h=Math.round(e.pageX-u),d=Math.round(e.pageY-c);e.changedTouches&&(h=e.changedTouches[0].pageX-u,d=e.changedTouches[0].pageY-c),0>h&&(h=0),0>d&&(d=0),h>l.width&&(h=l.width),d>l.height&&(d=l.height),t.parent(".cp-mode-wheel")&&s.parent(".cp-grid")&&(i=75-h,n=75-d,r=Math.sqrt(i*i+n*n),o=Math.atan2(n,i),0>o&&(o+=2*Math.PI),r>75&&(h=75-75*Math.cos(o),d=75-75*Math.sin(o)),h=Math.round(h),d=Math.round(d)),t.hasClass("cp-grid")?(s.style({top:d,left:h}),this.updateFromPicker(a,t)):(s.style({top:d}),this.updateFromPicker(a,t))},build:function(){this.wrapper=u("div.cp-wrapper.cp-with-opacity.cp-mode-hue"),this.slider=u("div.cp-slider.cp-sprite").bottom(this.wrapper).appendChild(u("div.cp-picker")),this.opacitySlider=u("div.cp-opacity-slider.cp-sprite").bottom(this.wrapper).appendChild(u("div.cp-picker")),this.grid=u("div.cp-grid.cp-sprite").bottom(this.wrapper).appendChild(u("div.cp-grid-inner")).appendChild(u("div.cp-picker")),u("div").bottom(this.grid.find(".cp-picker"));var t=u("div.cp-tabs").bottom(this.wrapper);this.tabs={hue:u("div.cp-tab-hue.active").text("HUE").bottom(t),brightness:u("div.cp-tab-brightness").text("BRI").bottom(t),saturation:u("div.cp-tab-saturation").text("SAT").bottom(t),wheel:u("div.cp-tab-wheel").text("WHEEL").bottom(t)},t.delegate("click","> div",d(function(e,i){var n=t.find(".active"),r=n.attribute("class").replace(/\s|active|cp-tab-/g,""),o=i.attribute("class").replace(/\s|active|cp-tab-/g,"");this.wrapper.removeClass("cp-mode-"+r).addClass("cp-mode-"+o),n.removeClass("active"),i.addClass("active"),this.mode=o,this.updateFromInput()},this)),this.wrapper.bottom("body"),this.built=!0,this.mode="hue"},updateFromInput:function(t,e){e=this.element||e;var i,n,r=e.value(),o=r.replace(/\s/g,"").match(/^rgba?\([0-9]{1,3},[0-9]{1,3},[0-9]{1,3},(.+)\)/);if(r=S(r)||r,o=o?p(o[1],0,1):1,(i=w(r))||(i="#ffffff"),n=E(i),this.built){this.opacity=o;var a=this.opacitySlider.position().height;this.opacitySlider.find(".cp-picker").style({top:p(a-a*this.opacity,0,a)});var s,l,u,c,h=this.grid.position().height,d=this.grid.position().width;switch(a=this.slider.position().height,this.mode){case"wheel":s=p(Math.ceil(.75*n.s),0,h/2),l=n.h*Math.PI/180,u=p(75-Math.cos(l)*s,0,d),c=p(75-Math.sin(l)*s,0,h),this.grid.style({backgroundColor:"transparent"}).find(".cp-picker").style({top:c,left:u}),c=150-n.b/(100/h),""===i&&(c=0),this.slider.find(".cp-picker").style({top:c}),this.slider.style({backgroundColor:C({h:n.h,
s:n.s,b:100})});break;case"saturation":u=p(5*n.h/12,0,150),c=p(h-Math.ceil(n.b/(100/h)),0,h),this.grid.find(".cp-picker").style({top:c,left:u}),c=p(a-n.s*(a/100),0,a),this.slider.find(".cp-picker").style({top:c}),this.slider.style({backgroundColor:C({h:n.h,s:100,b:n.b})}),this.grid.find(".cp-grid-inner").style({opacity:n.s/100});break;case"brightness":u=p(5*n.h/12,0,150),c=p(h-Math.ceil(n.s/(100/h)),0,h),this.grid.find(".cp-picker").style({top:c,left:u}),c=p(a-n.b*(a/100),0,a),this.slider.find(".cp-picker").style({top:c}),this.slider.style({backgroundColor:C({h:n.h,s:n.s,b:100})}),this.grid.find(".cp-grid-inner").style({opacity:1-n.b/100});break;case"hue":default:u=p(Math.ceil(n.s/(100/d)),0,d),c=p(h-Math.ceil(n.b/(100/h)),0,h),this.grid.find(".cp-picker").style({top:c,left:u}),c=p(a-n.h/(360/a),0,a),this.slider.find(".cp-picker").style({top:c}),this.grid.style({backgroundColor:C({h:n.h,s:100,b:100})})}}t||e.value(this.getValue(i)),this.emit("change",e,i,o)},updateFromPicker:function(t,e){var i,n,r,o,a,s,l,u,c=function(t,e){var i,n;return t.length&&e?(i=t[0].getBoundingClientRect().left,n=t[0].getBoundingClientRect().top,{x:i-e[0].getBoundingClientRect().left+t[0].offsetWidth/2,y:n-e[0].getBoundingClientRect().top+t[0].offsetHeight/2}):null},h=this.wrapper.find(".cp-grid"),d=this.wrapper.find(".cp-slider"),f=this.wrapper.find(".cp-opacity-slider"),m=h.find(".cp-picker"),g=d.find(".cp-picker"),v=f.find(".cp-picker"),b=c(m,h),y=c(g,d),k=c(v,f),x=h[0].getBoundingClientRect().width,E=h[0].getBoundingClientRect().height,T=d[0].getBoundingClientRect().height,O=f[0].getBoundingClientRect().height,I=this.element.value();if(I=S(I)||I,(i=w(I))||(i="#ffffff"),e.hasClass("cp-grid")||e.hasClass("cp-slider"))switch(this.mode){case"wheel":a=x/2-b.x,s=E/2-b.y,l=Math.sqrt(a*a+s*s),u=Math.atan2(s,a),0>u&&(u+=2*Math.PI),l>75&&(l=75,b.x=69-75*Math.cos(u),b.y=69-75*Math.sin(u)),r=p(l/.75,0,100),n=p(180*u/Math.PI,0,360),o=p(100-Math.floor(y.y*(100/T)),0,100),i=C({h:n,s:r,b:o}),d.style({backgroundColor:C({h:n,s:r,b:100})});break;case"saturation":n=p(parseInt(b.x*(360/x),10),0,360),r=p(100-Math.floor(y.y*(100/T)),0,100),o=p(100-Math.floor(b.y*(100/E)),0,100),i=C({h:n,s:r,b:o}),d.style({backgroundColor:C({h:n,s:100,b:o})}),h.find(".cp-grid-inner").style({opacity:r/100});break;case"brightness":n=p(parseInt(b.x*(360/x),10),0,360),r=p(100-Math.floor(b.y*(100/E)),0,100),o=p(100-Math.floor(y.y*(100/T)),0,100),i=C({h:n,s:r,b:o}),d.style({backgroundColor:C({h:n,s:r,b:100})}),h.find(".cp-grid-inner").style({opacity:1-o/100});break;default:n=p(360-parseInt(y.y*(360/T),10),0,360),r=p(Math.floor(b.x*(100/x)),0,100),o=p(100-Math.floor(b.y*(100/E)),0,100),i=C({h:n,s:r,b:o}),h.style({backgroundColor:C({h:n,s:100,b:100})})}e.hasClass("cp-opacity-slider")&&(this.opacity=parseFloat(1-k.y/O).toFixed(2)),t.value(this.getValue(i)),this.emit("change",this.element,i,this.opacity)},reposition:function(){var t=this.element[0].getBoundingClientRect();this.wrapper.style({top:t.top+t.height+window.scrollY,left:t.left+window.scrollX})},getValue:function(t){if(1==this.opacity)return t;var e=O(t);return"rgba("+e.r+", "+e.g+", "+e.b+", "+this.opacity+")"}}),w=function(t){return t=t.replace(/[^A-F0-9]/gi,""),3!==t.length&&6!==t.length?"":(3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),"#"+t.toLowerCase())},k=function(t){var e={},i=Math.round(t.h),n=Math.round(255*t.s/100),r=Math.round(255*t.b/100);if(0===n)e.r=e.g=e.b=r;else{var o=r,a=(255-n)*r/255,s=(o-a)*(i%60)/60;360===i&&(i=0),60>i?(e.r=o,e.b=a,e.g=a+s):120>i?(e.g=o,e.b=a,e.r=o-s):180>i?(e.g=o,e.r=a,e.b=a+s):240>i?(e.b=o,e.r=a,e.g=o-s):300>i?(e.b=o,e.g=a,e.r=a+s):360>i?(e.r=o,e.g=a,e.b=o-s):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}},x=function(t){var e=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return h(e,function(t,i){1===t.length&&(e[i]="0"+t)}),"#"+e.join("")},S=function(t){return t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),t&&4===t.length?"#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2):""},C=function(t){return x(k(t))},E=function(t){var e=T(O(t));return 0===e.s&&(e.h=360),e},T=function(t){var e={h:0,s:0,b:0},i=Math.min(t.r,t.g,t.b),n=Math.max(t.r,t.g,t.b),r=n-i;return e.b=n,e.s=0!==n?255*r/n:0,e.h=0!==e.s?t.r===n?(t.g-t.b)/r:t.g===n?2+(t.b-t.r)/r:4+(t.r-t.g)/r:-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.b*=100/255,e},O=function(t){return t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16),{r:t>>16,g:(65280&t)>>8,b:255&t}};l(function(){var t=new y,e=s("body");t.on("change",function(t,i,n){clearTimeout(this.timer);var r=O(i),o=(299*r.r+587*r.g+114*r.b)/1e3>=128?"dark":"light",a="dark"==o||!n||.35>n;if(1>n){var s="rgba("+r.r+", "+r.g+", "+r.b+", "+n+")";t.style({backgroundColor:s})}else t.style({backgroundColor:i});t.parent(".colorpicker")[a?"removeClass":"addClass"]("light-text"),this.timer=setTimeout(function(){t.emit("input"),e.emit("input",{target:t})},150)})}),e.exports=y},{"../../ui/drag.events":40,elements:88,"elements/domready":86,"elements/zen":112,"mout/collection/forEach":164,"mout/function/bind":167,"mout/math/clamp":189,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256}],31:[function(t,e,i){"use strict";var n=t("../../utils/elements.utils"),r=t("prime"),o=t("agent"),a=t("elements/zen"),s=t("elements/domready"),l=t("mout/function/bind"),u=t("mout/string/rtrim"),c=t("mout/lang/deepClone"),h=t("mout/object/deepFillIn"),d=t("../../ui").modal,p=t("../../utils/get-ajax-suffix"),f=t("../../utils/get-ajax-url").global,m=t("dropzone"),g=new r({constructor:function(t){var e=t.data("g5-filepicker");this.data=e?JSON.parse(e):!1,this.colors={error:"#D84747",success:"#9ADF87",small:"#aaaaaa",gradient:["#9e38eb","#4e68fc"]}},open:function(){d.open({method:"post",data:this.data,content:"Loading",className:"g5-dialog-theme-default g5-modal-filepicker",remote:f("filepicker")+p(),remoteLoaded:l(this.loaded,this),afterClose:l(function(){this.dropzone&&this.dropzone.destroy()},this)})},getPath:function(){var t,e,i=this.content.search(".g-folders .active");return i?(t=n(i[i.length-1]),e=JSON.parse(t.data("folder")).pathname,u(e,"/")+"/"):null},getPreviewTemplate:function(){{var t=a("li[data-file]");a("div.g-thumb[data-dz-thumbnail]").bottom(t),a("span.g-file-name[data-dz-name]").bottom(t),a("span.g-file-size[data-dz-size]").bottom(t),a("span.g-file-mtime[data-dz-mtime]").bottom(t)}a("span.g-file-progress[data-file-uploadprogress]").html('<span class="g-file-progress-text"></span>').bottom(t),t.bottom("body");var e=t[0].outerHTML;return t.remove(),e},loaded:function(t,e){var i=e.elements.content,r=(i.search(".g-bookmark"),i.find(".g-files")),s=c(this.data),u=this.colors;this.content=i,r&&(this.dropzone=new m("body",{previewTemplate:this.getPreviewTemplate(),previewsContainer:r.find("ul:not(.g-list-labels)")[0],thumbnailWidth:100,thumbnailHeight:100,url:l(function(t){return f("filepicker/upload/"+this.getPath()+t[0].name)+p()},this)}),this.dropzone.on("thumbnail",function(t,e){n(t.previewElement).find("[data-dz-thumbnail]").attribute("style","background-image: url("+e+");")}),this.dropzone.on("addedfile",function(t){var e=n(t.previewElement),i=e.find("[data-file-uploadprogress]"),o=r.hasClass("g-filemode-list"),a={value:0,animation:!1,insertLocation:"bottom"};if(!t.type.match(/image.*/)){var s=t.name.split(".");s=s.length&&1!=s.length?s.reverse()[0]:"-",e.find(".g-thumb").text(s)}a=h(o?{size:20,thickness:10,fill:{color:u.small,gradient:!1}}:{size:50,thickness:"auto",fill:{gradient:u.gradient,color:!1}},a),e.addClass("g-file-uploading"),i.progresser(a),i.attribute("title","processing...").find(".g-file-progress-text").html("&bull;&bull;&bull;").attribute("title","processing...")}).on("processing",function(t){var e=n(t.previewElement).find("[data-file-uploadprogress]");e.find(".g-file-progress-text").text("0%").attribute("title","0%")}).on("sending",function(t,e,i){var r=n(t.previewElement).find("[data-file-uploadprogress]");r.attribute("title","0%").find(".g-file-progress-text").text("0%").attribute("title","0%")}).on("uploadprogress",function(t,e,i){var r=n(t.previewElement).find("[data-file-uploadprogress]");r.progresser({value:e/100}),r.attribute("title",Math.round(e)+"%").find(".g-file-progress-text").text(Math.round(e)+"%").attribute("title",Math.round(e)+"%")}).on("complete",function(t){}).on("error",function(t,e){var i=n(t.previewElement),o=i.find("[data-file-uploadprogress]"),a=i.find(".g-file-progress-text"),s=r.hasClass("g-filemode-list");i.addClass("g-file-error"),o.title("Error").progresser({fill:{color:u.error,gradient:!1},value:1,thickness:s?10:25}),a.title("Error").html('<i class="fa fa-exclamation"></i>').parent("[data-file-uploadprogress]").popover({content:e.html?e.html:e,placement:"auto",trigger:"mouse",style:"above-modal",width:"auto",targetEvents:!1})}).on("success",function(t,e,i){var o=n(t.previewElement),a=o.find("[data-file-uploadprogress]"),s=o.find(".g-file-mtime"),c=o.find(".g-file-progress-text"),h=o.find(".g-thumb"),d=r.hasClass("g-filemode-list");a.progresser({fill:{color:u.success,gradient:!1},value:1,thickness:d?10:25}),c.html('<i class="fa fa-check"></i>'),setTimeout(l(function(){a.animate({opacity:0},{duration:500}),h.animate({opacity:1},{duration:500,callback:function(){o.removeClass("g-file-uploading"),a.remove(),s.text("just now")}})},this),500)})),i.delegate("click",".g-bookmark-title",function(t,e){event&&event.preventDefault&&event.preventDefault();var i=e.nextSibling(".g-folders"),n=e.parent(".g-bookmark");i&&i.slideToggle(function(){n.toggleClass("collapsed",i.gSlideCollapsed)})}),i.delegate("click","[data-folder]",l(function(t,e){t&&t.preventDefault&&t.preventDefault();var i=JSON.parse(e.data("folder"));s.root=i.pathname,s.subfolder=!0,e.showIndicator("fa fa-li fa-fw fa-spin-fast fa-spinner"),o(f("filepicker")+p(),s).send(l(function(t,i){if(e.hideIndicator(),this.addActiveState(e),i.body.success){var n,o;i.body.subfolder&&(n=a("div").html(i.body.subfolder),o=e.nextSibling(),o&&!o.attribute("data-folder")&&o.remove(),n.children().after(e)),i.body.files?(r.empty(),n=a("div").html(i.body.files),n.children().bottom(r).style({opacity:0}).animate({opacity:1},{duration:"250ms"})):r.find("> ul:not(.g-list-labels)").empty(),this.dropzone.previewsContainer=r.find("ul:not(.g-list-labels)")[0]}else d.open({content:i.body.html||i.body,afterOpen:function(t){i.body.html||t.style({width:"90%"})}})},this))},this)),i.delegate("click","[data-file]",l(function(t,e){if(t&&t.preventDefault&&t.preventDefault(),!e.hasClass("g-file-error")&&!e.hasClass("g-file-uploading")){{JSON.parse(e.data("file"))}r.search("[data-file]").removeClass("selected"),e.addClass("selected")}},this)),i.delegate("click","[data-select]",l(function(t,e){t&&t.preventDefault&&t.preventDefault();var i=r.find("[data-file].selected"),o=i?i.data("file-url"):"";n(this.data.field).value(o),d.close()},this)),i.delegate("click","[data-files-mode]",l(function(t,e){if(t&&t.preventDefault&&t.preventDefault(),!e.hasClass("active")){var i=n("[data-files-mode]");i.removeClass("active"),e.addClass("active"),r.animate({opacity:0},{duration:200,callback:function(){var t=e.data("files-mode"),i=r.search("[data-file-uploadprogress]"),o="list"==t?{size:20,thickness:10,fill:{color:u.small,gradient:!1}}:{size:50,thickness:"auto",fill:{gradient:u.gradient,color:!1}};r.attribute("class","g-files g-block g-filemode-"+t),i&&i.forEach(function(e){e=n(e);var i=c(o);e.parent(".g-file-error")&&(i.fill={color:u.error},i.value=1,i.thickness="list"==t?10:25),e.progresser(i)}),r.animate({opacity:1},{duration:200})}})}},this))},addActiveState:function(t){var e=this.content.search("[data-folder].active, .g-folders > .active"),i=t.parent();for(e&&e.removeClass("active"),t.addClass("active");"ul"==i.tag()&&!i.hasClass("g-folders");)i.previousSibling().addClass("active"),i=i.parent()}});s(function(){var t=n("body");t.delegate("click","[data-g5-filepicker]",function(t,e){t&&t.preventDefault&&t.preventDefault(),e=n(e),e.GantryFilePicker||(e.GantryFilePicker=new g(e)),e.GantryFilePicker.open()})}),e.exports=g},{"../../ui":42,"../../utils/elements.utils":51,"../../utils/get-ajax-suffix":55,"../../utils/get-ajax-url":56,agent:61,dropzone:82,"elements/domready":86,"elements/zen":112,"mout/function/bind":167,"mout/lang/deepClone":174,"mout/object/deepFillIn":197,"mout/string/rtrim":235,prime:257}],32:[function(t,e,i){"use strict";var n=t("prime"),r=t("../../utils/elements.utils"),o=t("elements/zen"),a=t("prime/map")(),s=t("prime/emitter"),l=t("prime-util/prime/bound"),u=(t("prime-util/prime/options"),t("elements/domready")),c=t("../../utils/decouple"),h=t("mout/function/bind"),d=(t("mout/array/map"),t("mout/array/forEach")),p=t("mout/array/contains"),f=(t("mout/array/last"),t("mout/array/split"),t("mout/array/removeAll")),m=t("mout/array/insert"),g=t("mout/array/append"),v=t("mout/array/find"),b=t("mout/array/pluck"),y=t("mout/array/combine"),w=t("mout/array/intersection"),k=(t("mout/object/merge"),t("mout/string/unhyphenate")),x=t("mout/string/properCase"),S=t("mout/string/trim"),C=t("../../ui").modal,E=t("async"),T=(t("agent"),t("./webfont"));t("../../utils/elements.viewport");var O=new n({mixin:l,inherits:s,previewSentence:{latin:"Wizard boy Jack loves the grumpy Queen's fox.","latin-ext":"Wizard boy Jack loves the grumpy Queen's fox.",cyrillic:"     ? ,   !","cyrillic-ext":"     ? ,   !",devanagari:"        ",greek:"    ,    ","greek-ext":"    ,    ",khmer:" ",telugu:"   ",vietnamese:"Ti c th n thy tinh m khng hi g."},constructor:function(){this.wf=T,this.data=null,this.dataLocal=null,this.field=null,this.element=null,this.throttle=!1,this.selected=null,this.loadedFonts=[],this.filters={search:"",script:"latin",categories:[]}},open:function(t,e,i){if(!this.data||!this.field)return this.getData(e);var n=[];return d(this.data,function(t){n.push(t.family)}),i?(i.empty().attribute("style",null).appendChild(this.buildLayout()),this.scroll(i.find("ul.g-fonts-list")),this.updateTotal(),void this.selectFromValue()):void C.open({content:"Loading...",className:"g5-dialog-theme-default g5-modal-fonts",afterOpen:h(function(t){setTimeout(h(function(){t.empty().appendChild(this.buildLayout()),this.scroll(t.find("ul.g-fonts-list")),this.updateTotal(),this.selectFromValue()},this),1)},this)})},getData:function(t){var e=t.data("g5-fontpicker");if(!e)throw new Error("No fontpicker data found");e=JSON.parse(e),this.field=r(e.field),this.dataLocal=e.local||[],this.data=g([],this.dataLocal),C.open({content:"Loading...",className:"g5-dialog-theme-default g5-modal-fonts",remote:e.data,remoteLoaded:h(function(i,n){return i.error?(n.elements.content.html(i.body.html+"["+e.data+"]"),!1):(this.data=g(this.data,i.body.items),void this.open(null,t,n.elements.content))},this)})},scroll:function(t){clearTimeout(this.throttle),this.throttle=setTimeout(h(function(){if(!t)return void clearTimeout(this.throttle);var e=(t.find("ul.g-fonts-list")||t).inviewport(" > li:not(.g-font-hide)",2750),i=[];e&&(r(e).forEach(function(t){t=r(t);var e=t.data("font"),n=t.data("variant");!p(this.loadedFonts,e)&&n?i.push(e+("regular"!=n?":"+n:"")):n&&t.find('[data-variant="'+n+'"] .preview').style({fontFamily:e,fontWeight:"regular"==n?"normal":n})},this),i&&i.length&&this.wf.load({classes:!1,google:{families:i},fontactive:h(function(e,i){t.find('li[data-font="'+e+'"]:not(.g-variant-hide) > .preview').style({fontFamily:e,fontWeight:i}),this.loadedFonts.push(e)},this)}))},this),250)},unselect:function(t){if(t=t||this.selected,!t)return!1;var e=t.element.data("variant");t.element.removeClass("selected"),t.element.search("input[type=checkbox]").checked(!1),t.element.search("[data-font]").addClass("g-variant-hide"),t.element.find('[data-variant="'+e+'"]').removeClass("g-variant-hide"),t.variants=[t.baseVariant],t.selected=[]},selectFromValue:function(){var t,e,i,n=this.field.value(),o=!1;if(n.match("family=")){var a=n.split("&"),s=a[0],l=s.split(":");t=l[0].replace("family=","").replace(/\+/g," "),e=l[1]?l[1].split(","):["regular"],i=a[1]?a[1].replace("subset=","").split(","):["latin"]}else{var u,c=b(this.dataLocal,"family");if(n=n.replace(/(\s{1,})?,(\s{1,})?/gi,",").split(","),u=w(c,n),!u.length)return!1;o=!0,t=u.shift()}var d=r('ul.g-fonts-list > [data-font="'+t+'"]');e=e||d.data("variants").split(",")||["regular"],p(e,"400")&&(f(e,"400"),m(e,"regular")),p(e,"400italic")&&(f(e,"400italic"),m(e,"italic")),this.selected={font:t,baseVariant:d.data("variant"),element:d,variants:e,selected:[],local:o,charsets:i,availableVariants:d.data("variants").split(","),expanded:o,loaded:o},(o?[t]:e).forEach(function(t){this.select(d,t),t=d.find('> ul > [data-variant="'+t+'"]'),t&&t.removeClass("g-variant-hide")},this);var g=d.find(".font-charsets-selected");g&&g.text("("+i.length+" selected)"),o||(r("ul.g-fonts-list")[0].scrollTop=d[0].offsetTop),this.toggleExpansion(),setTimeout(h(function(){this.toggleExpansion()},this),50),o||setTimeout(h(function(){r("ul.g-fonts-list")[0].scrollTop=d[0].offsetTop},this,250))},select:function(t,e){var i=t.data("variant"),n=!i;if(!this.selected||this.selected.element!=t){if(e&&this.selected){var o=this.selected.element.find(".font-charsets-selected");o&&o.text("(1 selected)")}this.selected={font:t.data("font"),baseVariant:i,element:t,variants:[i],selected:[],local:n,charsets:["latin"],availableVariants:t.data("variants").split(","),expanded:n,loaded:n}}if(e||this.toggleExpansion(),e||n){var a=r('ul.g-fonts-list > [data-font]:not([data-font="'+this.selected.font+'"]) input[type="checkbox"]:checked');a&&(a.checked(!1),a.parent("[data-variants]").removeClass("font-selected"));var s=this.selected.element.find('input[type="checkbox"][value="'+(n?this.selected.font:e)+'"]'),l=s.checked();s&&s.checked(!l),l?(e!=this.selected.baseVariant&&f(this.selected.variants,e),f(this.selected.selected,e)):(m(this.selected.variants,e),m(this.selected.selected,e)),this.updateSelection()}},toggleExpansion:function(){if(!(this.selected.availableVariants.length<=1)){if(this.selected.local)return void(this.selected.expanded=!0);if(this.selected.expanded){var t=':not([data-variant="'+this.selected.variants.join('"]):not([data-variant="')+'"])';t=this.selected.element.search("[data-font]"+t),t&&t.addClass("g-variant-hide")}else{var e=this.selected.element.data("variants");e.split(",").length>1&&(this.manipulateLink(this.selected.font),this.selected.element.search("[data-font]").removeClass("g-variant-hide"),this.selected.loaded||this.wf.load({classes:!1,google:{families:[this.selected.font.replace(/\s/g,"+")+":"+e]},fontactive:h(function(t,e){var i=this.fvdToStyle(t,e),n=i.fontWeight;"400"==n?n="normal"==i.fontStyle?"regular":"italic":"italic"==i.fontStyle&&(n+="italic"),this.selected.element.find('li[data-variant="'+n+'"] .preview').style(i),this.selected.loaded=!0},this)}))}this.selected.expanded=!this.selected.expanded}},manipulateLink:function(t){t=t.replace(/\s/g,"+");var e=r('head link[href*="'+t+'"]');if(e){var i=decodeURIComponent(e.href()).split("|");!i||i.length<=1||(f(i,t),e.attribute("href",encodeURI(i.join("|"))))}},toggle:function(t,e){e=r(e);var i=r(t.target);return"checkbox"==i.attribute("type")&&i.checked(!i.checked()),this.select(e.parent("[data-font]")||e,e.parent("[data-font]")?e.data("variant"):!1,e),!1},updateSelection:function(){var t,e,i=r(".g-particles-footer .font-selected");if(i){if(!this.selected.selected.length)return i.empty(),void this.selected.element.removeClass("font-selected");t=this.selected.selected.sort(),e=this.selected.local?"(<small>local</small>)":"(<small>"+t.join(", ").replace("regular","normal")+"</small>)",this.selected.element.addClass("font-selected"),i.html("<strong>"+this.selected.font+"</strong> "+e)}},updateTotal:function(){var t=r(".g-particles-header .particle-search-total"),e=r(".g-fonts-list > [data-font]:not(.g-font-hide)");t.text(e?e.length:0)},buildLayout:function(){this.filters.script="latin";var t=this.previewSentence[this.filters.script],e=o("div#g-fonts.g-grid"),i=o("div.g-particles-main").bottom(e),n=o("ul.g-fonts-list").bottom(i),a=[],s=[],l=[];this.buildHeader(e).top(e),this.buildFooter(e).bottom(e),c(n,"scroll",h(this.scroll,this,n)),e.delegate("click",".g-fonts-list li[data-font]",h(this.toggle,this)),this.dataLocal.length&&this.buildLocalFonts(n),E.eachSeries(this.data,h(function(e,i){if(e.subsets=e.subsets||[],e.category=e.category||[],!e.category.length)return void i();y(l,e.subsets),m(s,e.category),this.filters.categories.push(e.category);var u=e.variants.join(",").replace("regular","normal"),c=p(e.variants,"regular")?"":":"+e.variants[0],d=o('li[data-font="'+e.family+'"][data-variant="'+(c.replace(":","")||"regular")+'"][data-variants="'+u+'"]').bottom(n),f=e.variants.length+" style"+(e.variants.length>1?"s":""),g=e.subsets.length>1?', <span class="font-charsets">'+e.subsets.length+' charsets <span class="font-charsets-selected">(1 selected)</span></span>':"",v=o("div.family").html("<strong>"+e.family+"</strong>, "+f+g).bottom(d),b=v.find(".font-charsets-selected");b&&b.popover({placement:"auto",width:"200",trigger:"mouse",style:"font-categories, above-modal"}).on("beforeshow.popover",h(function(t){var i,n=e.subsets,a=t.$target.find(".g5-popover-content");a.empty();var s;n.forEach(function(t){s=p(this.selected.charsets,t)?"latin"==t?"checked disabled":"checked":"",o("div").html('<label><input type="checkbox" '+s+' value="'+t+'"/> '+x(k(t.replace("ext","extended")))+"</label>").bottom(a)},this),a.delegate("click",'input[type="checkbox"]',h(function(t,e){e=r(e),i=a.search('input[type="checkbox"]:checked'),this.selected.charsets=i?i.map("value"):[],b.text("("+this.selected.charsets.length+" selected)")},this)),t.displayContent()},this)),i();var w,S=o("ul").bottom(d);E.each(e.variants,h(function(i){i+="",w=o('li[data-font="'+e.family+'"][data-variant="'+i+'"]').bottom(S),o('input[type="checkbox"][value="'+i+'"]').bottom(w),o("div.variant").html("<small>"+this.mapVariant(i)+"</small>").bottom(w),o("div.preview").text(t).bottom(w),":"+i!==c&&i!==(c||"regular")&&w.addClass("g-variant-hide")},this)),!p(e.subsets,"latin")&&e.subsets.length&&d.addClass("g-font-hide"),a.push(e.family+c)},this));var u=e.find("a.font-category"),d=e.find("a.font-subsets");return u.data("font-categories",s.join(",")).html("Categories (<small>"+s.length+'</small>) <i class="fa fa-caret-down"></i>'),d.data("font-subsets",l.join(",")).html("Subsets (<small>"+x(k(this.filters.script.replace("ext","extended")))+'</small>) <i class="fa fa-caret-down"></i>'),e},buildLocalFonts:function(t){var e,i,n,r;o("li.g-font-heading").text("Local Fonts").top(t),E.eachSeries(this.dataLocal,h(function(a,s){e=a.variants.join(","),i=o('li.g-local-font[data-font="'+a.family+'"][data-variant=""][data-variants="'+e+'"]').html('<input type="checkbox" value="'+a.family+'"/>').bottom(t),n=a.variants.length+" style"+(a.variants.length>1?"s":""),r=o("div.family").html("<strong>"+a.family+'</strong>, <span class="g-font-variants-list">'+n+"</span>").bottom(i),e&&r.find(".g-font-variants-list").popover({placement:"auto",width:"200",trigger:"mouse",style:"font-categories, above-modal"}).on("beforeshow.popover",h(function(t){var e=t.$target.find(".g5-popover-content");e.empty(),E.each(a.variants,h(function(t){t="400"==t?"regular":"400italic"==t?"italic":t+"",o("div").text(this.mapVariant(t)).bottom(e)},this)),t.displayContent()},this)),s()},this)),o("li.g-font-heading").text("Remote Fonts").bottom(t)},buildHeader:function(t){var e=o("div.settings-block.g-particles-header").bottom(t),i=o('input.float-left.font-preview[type="text"][data-font-preview][placeholder="Font Preview..."][value="'+this.previewSentence[this.filters.script]+'"]').bottom(e),n=o("span.particle-search-wrapper.float-right").bottom(e),r=o('input.font-search[type="text"][data-font-search][placeholder="Search Font..."]').bottom(n);return o("span.particle-search-total").bottom(n),r.on("keyup",h(this.search,this,r)),i.on("keyup",h(this.updatePreview,this,i)),e},buildFooter:function(t){var e,i=o("div.settings-block.g-particles-footer").bottom(t),n=o("div.float-left.font-left-container").bottom(i),a=o("div.float-right.font-right-container").bottom(i),s=o("a.font-category.button").bottom(n),l=o("a.font-subsets.button").bottom(n),u=(o("span.font-selected").bottom(a),o("button.button.button-primary").text("Select").bottom(a));return o("span").html("&nbsp;").bottom(a),o("button.button.g5-dialog-close").text("Cancel").bottom(a),u.on("click",h(function(){if(!r('ul.g-fonts-list > [data-font] input[type="checkbox"]:checked'))return this.field.value(""),void C.close();var t=this.selected.font.replace(/\s/g,"+"),e=this.selected.selected,i=this.selected.charsets;1==e.length&&"regular"==e[0]&&(e=[]),1==i.length&&"latin"==i[0]&&(i=[]),p(e,"regular")&&(f(e,"regular"),m(e,"400")),p(e,"italic")&&(f(e,"italic"),m(e,"400italic")),this.field.value(this.selected.local?t:"family="+t+(e.length?":"+e.join(","):"")+(i.length?"&subset="+i.join(","):"")),this.field.emit("input"),r("body").emit("input",{target:this.field}),C.close()},this)),s.popover({placement:"top",width:"200",trigger:"mouse",style:"font-categories, above-modal"}).on("beforeshow.popover",h(function(t){var i,n=s.data("font-categories").split(","),a=t.$target.find(".g5-popover-content");a.empty();n.forEach(function(t){e=p(this.filters.categories,t)?"checked":"",o("div").html('<label><input type="checkbox" '+e+' value="'+t+'"/> '+x(k(t))+"</label>").bottom(a)},this),a.delegate("click",'input[type="checkbox"]',h(function(t,e){e=r(e),i=a.search('input[type="checkbox"]:checked'),this.filters.categories=i?i.map("value"):[],s.find("small").text(this.filters.categories.length),this.search()},this)),t.displayContent()},this)),l.popover({placement:"top",width:"200",trigger:"mouse",style:"font-subsets, above-modal"}).on("beforeshow.popover",h(function(t){var i=l.data("font-subsets").split(","),n=t.$target.find(".g5-popover-content");n.empty();i.forEach(function(t){e=t==this.filters.script?"checked":"",o("div").html('<label><input name="font-subset[]" type="radio" '+e+' value="'+t+'"/> '+x(k(t.replace("ext","extended")))+"</label>").bottom(n)},this),n.delegate("change",'input[type="radio"]',h(function(t,e){e=r(e),this.filters.script=e.value(),r(".g-particles-header input.font-preview").value(this.previewSentence[this.filters.script]),l.find("small").text(x(k(e.value().replace("ext","extended")))),this.search(),this.updatePreview()},this)),t.displayContent()},this)),i},search:function(t){t=t||r(".g-particles-header input.font-search");var e,i,n=r(".g-fonts-list"),o=t.value();n.search("> [data-font]").forEach(function(t){return t=r(t),e=t.data("font"),i=v(this.data,{family:e}),t.removeClass("g-font-hide"),this.selected&&this.selected.font==e&&this.selected.selected.length?void 0:p(i.subsets,this.filters.script)&&p(this.filters.categories,i.category)?void(e.match(new RegExp("^"+o+"|\\s"+o,"gi"))?t.removeClass("g-font-hide"):t.addClass("g-font-hide")):void t.addClass("g-font-hide")},this),this.updateTotal(),clearTimeout(t.refreshTimer),t.refreshTimer=setTimeout(h(function(){this.scroll(r("ul.g-fonts-list"))},this),400),t.previousValue=o},updatePreview:function(t){t=t||r(".g-particles-header input.font-preview"),clearTimeout(t.refreshTimer);var e=t.value(),i=r(".g-fonts-list");return e=S(e)?S(e):this.previewSentence[this.filters.script],t.previousValue==e?!0:(i.search("[data-font] .preview").text(e),void(t.previousValue=e))},fvdToStyle:function(t,e){var i=e.match(/([a-z])([0-9])/);if(!i)return"";var n={n:"normal",i:"italic",o:"oblique"};return{fontFamily:t,fontStyle:n[i[1]],fontWeight:(100*i[2]).toString()}},mapVariant:function(t){switch(t){case"100":return"Thin 100";case"100italic":return"Thin 100 Italic";case"200":return"Extra-Light 200";case"200italic":return"Extra-Light 200 Italic";case"300":return"Light 300";case"300italic":return"Light 300 Italic";case"400":case"regular":return"Normal 400";case"400italic":case"italic":return"Normal 400 Italic";case"500":return"Medium 500";case"500italic":return"Medium 500 Italic";case"600":return"Semi-Bold 600";case"600italic":return"Semi-Bold 600 Italic";case"700":return"Bold 700";case"700italic":return"Bold 700 Italic";case"800":return"Extra-Bold 800";case"800italic":return"Extra-Bold 800 Italic";case"900":return"Ultra-Bold 900";case"900italic":return"Ultra-Bold 900 Italic";default:return"Unknown Variant"}}});u(function(){var t=r("body");t.delegate("click","[data-g5-fontpicker]",function(t,e){t&&t.preventDefault&&t.preventDefault();var i=a.get(e);i||(i=new O,a.set(e,i)),i.open(t,e)})}),e.exports=O},{"../../ui":42,"../../utils/decouple":50,"../../utils/elements.utils":51,"../../utils/elements.viewport":52,"./webfont":33,agent:61,async:81,"elements/domready":86,"elements/zen":112,"mout/array/append":140,"mout/array/combine":141,"mout/array/contains":142,"mout/array/find":147,"mout/array/forEach":150,"mout/array/insert":152,"mout/array/intersection":153,"mout/array/last":155,"mout/array/map":156,"mout/array/pluck":157,"mout/array/removeAll":158,"mout/array/split":161,"mout/function/bind":167,"mout/object/merge":208,"mout/string/properCase":232,"mout/string/trim":236,"mout/string/unhyphenate":238,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256,"prime/map":258}],33:[function(t,e,i){!function(t,e,i){function n(t,e,i){return t.call.apply(t.bind,arguments)}function r(t,e,i){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function o(t,e,i){return o=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?n:r,o.apply(null,arguments)}function a(t,e){this.K=t,this.w=e||t,this.G=this.w.document}function s(t,i,n){t=t.G.getElementsByTagName(i)[0],t||(t=e.documentElement),t&&t.lastChild&&t.insertBefore(n,t.lastChild)}function l(t,e){function i(){t.G.body?e():setTimeout(i,0)}i()}function u(t,e,i){e=e||[],i=i||[];for(var n=t.className.split(/\s+/),r=0;r<e.length;r+=1){for(var o=!1,a=0;a<n.length;a+=1)if(e[r]===n[a]){o=!0;break}o||n.push(e[r])}for(e=[],r=0;r<n.length;r+=1){for(o=!1,a=0;a<i.length;a+=1)if(n[r]===i[a]){o=!0;break}o||e.push(n[r])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function c(t,e){for(var i=t.className.split(/\s+/),n=0,r=i.length;r>n;n++)if(i[n]==e)return!0;return!1}function h(t){if("string"==typeof t.na)return t.na;var e=t.w.location.protocol;return"about:"==e&&(e=t.K.location.protocol),"https:"==e?"https:":"http:"}function d(t,e){var i=t.createElement("link",{rel:"stylesheet",href:e,media:"all"}),n=!1;i.onload=function(){n||(n=!0)},i.onerror=function(){n||(n=!0)},s(t,"head",i)}function p(e,i,n,r){var o=e.G.getElementsByTagName("head")[0];if(o){var a=e.createElement("script",{src:i}),s=!1;return a.onload=a.onreadystatechange=function(){s||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(s=!0,n&&n(null),a.onload=a.onreadystatechange=null,"HEAD"==a.parentNode.tagName&&o.removeChild(a))},o.appendChild(a),t.setTimeout(function(){s||(s=!0,n&&n(Error("Script load timeout")))},r||5e3),a}return null}function f(t,e){this.Y=t,this.ga=e}function m(t,e,i,n){this.c=null!=t?t:null,this.g=null!=e?e:null,this.D=null!=i?i:null,this.e=null!=n?n:null}function g(t){t=Q.exec(t);var e=null,i=null,n=null,r=null;return t&&(null!==t[1]&&t[1]&&(e=parseInt(t[1],10)),null!==t[2]&&t[2]&&(i=parseInt(t[2],10)),null!==t[3]&&t[3]&&(n=parseInt(t[3],10)),null!==t[4]&&t[4]&&(r=/^[0-9]+$/.test(t[4])?parseInt(t[4],10):t[4])),
new m(e,i,n,r)}function v(t,e,i,n,r,o,a,s){this.N=t,this.m=s}function b(t){this.a=t}function y(t){var e=x(t.a,/(iPod|iPad|iPhone|Android|Windows Phone|BB\d{2}|BlackBerry)/,1);return""!=e?(/BB\d{2}/.test(e)&&(e="BlackBerry"),e):(t=x(t.a,/(Linux|Mac_PowerPC|Macintosh|Windows|CrOS|PlayStation|CrKey)/,1),""!=t?("Mac_PowerPC"==t?t="Macintosh":"PlayStation"==t&&(t="Linux"),t):"Unknown")}function w(t){var e=x(t.a,/(OS X|Windows NT|Android) ([^;)]+)/,2);if(e||(e=x(t.a,/Windows Phone( OS)? ([^;)]+)/,2))||(e=x(t.a,/(iPhone )?OS ([\d_]+)/,2)))return e;if(e=x(t.a,/(?:Linux|CrOS|CrKey) ([^;)]+)/,1))for(var e=e.split(/\s/),i=0;i<e.length;i+=1)if(/^[\d\._]+$/.test(e[i]))return e[i];return(t=x(t.a,/(BB\d{2}|BlackBerry).*?Version\/([^\s]*)/,2))?t:"Unknown"}function k(t){var e=y(t),i=g(w(t)),n=g(x(t.a,/AppleWeb(?:K|k)it\/([\d\.\+]+)/,1)),r="Unknown",o=new m,o="Unknown",a=!1;return/OPR\/[\d.]+/.test(t.a)?r="Opera":-1!=t.a.indexOf("Chrome")||-1!=t.a.indexOf("CrMo")||-1!=t.a.indexOf("CriOS")?r="Chrome":/Silk\/\d/.test(t.a)?r="Silk":"BlackBerry"==e||"Android"==e?r="BuiltinBrowser":-1!=t.a.indexOf("PhantomJS")?r="PhantomJS":-1!=t.a.indexOf("Safari")?r="Safari":-1!=t.a.indexOf("AdobeAIR")?r="AdobeAIR":-1!=t.a.indexOf("PlayStation")&&(r="BuiltinBrowser"),"BuiltinBrowser"==r?o="Unknown":"Silk"==r?o=x(t.a,/Silk\/([\d\._]+)/,1):"Chrome"==r?o=x(t.a,/(Chrome|CrMo|CriOS)\/([\d\.]+)/,2):-1!=t.a.indexOf("Version/")?o=x(t.a,/Version\/([\d\.\w]+)/,1):"AdobeAIR"==r?o=x(t.a,/AdobeAIR\/([\d\.]+)/,1):"Opera"==r?o=x(t.a,/OPR\/([\d.]+)/,1):"PhantomJS"==r&&(o=x(t.a,/PhantomJS\/([\d.]+)/,1)),o=g(o),a="AdobeAIR"==r?2<o.c||2==o.c&&5<=o.g:"BlackBerry"==e?10<=i.c:"Android"==e?2<i.c||2==i.c&&1<i.g:526<=n.c||525<=n.c&&13<=n.g,new v(r,0,0,0,0,0,0,new f(a,536>n.c||536==n.c&&11>n.g))}function x(t,e,i){return(t=t.match(e))&&t[i]?t[i]:""}function S(t){this.ma=t||"-"}function C(t,e){this.N=t,this.Z=4,this.O="n";var i=(e||"n4").match(/^([nio])([1-9])$/i);i&&(this.O=i[1],this.Z=parseInt(i[2],10))}function E(t){return t.O+t.Z}function T(t){var e=4,i="n",n=null;return t&&((n=t.match(/(normal|oblique|italic)/i))&&n[1]&&(i=n[1].substr(0,1).toLowerCase()),(n=t.match(/([1-9]00|normal|bold)/i))&&n[1]&&(/bold/i.test(n[1])?e=7:/[1-9]00/.test(n[1])&&(e=parseInt(n[1].substr(0,1),10)))),i+e}function O(t,e){this.d=t,this.q=t.w.document.documentElement,this.Q=e,this.j="wf",this.h=new S("-"),this.ha=!1!==e.events,this.F=!1!==e.classes}function I(t){if(t.F){var e=c(t.q,t.h.e(t.j,"active")),i=[],n=[t.h.e(t.j,"loading")];e||i.push(t.h.e(t.j,"inactive")),u(t.q,i,n)}A(t,"inactive")}function A(t,e,i){t.ha&&t.Q[e]&&(i?t.Q[e](i.getName(),E(i)):t.Q[e]())}function z(){this.C={}}function _(t,e){this.d=t,this.I=e,this.k=this.d.createElement("span",{"aria-hidden":"true"},this.I)}function D(t){s(t.d,"body",t.k)}function N(t){var e;e=[];for(var i=t.N.split(/,\s*/),n=0;n<i.length;n++){var r=i[n].replace(/['"]/g,"");e.push(-1==r.indexOf(" ")?r:"'"+r+"'")}return e=e.join(","),i="normal","o"===t.O?i="oblique":"i"===t.O&&(i="italic"),"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+e+";"+("font-style:"+i+";font-weight:"+(t.Z+"00")+";")}function F(t,e,i,n,r,o,a,s){this.$=t,this.ka=e,this.d=i,this.o=n,this.m=r,this.I=s||"BESbswy",this.v={},this.X=o||3e3,this.ca=a||null,this.H=this.u=this.t=null,this.t=new _(this.d,this.I),this.u=new _(this.d,this.I),this.H=new _(this.d,this.I),t=new C("serif",E(this.o)),t=N(t),this.t.k.style.cssText=t,t=new C("sans-serif",E(this.o)),t=N(t),this.u.k.style.cssText=t,t=new C("monospace",E(this.o)),t=N(t),this.H.k.style.cssText=t,D(this.t),D(this.u),D(this.H),this.v.serif=this.t.k.offsetWidth,this.v["sans-serif"]=this.u.k.offsetWidth,this.v.monospace=this.H.k.offsetWidth}function j(t,e,i){for(var n in tt)if(tt.hasOwnProperty(n)&&e===t.v[tt[n]]&&i===t.v[tt[n]])return!0;return!1}function L(t){var e=t.t.k.offsetWidth,i=t.u.k.offsetWidth;e===t.v.serif&&i===t.v["sans-serif"]||t.m.ga&&j(t,e,i)?K()-t.oa>=t.X?t.m.ga&&j(t,e,i)&&(null===t.ca||t.ca.hasOwnProperty(t.o.getName()))?P(t,t.$):P(t,t.ka):M(t):P(t,t.$)}function M(t){setTimeout(o(function(){L(this)},t),50)}function P(t,e){t.t.remove(),t.u.remove(),t.H.remove(),e(t.o)}function R(t,e,i,n){this.d=e,this.A=i,this.S=0,this.ea=this.ba=!1,this.X=n,this.m=t.m}function B(t,e,i,n,r){if(i=i||{},0===e.length&&r)I(t.A);else for(t.S+=e.length,r&&(t.ba=r),r=0;r<e.length;r++){var a=e[r],s=i[a.getName()],l=t.A,c=a;l.F&&u(l.q,[l.h.e(l.j,c.getName(),E(c).toString(),"loading")]),A(l,"fontloading",c),l=null,l=new F(o(t.ia,t),o(t.ja,t),t.d,a,t.m,t.X,n,s),l.start()}}function $(t){0==--t.S&&t.ba&&(t.ea?(t=t.A,t.F&&u(t.q,[t.h.e(t.j,"active")],[t.h.e(t.j,"loading"),t.h.e(t.j,"inactive")]),A(t,"active")):I(t.A))}function H(t){this.K=t,this.B=new z,this.pa=new b(t.navigator.userAgent),this.a=this.pa.parse(),this.U=this.V=0,this.R=this.T=!0}function q(t,e,i,n,r){var o=0==--t.V;(t.R||t.T)&&setTimeout(function(){B(e,i,n||null,r||null,o)},0)}function U(t,e,i){this.P=t?t:e+et,this.s=[],this.W=[],this.fa=i||""}function V(t){this.s=t,this.da=[],this.M={}}function W(t,e){this.a=new b(navigator.userAgent).parse(),this.d=t,this.f=e}function X(t,e){this.d=t,this.f=e,this.p=[]}function Y(t,e){this.d=t,this.f=e,this.p=[]}function G(t,e){this.d=t,this.f=e,this.p=[]}function J(t,e){this.d=t,this.f=e}var K=Date.now||function(){return+new Date};a.prototype.createElement=function(t,e,i){if(t=this.G.createElement(t),e)for(var n in e)e.hasOwnProperty(n)&&("style"==n?t.style.cssText=e[n]:t.setAttribute(n,e[n]));return i&&t.appendChild(this.G.createTextNode(i)),t};var Q=/^([0-9]+)(?:[\._-]([0-9]+))?(?:[\._-]([0-9]+))?(?:[\._+-]?(.*))?$/;m.prototype.compare=function(t){return this.c>t.c||this.c===t.c&&this.g>t.g||this.c===t.c&&this.g===t.g&&this.D>t.D?1:this.c<t.c||this.c===t.c&&this.g<t.g||this.c===t.c&&this.g===t.g&&this.D<t.D?-1:0},m.prototype.toString=function(){return[this.c,this.g||"",this.D||"",this.e||""].join("")},v.prototype.getName=function(){return this.N};var Z=new v("Unknown",0,0,0,0,0,0,new f(!1,!1));b.prototype.parse=function(){var t;if(-1!=this.a.indexOf("MSIE")||-1!=this.a.indexOf("Trident/")){t=y(this);var e=g(w(this)),i=null,n=x(this.a,/Trident\/([\d\w\.]+)/,1),i=g(-1!=this.a.indexOf("MSIE")?x(this.a,/MSIE ([\d\w\.]+)/,1):x(this.a,/rv:([\d\w\.]+)/,1));""!=n&&g(n),t=new v("MSIE",0,0,0,0,0,0,new f("Windows"==t&&6<=i.c||"Windows Phone"==t&&8<=e.c,!1))}else if(-1!=this.a.indexOf("Opera"))t:if(t=g(x(this.a,/Presto\/([\d\w\.]+)/,1)),g(w(this)),null!==t.c||g(x(this.a,/rv:([^\)]+)/,1)),-1!=this.a.indexOf("Opera Mini/"))t=g(x(this.a,/Opera Mini\/([\d\.]+)/,1)),t=new v("OperaMini",0,0,0,y(this),0,0,new f(!1,!1));else{if(-1!=this.a.indexOf("Version/")&&(t=g(x(this.a,/Version\/([\d\.]+)/,1)),null!==t.c)){t=new v("Opera",0,0,0,y(this),0,0,new f(10<=t.c,!1));break t}t=g(x(this.a,/Opera[\/ ]([\d\.]+)/,1)),t=null!==t.c?new v("Opera",0,0,0,y(this),0,0,new f(10<=t.c,!1)):new v("Opera",0,0,0,y(this),0,0,new f(!1,!1))}else/OPR\/[\d.]+/.test(this.a)?t=k(this):/AppleWeb(K|k)it/.test(this.a)?t=k(this):-1!=this.a.indexOf("Gecko")?(t="Unknown",e=new m,g(w(this)),e=!1,-1!=this.a.indexOf("Firefox")?(t="Firefox",e=g(x(this.a,/Firefox\/([\d\w\.]+)/,1)),e=3<=e.c&&5<=e.g):-1!=this.a.indexOf("Mozilla")&&(t="Mozilla"),i=g(x(this.a,/rv:([^\)]+)/,1)),e||(e=1<i.c||1==i.c&&9<i.g||1==i.c&&9==i.g&&2<=i.D),t=new v(t,0,0,0,y(this),0,0,new f(e,!1))):t=Z;return t},S.prototype.e=function(t){for(var e=[],i=0;i<arguments.length;i++)e.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.ma)},C.prototype.getName=function(){return this.N},_.prototype.remove=function(){var t=this.k;t.parentNode&&t.parentNode.removeChild(t)};var tt={sa:"serif",ra:"sans-serif",qa:"monospace"};F.prototype.start=function(){this.oa=K();var t=new C(this.o.getName()+",serif",E(this.o)),t=N(t);this.t.k.style.cssText=t,t=new C(this.o.getName()+",sans-serif",E(this.o)),t=N(t),this.u.k.style.cssText=t,L(this)},R.prototype.ia=function(t){var e=this.A;e.F&&u(e.q,[e.h.e(e.j,t.getName(),E(t).toString(),"active")],[e.h.e(e.j,t.getName(),E(t).toString(),"loading"),e.h.e(e.j,t.getName(),E(t).toString(),"inactive")]),A(e,"fontactive",t),this.ea=!0,$(this)},R.prototype.ja=function(t){var e=this.A;if(e.F){var i=c(e.q,e.h.e(e.j,t.getName(),E(t).toString(),"active")),n=[],r=[e.h.e(e.j,t.getName(),E(t).toString(),"loading")];i||n.push(e.h.e(e.j,t.getName(),E(t).toString(),"inactive")),u(e.q,n,r)}A(e,"fontinactive",t),$(this)},H.prototype.load=function(t){this.d=new a(this.K,t.context||this.K),this.T=!1!==t.events,this.R=!1!==t.classes;var e=new O(this.d,t),i=[],n=t.timeout;e.F&&u(e.q,[e.h.e(e.j,"loading")]),A(e,"loading");var r,i=this.B,s=this.d,l=[];for(r in t)if(t.hasOwnProperty(r)){var c=i.C[r];c&&l.push(c(t[r],s))}for(i=l,this.U=this.V=i.length,t=new R(this.a,this.d,e,n),n=0,r=i.length;r>n;n++)s=i[n],s.L(this.a,o(this.la,this,s,e,t))},H.prototype.la=function(t,e,i,n){var r=this;n?t.load(function(t,e,n){q(r,i,t,e,n)}):(t=0==--this.V,this.U--,t&&0==this.U?I(e):(this.R||this.T)&&B(i,[],{},null,t))};var et="//fonts.googleapis.com/css";U.prototype.e=function(){if(0==this.s.length)throw Error("No fonts to load!");if(-1!=this.P.indexOf("kit="))return this.P;for(var t=this.s.length,e=[],i=0;t>i;i++)e.push(this.s[i].replace(/ /g,"+"));return t=this.P+"?family="+e.join("%7C"),0<this.W.length&&(t+="&subset="+this.W.join(",")),0<this.fa.length&&(t+="&text="+encodeURIComponent(this.fa)),t};var it={latin:"BESbswy",cyrillic:"&#1081;&#1103;&#1046;",greek:"&#945;&#946;&#931;",khmer:"&#x1780;&#x1781;&#x1782;",Hanuman:"&#x1780;&#x1781;&#x1782;"},nt={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},rt={i:"i",italic:"i",n:"n",normal:"n"},ot=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;V.prototype.parse=function(){for(var t=this.s.length,e=0;t>e;e++){var i=this.s[e].split(":"),n=i[0].replace(/\+/g," "),r=["n4"];if(2<=i.length){var o,a=i[1];if(o=[],a)for(var a=a.split(","),s=a.length,l=0;s>l;l++){var u;if(u=a[l],u.match(/^[\w-]+$/)){u=ot.exec(u.toLowerCase());var c=void 0;if(null==u)c="";else{if(c=void 0,c=u[1],null==c||""==c)c="4";else var h=nt[c],c=h?h:isNaN(c)?"4":c.substr(0,1);u=u[2],c=[null==u||""==u?"n":rt[u],c].join("")}u=c}else u="";u&&o.push(u)}0<o.length&&(r=o),3==i.length&&(i=i[2],o=[],i=i?i.split(","):o,0<i.length&&(i=it[i[0]])&&(this.M[n]=i))}for(this.M[n]||(i=it[n])&&(this.M[n]=i),i=0;i<r.length;i+=1)this.da.push(new C(n,r[i]))}};var at={Arimo:!0,Cousine:!0,Tinos:!0};W.prototype.L=function(t,e){e(t.m.Y)},W.prototype.load=function(t){var e=this.d;"MSIE"==this.a.getName()&&1!=this.f.blocking?l(e,o(this.aa,this,t)):this.aa(t)},W.prototype.aa=function(t){for(var e=this.d,i=new U(this.f.api,h(e),this.f.text),n=this.f.families,r=n.length,o=0;r>o;o++){var a=n[o].split(":");3==a.length&&i.W.push(a.pop());var s="";2==a.length&&""!=a[1]&&(s=":"),i.s.push(a.join(s))}n=new V(n),n.parse(),d(e,i.e()),t(n.da,n.M,at)},X.prototype.J=function(t){var e=this.d;return h(this.d)+(this.f.api||"//f.fontdeck.com/s/css/js/")+(e.w.location.hostname||e.K.location.hostname)+"/"+t+".js"},X.prototype.L=function(t,e){var i=this.f.id,n=this.d.w,r=this;i?(n.__webfontfontdeckmodule__||(n.__webfontfontdeckmodule__={}),n.__webfontfontdeckmodule__[i]=function(t,i){for(var n=0,o=i.fonts.length;o>n;++n){var a=i.fonts[n];r.p.push(new C(a.name,T("font-weight:"+a.weight+";font-style:"+a.style)))}e(t)},p(this.d,this.J(i),function(t){t&&e(!1)})):e(!1)},X.prototype.load=function(t){t(this.p)},Y.prototype.J=function(t){var e=h(this.d);return(this.f.api||e+"//use.typekit.net")+"/"+t+".js"},Y.prototype.L=function(t,e){var i=this.f.id,n=this.d.w,r=this;i?p(this.d,this.J(i),function(t){if(t)e(!1);else{if(n.Typekit&&n.Typekit.config&&n.Typekit.config.fn){t=n.Typekit.config.fn;for(var i=0;i<t.length;i+=2)for(var o=t[i],a=t[i+1],s=0;s<a.length;s++)r.p.push(new C(o,a[s]));try{n.Typekit.load({events:!1,classes:!1})}catch(l){}}e(!0)}},2e3):e(!1)},Y.prototype.load=function(t){t(this.p)},G.prototype.L=function(t,e){var i=this,n=i.f.projectId,r=i.f.version;if(n){var o=i.d.w;p(this.d,i.J(n,r),function(r){if(r)e(!1);else{if(o["__mti_fntLst"+n]&&(r=o["__mti_fntLst"+n]()))for(var a=0;a<r.length;a++)i.p.push(new C(r[a].fontfamily));e(t.m.Y)}}).id="__MonotypeAPIScript__"+n}else e(!1)},G.prototype.J=function(t,e){var i=h(this.d),n=(this.f.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,"");return i+"//"+n+"/"+t+".js"+(e?"?v="+e:"")},G.prototype.load=function(t){t(this.p)},J.prototype.load=function(t){var e,i,n=this.f.urls||[],r=this.f.families||[],o=this.f.testStrings||{};for(e=0,i=n.length;i>e;e++)d(this.d,n[e]);for(n=[],e=0,i=r.length;i>e;e++){var a=r[e].split(":");if(a[1])for(var s=a[1].split(","),l=0;l<s.length;l+=1)n.push(new C(a[0],s[l]));else n.push(new C(a[0]))}t(n,o)},J.prototype.L=function(t,e){return e(t.m.Y)};var st=new H(this);st.B.C.custom=function(t,e){return new J(e,t)},st.B.C.fontdeck=function(t,e){return new X(e,t)},st.B.C.monotype=function(t,e){return new G(e,t)},st.B.C.typekit=function(t,e){return new Y(e,t)},st.B.C.google=function(t,e){return new W(e,t)},this.WebFont||(this.WebFont={},this.WebFont.load=o(st.load,st),this.WebFontConfig&&st.load(this.WebFontConfig))}(this,document),e.exports=window.WebFont},{}],34:[function(t,e,i){"use strict";var n=t("../../utils/elements.utils"),r=t("elements/domready"),o=t("../../ui").modal,a=t("../../utils/get-ajax-suffix"),s=t("../../utils/get-ajax-url").global,l=t("mout/string/trim"),u=t("mout/array/contains");r(function(){var t=n("body");t.delegate("keyup",'.g-icons input[type="text"]',function(t,e){e=n(e);var i,r=e.sibling("[data-g5-iconpicker]"),o=e.value();r.attribute("class",o||"fa fa-hand-o-up picker"),i=r[0].offsetWidth,i||r.attribute("class","fa fa-hand-o-up picker")}),t.delegate("click","[data-g5-iconpicker]",function(t,e){t&&t.preventDefault&&t.preventDefault(),e=n(e);var i=n(e.data("g5-iconpicker")),r=e,c=l(i.value()).replace(/\s{2,}/g," ").split(" ");o.open({content:"Loading",className:"g5-dialog-theme-default g5-modal-icons",remote:s("icons")+a(),afterClose:function(){var t=n(".g5-popover");t&&t.remove()},remoteLoaded:function(t,e){var a,s,l=e.elements.content,h=l.search("[data-g-icon]");if(!h||!t.body.success)return l.html(t.body.html||t.body),!1;var d=function(){var t=[],e=l.find("[data-g-icon].active"),i=l.search(".g-particles-header .float-right input:checked, .g-particles-header .float-right select");e&&t.push(e.data("g-icon")),i&&i.forEach(function(e){var i=n(e).value();i&&"fa-"!==i&&t.push(i)}),l.find(".g-icon-preview").html('<i class="fa '+t.join(" ")+'"></i> <span>'+t[0]+"</span>")},p=function(){var t=l.search("[data-g-icon]:not(.hide-icon)");l.find(".particle-search-total").text(t?t.length:0)};l.delegate("click","[data-g-icon]",function(t,e){t&&t.preventDefault&&t.preventDefault(),e=n(e);var i=l.find("[data-g-icon].active");i&&i.removeClass("active"),e.addClass("active"),d()}),l.delegate("click","[data-g-select]",function(t){t.preventDefault();var e=l.find(".g-icon-preview i");i.value(e.attribute("class")),r.find("i").attribute("class",e.attribute("class")),i.emit("input"),n("body").emit("input",{target:i}),o.close()}),l.delegate("change",'.g-particles-header .float-right input[type="checkbox"], .g-particles-header .float-right select',function(){d()}),l.delegate("keyup",'.particle-search-wrapper input[type="text"]',function(t,e){e=n(e);var i=e.value(),r=l.search("[data-g-icon].hide-icon");if(!i)return r&&(r.removeClass("hide-icon"),p()),!0;var o=l.search('[data-g-icon*="'+i+'"]');l.search("[data-g-icon]").addClass("hide-icon"),o&&o.removeClass("hide-icon"),p()}),h.forEach(function(t){t=n(t),a="";for(var e=5,i=0;e>i;e--)s=e?e+"x":"lg",a+='<i class="fa '+t.data("g-icon")+" fa-"+s+'"></i> ';if(t.popover({content:a,placement:"auto",trigger:"mouse",style:"above-modal, icons-preview",width:"auto",targetEvents:!1,delay:1}).on("hidden.popover",function(t){t.$target&&t.$target.remove()}),u(c,t.data("g-icon"))){t.addClass("active"),c.forEach(function(t){var e=l.find('[name="'+t+'"]');e?e.checked(!0):(e=l.find('option[value="'+t+'"]'),e&&e.parent().value(t))});var r=t.parent(".icons-wrapper"),o=r[0].offsetHeight;r[0].scrollTop=t[0].offsetTop-o/2,d()}})}})})}),e.exports={}},{"../../ui":42,"../../utils/elements.utils":51,"../../utils/get-ajax-suffix":55,"../../utils/get-ajax-url":56,"elements/domready":86,"mout/array/contains":142,"mout/string/trim":236}],35:[function(t,e,i){"use strict";e.exports={colorpicker:t("./colorpicker"),fonts:t("./fonts"),menu:t("./menu"),icons:t("./icons"),filepicker:t("./filepicker"),collections:t("./collections"),keyvalue:t("./keyvalue")}},{"./collections":29,"./colorpicker":30,"./filepicker":31,"./fonts":32,"./icons":34,"./keyvalue":36,"./menu":37}],36:[function(t,e,i){"use strict";{var n=t("elements/domready"),r=t("elements"),o=(t("elements/zen"),t("mout/object/has")),a=t("mout/array/some"),s=(t("../../ui").modal,t("../../ui").toastr,t("agent"),t("mout/array/indexOf")),l=t("mout/array/contains"),u=t("mout/array/last"),c=t("sortablejs"),h=t("mout/string/escapeUnicode"),d=t("mout/string/trim");t("../../utils/get-ajax-suffix")}t("elements/insertion"),n(function(){var t=r("body"),e=function(e){var i=e||r(".g-keyvalue-field ul");i&&i.forEach(function(e){e=r(e),e.SimpleSort=c.create(e[0],{handle:".fa-reorder",filter:"[data-keyvalue-nosort]",scroll:!1,animation:150,onStart:function(){r(this.el).addClass("keyvalue-sorting")},onEnd:function(e){var i=r(this.el);if(i.removeClass("keyvalue-sorting"),e.oldIndex!==e.newIndex){var n=i.parent(".settings-param").find("[data-keyvalue-data]"),o=n.value();o=JSON.parse(o),o.splice(e.newIndex,0,o.splice(e.oldIndex,1)[0]),n.value(JSON.stringify(o)),t.emit("change",{target:n})}}})})};e(),t.delegate("mouseover",".g-keyvalue-field ul",function(t,i){i.SimpleSort||e(i)}),t.delegate("click","[data-keyvalue-addnew]",function(t,e){var i=e.parent(".settings-param"),n=i.find("ul"),o=i.find("[data-keyvalue-template]"),a=n.search("> [data-keyvalue-item]")||[],s=r(u(a)),l=r(o[0].cloneNode(!0));s?l.after(s):l.top(n),l.attribute("style",null).data("keyvalue-item",l.data("keyvalue-template")),l.attribute("data-keyvalue-template",null),l.attribute("data-keyvalue-nosort",null),l.find("[data-keyvalue-key]")[0].focus()}),t.delegate("click","[data-keyvalue-remove]",function(e,i){e&&e.preventDefault&&e.preventDefault();var n=i.parent("[data-keyvalue-item]"),r=(n.find('input[type="text"]').data("keyvalue-key"),i.parent(".settings-param").find("[data-keyvalue-data]")),o=i.parent("ul").search("> [data-keyvalue-item]"),a=s(o,n[0]),l=JSON.parse(r.value());l.splice(a,1),r.value(h(JSON.stringify(l))),n.remove(),t.emit("change",{target:r})}),t.delegate("blur",'[data-keyvalue-item] input[type="text"]',function(e,i){var n=i.parent("[data-keyvalue-item]"),r=n.find(".g-keyvalue-wrapper"),u=n.find("[data-keyvalue-key]"),c=n.find("[data-keyvalue-value]"),p=u.data("keyvalue-key"),f=d(u.value()),m=d(c.value()),g=i.parent("ul").search("> [data-keyvalue-item]:not(.g-keyvalue-warning):not(.g-keyvalue-excluded)"),v=s(g,n[0]),b=i.parent(".settings-param").find("[data-keyvalue-data]"),y=JSON.parse(b.value()),w=JSON.parse(b.data("keyvalue-exclude")),k=l(w,f),x=a(y,function(t){return o(t,f)})&&p!==f;u==i&&(p===f||x||(y.splice(v,1),u.data("keyvalue-key",f||"")),n[x?"addClass":"removeClass"]("g-keyvalue-warning"),n[k?"addClass":"removeClass"]("g-keyvalue-excluded"),r[k||x?"addClass":"removeClass"]("g-tooltip"),r.data("title",x?'The key "'+f+'" is a duplicate':k?'The key "'+f+'" has been excluded and cannot be used':null)),!f||k||x||(y[v]||y.splice(v,0,{}),y[v][f]=m),b.value(h(JSON.stringify(y))),t.emit("change",{target:b})},!0)}),e.exports={}},{"../../ui":42,"../../utils/get-ajax-suffix":55,agent:61,elements:88,"elements/domready":86,"elements/insertion":89,"elements/zen":112,"mout/array/contains":142,"mout/array/indexOf":151,"mout/array/last":155,"mout/array/some":160,"mout/object/has":205,"mout/string/escapeUnicode":228,"mout/string/trim":236,sortablejs:272}],37:[function(t,e,i){"use strict";var n=t("../../utils/elements.utils"),r=t("elements/domready");r(function(){var t=n("body");t.delegate("click","[data-g5-content] .g-main-nav .g-toplevel [data-g5-ajaxify]",function(t,e){t&&t.preventDefault&&t.preventDefault();var i=n("[data-g5-content] .g-main-nav .g-toplevel [data-g5-ajaxify] !> li");i&&i.removeClass("active"),e.parent("li").addClass("active")})}),e.exports={}},{"../../utils/elements.utils":51,"elements/domready":86}],38:[function(t,e,i){"use strict";var n=t("elements/domready"),r=t("elements/attributes"),o=t("../ui").modal,a=t("mout/array/contains"),s=t("mout/collection/forEach");t("../ui/popover");navigator.userAgent.toLowerCase().indexOf("firefox")>-1;n(function(){var t=r("body");t.delegate("click","[data-g-styles]",function(e,i){var n=r(e.target);if(e&&e.preventDefault&&e.preventDefault(),n.hasClass("swatch-preview")||n.parent(".swatch-preview"))return!0;var o,l,u,c,h=JSON.parse(i.data("g-styles"));s(h,function(e,i){o=r('[name="'+i+'"]'),l=o?o.value():!1,o&&l!==e&&(c={target:o,forceOverride:!0},u="select"==o.tag()||a(["hidden","checkbox"],o.type())?"change":"input",o.value(e),t.emit(u,c),t.emit("keyup",c))})}),t.delegate("click","[data-g-styles] .swatch-preview",function(t,e){var i=e.parent("[data-g-styles]").find("img");return i?void o.open({content:i[0].outerHTML,afterOpen:function(t){var e=parseInt(t.compute("padding-left"),10)+parseInt(t.compute("padding-right"),10);t.style({maxWidth:"80%",width:e+(i[0].naturalWidth||i[0].width)})}}):!1})}),e.exports={}},{"../ui":42,"../ui/popover":44,"elements/attributes":83,"elements/domready":86,"mout/array/contains":142,"mout/collection/forEach":164}],39:[function(t,e,i){"use strict";var n=t("prime"),r=t("prime/emitter"),o=t("prime-util/prime/bound"),a=t("prime-util/prime/options"),s=t("mout/function/bind"),l=(t("mout/array/contains"),t("./drag.events")),u=t("../utils/elements.utils");t("elements/events"),t("elements/delegation");var c="Microsoft Internet Explorer"===navigator.appName,h=new n({mixin:[o,a],inherits:r,options:{delegate:null,droppables:!1,catchClick:!1},DRAG_EVENTS:l,constructor:function(t,e){this.container=u(t),this.container&&(this.setOptions(e),this.element=null,this.origin={x:0,y:0,transform:null,offset:{x:0,y:0}},this.matched=!1,this.lastMatched=!1,this.lastOvered=null,this.attach())},attach:function(){this.DRAG_EVENTS.EVENTS.START.forEach(s(function(t){this.container.delegate(t,this.options.delegate,this.bound("start"))},this))},detach:function(){this.DRAG_EVENTS.EVENTS.START.forEach(s(function(t){this.container.undelegate(t,this.options.delegate,this.bound("start"))},this))},start:function(t,e){t&&t.type.match(/^touch/i)&&t.preventDefault(),clearTimeout(this.scrollInterval),e.LMTooltip&&e.LMTooltip.remove(),u("html").attribute("style","height: 100% !important"),this.scrollHeight=document.body.scrollHeight;var i=u(t.target);if(!e.parent("[data-lm-root]")&&e.hasClass("g-block")&&!i.matches(".submenu-reorder")&&!i.parent(".submenu-reorder"))return!0;if(t.which&&1!==t.which||u(t.target).matches(this.options.exclude))return!0;this.element=u(e),this.matched=!1,this.options.catchClick&&(this.moved=!1),(i.matches(".submenu-reorder")||i.parent(".submenu-reorder"))&&(this.element=i.parent("[data-mm-id]")),this.emit("dragdrop:beforestart",t,this.element),c&&this.element.style({"-ms-touch-action":"none","touch-action":"none"}),t.preventDefault(),this.origin={x:t.changedTouches?t.changedTouches[0].pageX:t.pageX,y:t.changedTouches?t.changedTouches[0].pageY:t.pageY,transform:this.element.compute("transform")};var n=this.element[0].getBoundingClientRect();if(this.origin.offset={clientRect:n,x:this.origin.x-n.right,y:n.top-this.origin.y},"grid"===this.element.data("lm-blocktype")&&Math.abs(this.origin.offset.x)<n.width)return!1;var r=Math.abs(this.origin.offset.x),o="grid"===this.element.parent().data("lm-blocktype")&&this.element.parent().parent().data("lm-root")||"container"==this.element.parent().parent().data("lm-blocktype")&&this.element.parent().parent().parent().data("lm-root");return("grid"==this.element.data("lm-blocktype")&&"container"===this.element.parent().data("lm-blocktype")&&this.element.parent().parent().parent().data("lm-root")||"section"===this.element.parent().data("lm-blocktype")&&this.element.parent().parent().parent().data("lm-root"))&&(o=!1),6>r&&this.element.parent().find(":last-child")!==this.element||o&&r>3&&10>r?this.element.parent('[data-lm-blocktype="atoms"]')?!1:(this.emit("dragdrop:resize",t,this.element,(this.element.parent("[data-mm-id]")||this.element).siblings(":not(.placeholder)"),this.origin.offset.x),!1):o||e.hasClass("submenu-column")&&!i.matches(".submenu-reorder")&&!i.parent(".submenu-reorder")?!0:(this.element.style({"pointer-events":"none",zIndex:100}),this.DRAG_EVENTS.EVENTS.MOVE.forEach(s(function(t){u("body").on(t,this.bound("move"))},this)),this.DRAG_EVENTS.EVENTS.STOP.forEach(s(function(t){u("body").on(t,this.bound("deferStop"))},this)),this.emit("dragdrop:start",t,this.element),this.element)},deferStop:function(t){var e=this;setTimeout(function(){e.stop(t)},0)},stop:function(t){if(t&&t.type.match(/^touch/i)&&t.preventDefault(),clearTimeout(this.scrollInterval),u("html").attribute("style",null),!this.moved&&this.options.catchClick)return this.element.style({transform:this.origin.transform||"translate(0, 0)"}),this.emit("dragdrop:stop",t,this.matched,this.element),this._removeStyleAttribute(this.element),this.emit("dragdrop:stop:animation",this.element),this.emit("dragdrop:click",t,this.element),this.DRAG_EVENTS.EVENTS.MOVE.forEach(s(function(t){u("body").off(t,this.bound("move"))},this)),this.DRAG_EVENTS.EVENTS.STOP.forEach(s(function(t){u("body").off(t,this.bound("deferStop"))},this)),void(this.element=null);var e={duration:"250ms"};return this.removeElement?(this.DRAG_EVENTS.EVENTS.MOVE.forEach(s(function(t){u("body").off(t,this.bound("move"))},this)),this.DRAG_EVENTS.EVENTS.STOP.forEach(s(function(t){u("body").off(t,this.bound("deferStop"))},this)),this.emit("dragdrop:stop:erase",t,this.element)):(this.element&&(this.emit("dragdrop:stop",t,this.matched,this.element),this.matched&&this.element.style({opacity:0,transform:"translate(0, 0)"}).removeClass("active"),this.matched?(this.element.style({transform:this.origin.transform||"translate(0, 0)",opacity:1}),this._removeStyleAttribute(this.element),this.emit("dragdrop:stop:animation",this.element)):(e.callback=s(function(t){this._removeStyleAttribute(t),setTimeout(s(function(){this.emit("dragdrop:stop:animation",t)},this),1)},this,this.element),this.element.animate({transform:this.origin.transform||"translate(0, 0)",opacity:1},e))),this.DRAG_EVENTS.EVENTS.MOVE.forEach(s(function(t){u("body").off(t,this.bound("move"))},this)),this.DRAG_EVENTS.EVENTS.STOP.forEach(s(function(t){u("body").off(t,this.bound("deferStop"))},this)),void(this.element=null))},move:function(t){if(t&&t.type.match(/^touch/i)&&t.preventDefault(),this.options.catchClick){var e={x:t.changedTouches?t.changedTouches[0].pageX:t.pageX,y:t.changedTouches?t.changedTouches[0].pageY:t.pageY};if(Math.abs(e.x-this.origin.x)<=3&&Math.abs(e.y-this.origin.y)<=3)return;this.moved||(this.element.style({opacity:.5}),this.emit("dragdrop:move:once",this.element)),this.moved=!0}var i=t.clientX||t.touches&&t.touches[0].clientX||0,n=t.clientY||t.touches&&t.touches[0].clientY||0,r=document.elementFromPoint(i,n),o="grid"===this.element.data("lm-blocktype"),a=this.scrollHeight,s=document.body.clientHeight,l=window.pageYOffset;if(clearTimeout(this.scrollInterval),r){if(!u(r).matches("#trash")&&!u(r).parent("#trash")){var c,h,d=u("#g5-container #trash");n+50>=s&&a>l+s?this.scrollInterval=setInterval(function(){h=(window.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0),c=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),window.scrollTo(h,Math.min(a,c+4))},8):n-50<=(d?d[0].offsetHeight:0)&&a>0&&(this.scrollInterval=setInterval(function(){h=(window.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0),c=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),window.scrollTo(h,Math.max(0,c-4))},8))}if(o&&(r=document.elementFromPoint(i+30,n)),!r)return!1;this.matched=u(r).matches(this.options.droppables)?r:(u(r).parent(this.options.droppables)||[!1])[0],this.isPlaceHolder=u(r).matches("[data-lm-placeholder]")?!0:u(r).parent("[data-lm-placeholder]")?!0:!1;var p=this.lastX-i,f=this.lastY-n,m=Math.abs(p)>Math.abs(f)&&p>0&&"left"||Math.abs(p)>Math.abs(f)&&0>p&&"right"||Math.abs(f)>Math.abs(p)&&f>0&&"up"||"down";if(p=(t.changedTouches?t.changedTouches[0].pageX:t.pageX)-this.origin.x,f=(t.changedTouches?t.changedTouches[0].pageY:t.pageY)-this.origin.y,this.direction=m,this.element.style({transform:"translate("+p+"px, "+f+"px)"}),!this.isPlaceHolder)if(this.lastMatched&&this.matched!==this.lastMatched&&(this.emit("dragdrop:leave",t,this.lastMatched,this.element),this.lastMatched=!1),this.matched&&this.matched!==this.lastMatched&&r!==this.lastOvered&&(this.emit("dragdrop:enter",t,this.matched,this.element),this.lastMatched=this.matched),this.matched&&this.lastMatched){var g=this.matched.getBoundingClientRect(),v={x:Math.abs(i-g.left)<g.width/2&&"before"||Math.abs(i-g.left)>=g.width-g.width/2&&"after"||"other",y:Math.abs(n-g.top)<g.height/2&&"above"||Math.abs(n-g.top)>=g.height/2&&"below"||"other"};this.emit("dragdrop:location",t,v,this.matched,this.element)}else this.emit("dragdrop:nolocation",t);this.lastOvered=r,this.lastX=i,this.lastY=n,this.emit("dragdrop:move",t,this.element)}},_removeStyleAttribute:function(t){t=u(t||this.element),t.data("mm-id")||t.attribute("style",null)}});e.exports=h},{"../utils/elements.utils":51,"./drag.events":40,"elements/delegation":85,"elements/events":87,"mout/array/contains":142,"mout/function/bind":167,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256}],40:[function(t,e,i){"use strict";var n=function(t){t=t.split(" ");for(var e,i=document.createElement("div"),n=!1,r=t.length-1;r>=0;r--)if(e="on"+t[r],n=e in i,n||(i.setAttribute(e,"return;"),n="function"==typeof i[e]),n){n=t[r];break}return i=null,n},r=function(t){t=t.split(" ");for(var e=!1,i=[],r=t.length-1;r>=0;r--)e=n(t[r]),e&&i.push(e);return i},o={START:n("mousedown touchstart MSPointerDown pointerdown"),MOVE:n("mousemove touchmove MSPointerMove pointermove"),STOP:n("mouseup touchend MSPointerUp pointerup")},a={START:r("mousedown touchstart MSPointerDown pointerdown"),MOVE:r("mousemove touchmove MSPointerMove pointermove"),STOP:r("mouseup touchend MSPointerUp pointerup")};e.exports={EVENT:o,EVENTS:a}},{}],41:[function(t,e,i){"use strict";var n=t("prime"),r=t("../utils/elements.utils"),o=t("prime/emitter"),a=t("prime-util/prime/bound"),s=t("prime-util/prime/options"),l=new n({mixin:[s,a],inherits:o,constructor:function(t,e){this.setOptions(e),this.element=r(t),this.element&&this.hide(!0)},show:function(t){this.element&&(this.out(),this.element[t?"style":"animate"]({top:0},{duration:"150ms"}))},hide:function(t){if(this.element){var e={top:-this.element[0].offsetHeight};this.out(),this.element[t?"style":"animate"](e,{duration:"150ms"})}},over:function(){this.element.find(".trash-zone").animate({transform:"scale(1.2)"},{duration:"150ms",equation:"cubic-bezier(0.5,0,0.5,1)"})},out:function(){this.element.find(".trash-zone").animate({transform:"scale(1)"},{duration:"150ms",equation:"cubic-bezier(0.5,0,0.5,1)"})}});e.exports=l},{"../utils/elements.utils":51,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256
}],42:[function(t,e,i){"use strict";var n=t("./modal"),r=t("./selectize");e.exports={modal:new n,togglers:t("./togglers"),selectize:r,toastr:t("./toastr")}},{"./modal":43,"./selectize":46,"./toastr":47,"./togglers":48}],43:[function(t,e,i){"use strict";var n=t("prime"),r=t("../utils/elements.utils"),o=t("elements/zen"),a=t("prime/map")(),s=t("prime/emitter"),l=t("prime-util/prime/bound"),u=t("prime-util/prime/options"),c=t("elements/domready"),h=t("mout/function/bind"),d=t("mout/array/map"),p=t("mout/array/forEach"),f=t("mout/array/last"),m=t("mout/object/merge"),g=t("agent"),v=!1;c(function(){var t=(document.body||document.documentElement).style;p(["animation","WebkitAnimation","MozAnimation","MsAnimation","OAnimation"],function(e,i){v||(v=void 0!==t[e]?b.prototype.animationEndEvent[i]:!1)})});var b=new n({mixin:[l,u],inherits:s,animationEndEvent:["animationend","webkitAnimationEnd","mozAnimationEnd","MSAnimationEnd","oanimationend"],globalID:1,options:{baseClassNames:{container:"g5-dialog",content:"g5-content",overlay:"g5-overlay",close:"g5-close",closing:"g5-closing",open:"g5-dialog-open"},content:"",remote:"",showCloseButton:!0,escapeToClose:!0,overlayClickToClose:!0,appendNode:"#g5-container",className:"g5-dialog-theme-default",css:{},overlayClassName:"",overlayCSS:"",contentClassName:"",contentCSS:"",closeClassName:"g5-dialog-close",closeCSS:"",afterOpen:null,afterClose:null},constructor:function(t){this.setOptions(t),this.defaults=this.options;var e=this;c(function(){r(window).on("keydown",function(t){return 27===t.keyCode?e.closeByEscape():void 0}),e.animationEndEvent=v}),this.on("dialogOpen",function(t){r("body").addClass(t.baseClassNames.open),r("html").addClass(t.baseClassNames.open)}).on("dialogAfterClose",h(function(t){var e=this.getAll();e&&e.length||(r("body").removeClass(t.baseClassNames.open),r("html").removeClass(t.baseClassNames.open))},this))},storage:function(){return a},open:function(t){t=m(this.options,t),t.id=this.globalID++;var e={};if(e.container=o("div").addClass(t.baseClassNames.container).addClass(t.className).style(t.css),a.set(e.container,{dialog:t}),e.overlay=o("div").addClass(t.baseClassNames.overlay).addClass(t.overlayClassName).style(t.overlayCSS),a.set(e.overlay,{dialog:t}),t.overlayClickToClose&&(e.container.on("click",h(this._overlayClick,this,e.container[0])),e.overlay.on("click",h(this._overlayClick,this,e.overlay[0]))),e.container.appendChild(e.overlay),e.content=o("div").addClass(t.baseClassNames.content).addClass(t.contentClassName).style(t.contentCSS).html(t.content),a.set(e.content,{dialog:t}),e.container.appendChild(e.content),t.overlayClickToClose&&e.content.on("click",function(){return!0}),t.remote&&t.remote.length>1){this.showLoading(),t.method=t.method||"get";var i=g();i.method(t.method),i.url(t.remote),t.data&&i.data(t.data),i.send(h(function(i,n){e.content.html(n.body.html||n.body),n.body.success||n.body.html||e.content.style({width:"90%"}),this.hideLoading(),t.remoteLoaded&&t.remoteLoaded(n,t);var o=r("[data-selectize]");o&&o.selectize()},this))}return t.showCloseButton&&(e.closeButton=o("div").addClass(t.baseClassNames.close).addClass(t.closeClassName).style(t.closeCSS),a.set(e.closeButton,{dialog:t}),e.content.appendChild(e.closeButton)),e.container.delegate("click",".g5-dialog-close",h(function(t){t.preventDefault(),this._closeButtonClick(e.container)},this)),r(t.appendNode).appendChild(e.container),t.elements=e,t.afterOpen&&t.afterOpen(e.content,t),setTimeout(h(function(){return this.emit("dialogOpen",t)},this),0),e.content},getAll:function(){var t=this.options;return r("."+t.baseClassNames.container+":not(."+t.baseClassNames.closing+") ."+t.baseClassNames.content)},getByID:function(t){var e=this.getAll();return e?r(e.filter(function(e){return e=r(e),a.get(e).dialog.id===t})):[]},close:function(t){if(!t){var e=r(f(this.getAll()));if(!e)return!1;t=a.get(e).dialog.id}return this.closeByID(t)},closeAll:function(){var t;return t=d(this.getAll(),function(t){return t=r(t),a.get(t).dialog.id}),t.length?(p(t.reverse(),function(t){return this.closeByID(t)},this),!0):!1},closeByID:function(t){var e=this.getByID(t);if(!e||!e.length)return!1;var i,n;i=a.get(e).dialog.elements.container,n=m({},a.get(e).dialog);var r=function(){return n.beforeClose?n.beforeClose(e,n):void 0},o=h(function(){return e.emit("dialogClose",n),i.remove(),this.emit("dialogAfterClose",n),n.afterClose?n.afterClose(e,n):void 0},this);return v?(r(),i.off(this.animationEndEvent).on(this.animationEndEvent,function(){return o()}).addClass(n.baseClassNames.closing)):(r(),o()),!0},closeByEscape:function(){var t,e;if(t=d(this.getAll(),function(t){return t=r(t),a.get(t).dialog.id}),!t.length)return!1;e=Math.max.apply(Math,t);var i=this.getByID(e);return a.get(i).dialog.escapeToClose?this.closeByID(e):!1},showLoading:function(){return this.hideLoading(),r("body").appendChild(o("div.g5-dialog-loading-spinner."+this.options.className))},hideLoading:function(){var t=r(".g5-dialog-loading-spinner");return t?t.remove():!1},_overlayClick:function(t,e){return e.target===t?this.close(a.get(r(t)).dialog.id):void 0},_closeButtonClick:function(t){return this.close(a.get(r(t)).dialog.id)}});e.exports=b},{"../utils/elements.utils":51,agent:61,"elements/domready":86,"elements/zen":112,"mout/array/forEach":150,"mout/array/last":155,"mout/array/map":156,"mout/function/bind":167,"mout/object/merge":208,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256,"prime/map":258}],44:[function(t,e,i){"use strict";var n=t("prime"),r=t("../utils/elements.utils"),o=t("elements/zen"),a=t("prime/map")(),s=t("prime/emitter"),l=t("prime-util/prime/bound"),u=t("prime-util/prime/options"),c=(t("elements/domready"),t("mout/function/bind")),h=(t("mout/array/map"),t("mout/array/forEach"),t("mout/array/last"),t("mout/object/merge"),t("mout/lang/isFunction")),d=t("agent"),p=new n({mixin:[l,u],inherits:s,options:{mainClass:"g5-popover",placement:"auto",width:"auto",height:"auto",trigger:"click",style:"",delay:300,cache:!0,multi:!1,arrow:!0,title:"",content:"",closeable:!1,padding:!0,targetEvents:!0,allowElementsClick:!1,url:"",type:"html",where:"#g5-container",template:'<div class="g5-popover"><div class="arrow"></div><div class="g5-popover-inner"><a href="#" class="close">x</a><h3 class="g5-popover-title"></h3><div class="g5-popover-content"><i class="icon-refresh"></i> <p>&nbsp;</p></div></div></div>'},constructor:function(t,e){this.setOptions(e),this.element=r(t),"click"===this.options.trigger?this.element.off("click",this.bound("toggle")).on("click",this.bound("toggle")):this.element.off("mouseenter",this.bound("mouseenterHandler")).off("mouseleave",this.bound("mouseleaveHandler")).on("mouseenter",this.bound("mouseenterHandler")).on("mouseleave",this.bound("mouseleaveHandler")),this._poped=!1},destroy:function(){this.hide(),a.set(this.element[0],null),this.element.off("click",this.bound("toggle")).off("mouseenter",this.bound("mouseenterHandler")).off("mouseleave",this.bound("mouseleaveHandler")),this.$target&&this.$target.remove()},hide:function(t){t&&(t.preventDefault(),t.stopPropagation()),this.element.emit("hide.popover",this),this.$target&&(this.$target.removeClass("in").style({display:"none"}),this.$target.remove()),this.element.emit("hidden.popover",this)},toggle:function(t){t&&(t.preventDefault(),t.stopPropagation()),this[this.getTarget().hasClass("in")?"hide":"show"]()},hideAll:function(t){var e="";e=t?"div."+this.options.mainClass:"div."+this.options.mainClass+":not(."+this.options.mainClass+"-fixed)";var i=r(e);return i?(i.removeClass("in").style({display:"none"}),this):this},show:function(){var t=this.getTarget().attribute("class",null).addClass(this.options.mainClass);if(this.options.multi||this.hideAll(),this.element.emit("beforeshow.popover",this),!this.options.cache||!this._poped){if(this.setTitle(this.getTitle()),this.options.closeable||t.find(".close").off("click").remove(),this.isAsync())return this.setContentASync(this.options.content),void this.displayContent();this.setContent(this.getContent()),t.style({display:"block"})}this.displayContent(),this.bindBodyEvents()},displayContent:function(){var t,e,i,n=this.element.position(),r=this.getTarget().attribute("class",null).addClass(this.options.mainClass),o=this.getContentElement();this.element.emit("show.popover",this),"auto"!==this.options.width&&r.style({width:this.options.width}),"auto"!==this.options.height&&o.style({height:this.options.height}),!this.options.arrow&&r.find(".arrow")&&r.find(".arrow").remove(),r.remove().style({top:-1e3,left:-1e3,display:"block"}).bottom(this.options.where),t=r[0].offsetWidth,e=r[0].offsetHeight,i=this.getPlacement(n,e),this.options.targetEvents&&this.initTargetEvents();var a=this.getTargetPositin(n,i,t,e);if(this.$target.style(a.position).addClass(i).addClass("in"),"iframe"===this.options.type){var s=r.find("iframe");s.style({width:r.position().width,height:s.parent().position.height})}if(this.options.style&&("string"==typeof this.options.style&&(this.options.style=this.options.style.split(",").map(Function.prototype.call,String.prototype.trim)),this.options.style.forEach(function(t){this.$target.addClass(this.options.mainClass+"-"+t)},this)),this.options.padding||(o.css("height",o.position().height),this.$target.addClass("g5-popover-no-padding")),this.options.arrow||this.$target.style({margin:0}),this.options.arrow){var l=this.$target.find(".arrow");l.attribute("style",null),a.arrowOffset&&l.style(a.arrowOffset)}this._poped=!0,this.element.emit("shown.popover",this)},getTarget:function(){return this.$target||(this.$target=r(o("div").html(this.options.template).children()[0])),this.$target},getTitleElement:function(){return this.getTarget().find("."+this.options.mainClass+"-title")},getContentElement:function(){return this.getTarget().find("."+this.options.mainClass+"-content")},getTitle:function(){return this.options.title||this.element.data("g5-popover-title")||this.element.attribute("title")},setTitle:function(t){var e=this.getTitleElement();t?e.html(t):e.remove()},hasContent:function(){return this.getContent()},getContent:function(){if(this.options.url)"iframe"===this.options.type&&(this.content=r('<iframe frameborder="0"></iframe>').attribute("src",this.options.url));else if(!this.content){var t="";t=h(this.options.content)?this.options.content.apply(this.element[0],arguments):this.options.content,this.content=this.element.data("g5-popover-content")||t}return this.content},setContent:function(t){var e=this.getTarget();this.getContentElement().html(t),this.$target=e},isAsync:function(){return"async"===this.options.type},setContentASync:function(t){d("get",this.options.url,c(function(e,i){this.content=t&&h(t)?t.apply(this.element[0],[i]):i.body.html,this.setContent(this.content);var n=this.getContentElement();n.attribute("style",null),this.displayContent(),this.bindBodyEvents();var o=r("[data-selectize]");o&&o.selectize()},this))},bindBodyEvents:function(){var t=r("body");t.off("keyup",this.bound("escapeHandler")).on("keyup",this.bound("escapeHandler")),t.off("click",this.bound("bodyClickHandler")).on("click",this.bound("bodyClickHandler"))},mouseenterHandler:function(){this._timeout&&clearTimeout(this._timeout),this.getTarget()[0].offsetWidth>0||this.getTarget()[0].offsetHeight>0||this.show()},mouseleaveHandler:function(){this._timeout=setTimeout(c(function(){this.hide()},this),this.options.delay)},escapeHandler:function(t){27===t.keyCode&&this.hideAll()},bodyClickHandler:function(){this.hideAll()},targetClickHandler:function(t){var e=r(t.target);e.matches(this.options.allowElementsClick)&&t.preventDefault(),e.parent("[data-g-popover-follow]")||null!==e.data("g-popover-follow")||t.stopPropagation()},initTargetEvents:function(){"click"!==this.options.trigger&&this.$target.off("mouseenter",this.bound("mouseenter")).off("mouseleave",this.bound("mouseleave")).on("mouseenter",this.bound("mouseenterHandler")).on("mouseleave",this.bound("mouseleaveHandler"));var t=this.$target.find(".close");t&&t.off("click",this.bound("hide")).on("click",this.bound("hide")),this.$target.off("click",this.bound("targetClickHandler")).on("click",this.bound("targetClickHandler"))},getPlacement:function(t,e){var i,n=document.documentElement,r=document.body,o=n.clientWidth,a=n.clientHeight,s=Math.max(r.scrollTop,n.scrollTop),l=Math.max(r.scrollLeft,n.scrollLeft),u=Math.max(0,t.left-l),c=Math.max(0,t.top-s),h=20;return i="function"==typeof this.options.placement?this.options.placement.call(this,this.getTarget()[0],this.element[0]):this.element.data("g5-popover-placement")||this.options.placement,"auto"===i&&(o/3>u?i=a/3>c?"bottom-right":2*a/3>c?"right":"top-right":2*o/3>u?i=a/3>c?"bottom":2*a/3>c?"bottom":"top":(i=c>e+h?"top-left":"bottom-left",i=a/3>c?"bottom-left":2*a/3>c?"left":"top-left")),i},getTargetPositin:function(t,e,i,n){var r=t,o=this.element.position().width,a=this.element.position().height,s={},l=null,u=this.options.arrow?28:0,c=u+10>o?u:0,h=u+10>a?u:0;switch(e){case"bottom":s={top:r.top+r.height,left:r.left+r.width/2-i/2};break;case"top":s={top:r.top-n,left:r.left+r.width/2-i/2};break;case"left":s={top:r.top+r.height/2-n/2,left:r.left-i};break;case"right":s={top:r.top+r.height/2-n/2,left:r.left+r.width};break;case"top-right":s={top:r.top-n,left:r.left-c},l={left:o/2+c};break;case"top-left":s={top:r.top-n,left:r.left-i+r.width+c},l={left:i-o/2-c};break;case"bottom-right":s={top:r.top+r.height,left:r.left-c},l={left:o/2+c};break;case"bottom-left":s={top:r.top+r.height,left:r.left-i+r.width+c},l={left:i-o/2-c};break;case"right-top":s={top:r.top-n+r.height+h,left:r.left+r.width},l={top:n-a/2-h};break;case"right-bottom":s={top:r.top-h,left:r.left+r.width},l={top:a/2+h};break;case"left-top":s={top:r.top-n+r.height+h,left:r.left-i},l={top:n-a/2-h};break;case"left-bottom":s={top:r.top,left:r.left-i},l={top:a/2}}return{position:s,arrowOffset:l}}});r.implement({getPopover:function(t){var e=a.get(this);return e||"destroy"===t||(t=t||{},e=new p(this,t),a.set(this,e),this.PopoverDefined=!0),e},popover:function(t){return this.forEach(function(e){var i=a.get(e);i||"destroy"===t||(t=t||{},i=new p(e,t),a.set(e,i))})},position:function(){var t=this[0],e={left:0,right:0,top:0,bottom:0},i=window,n=t.ownerDocument,r=n.documentElement,o=n.body;"undefined"!=typeof t.getBoundingClientRect&&(e=t.getBoundingClientRect());var a=r.clientTop||o.clientTop||0,s=r.clientLeft||o.clientLeft||0,l=i.pageYOffset||r.scrollTop,u=i.pageXOffset||r.scrollLeft,c=u-s,h=l-a;return{x:e.left+c,left:e.left+c,y:e.top+h,top:e.top+h,right:e.right+c,bottom:e.bottom+h,width:e.right-e.left,height:e.bottom-e.top}}}),e.exports=r},{"../utils/elements.utils":51,agent:61,"elements/domready":86,"elements/zen":112,"mout/array/forEach":150,"mout/array/last":155,"mout/array/map":156,"mout/function/bind":167,"mout/lang/isFunction":179,"mout/object/merge":208,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256,"prime/map":258}],45:[function(t,e,i){"use strict";var n=t("elements"),r=t("prime"),o=t("prime/emitter"),a=t("prime-util/prime/bound"),s=t("prime-util/prime/options"),l=t("elements/zen"),u=t("moofx"),c=t("mout/function/bind"),h=t("mout/lang/isArray"),d=t("mout/lang/isNumber"),p=new r({mixin:[a,s],inherits:o,options:{value:0,size:50,startAngle:-Math.PI/2,thickness:"auto",fill:{gradient:["#9e38eb","#4e68fc"]},emptyFill:"rgba(0, 0, 0, .1)",animation:{duration:1200,equation:"cubic-bezier(0.645, 0.045, 0.355, 1)"},animationStartValue:0,reverse:!1,lineCap:"butt",insertElement:null,insertLocation:"before"},constructor:function(t,e){this.setOptions(e),this.element=this.element||n(t),this.canvas=this.canvas||l("canvas")[this.options.insertLocation||"before"](this.options.insertElement||this.element)[0],this.radius=this.options.size/2,this.arcFill=null,this.lastFrameValue=0,this.canvas.width=this.options.size,this.canvas.height=this.options.size,this.ctx=this.canvas.getContext("2d"),this.initFill(),this.draw()},initFill:function(){var t=this.options.fill,e=this.options.size,i=this.ctx;if(!t)throw Error("The fill is not specified.");if(t.color&&(this.arcFill=t.color),t.gradient){var n=t.gradient;if(1==n.length)this.arcFill=n[0];else{for(var r=t.gradientAngle||0,o=t.gradientDirection||[e/2*(1-Math.cos(r)),e/2*(1+Math.sin(r)),e/2*(1+Math.cos(r)),e/2*(1-Math.sin(r))],a=i.createLinearGradient.apply(i,o),s=0;s<n.length;s++){var l=n[s],u=s/(n.length-1);h(l)&&(u=l[1],l=l[0]),a.addColorStop(u,l)}this.arcFill=a}}},draw:function(){this[this.options.animation?"drawAnimated":"drawFrame"](this.options.value)},drawFrame:function(t){this.lastFrameValue=t,this.ctx.clearRect(0,0,this.options.size,this.options.size),this.drawEmptyArc(t),this.drawArc(t)},drawArc:function(t){var e=this.ctx,i=this.radius,n=this.getThickness(),r=this.options.startAngle;e.save(),e.beginPath(),this.options.reverse?e.arc(i,i,i-n/2,r-2*Math.PI*t,r):e.arc(i,i,i-n/2,r,r+2*Math.PI*t),e.lineWidth=n,e.lineCap=this.options.lineCap,e.strokeStyle=this.arcFill,e.stroke(),e.restore()},drawEmptyArc:function(t){var e=this.ctx,i=this.radius,n=this.getThickness(),r=this.options.startAngle;1>t&&(e.save(),e.beginPath(),0>=t?e.arc(i,i,i-n/2,0,2*Math.PI):this.reverse?e.arc(i,i,i-n/2,r,r-2*Math.PI*t):e.arc(i,i,i-n/2,r+2*Math.PI*t,r),e.lineWidth=n,e.strokeStyle=this.options.emptyFill,e.stroke(),e.restore())},drawAnimated:function(t){this.element.emit("progress-animation-start"),u(c(function(e){var i=this.options.animationStartValue*(1-e)+t*e;this.drawFrame(i),this.element.emit("progress-animation-change",e,i)},this),{duration:this.options.animation.duration||"1200",equation:this.options.animation.equation||"linear",callback:c(function(){this.options.animation.callback&&this.options.animation.callback(),this.element.emit("progress-animation-end")},this)}).start(0,1)},getThickness:function(){return d(this.options.thickness)?this.options.thickness:this.options.size/14}});e.exports=p},{elements:88,"elements/zen":112,moofx:113,"mout/function/bind":167,"mout/lang/isArray":177,"mout/lang/isNumber":181,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256}],46:[function(t,e,i){"use strict";var n=t("prime"),r=t("elements/domready"),o=t("elements/zen"),a=t("sifter"),s=t("prime/emitter"),l=t("prime-util/prime/bound"),u=t("prime-util/prime/options"),c=t("../utils/elements.utils"),h=(t("moofx"),t("mout/function/bind")),d=t("mout/collection/forEach"),p=t("mout/array/indexOf"),f=t("mout/array/last"),m=t("mout/function/debounce"),g=t("mout/lang/isArray"),v=t("mout/lang/isBoolean"),b=t("mout/object/merge"),y=(t("mout/object/unset"),t("mout/object/size")),w=(t("mout/object/values"),t("mout/string/escapeHtml")),k=t("mout/string/trim"),x=/Mac/.test(navigator.userAgent),S=65,C=13,E=27,T=37,O=38,I=80,A=39,z=40,_=78,D=8,N=46,F=16,j=x?91:17,L=x?18:17,M=9,P=1,R=2,B=function(t){return"undefined"==typeof t||null===t?null:"boolean"==typeof t?t?"1":"0":t+""},$=function(t){return"undefined"!=typeof t},H=function(t){return(t+"").replace(/\$/g,"$$$$")},q=function(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}},U=function(t,e,i){var n,r=t.emit,o={};t.emit=function(){var i=arguments[0];return-1===e.indexOf(i)?r.apply(t,arguments):void(o[i]=arguments)},i.apply(t,[]),t.emit=r;for(n in o)o.hasOwnProperty(n)&&r.apply(t,o[n])},V=function(t,e){if(!g(e))return e;var i,n,r={};for(i=0,n=e.length;n>i;i++)e[i].hasOwnProperty(t)&&(r[e[i][t]]=e[i]);return r},W=function(t){var e={};if("selectionStart"in t)e.start=t.selectionStart,e.length=t.selectionEnd-e.start;else if(document.selection){t.focus();var i=document.selection.createRange(),n=document.selection.createRange().text.length;i.moveStart("character",-t.value.length),e.start=i.text.length-n,e.length=n}return e},X=function(t,e,i){var n,r,o={};if(i)for(n=0,r=i.length;r>n;n++)o[i[n]]=t.compute(i[n]);else o=t.compute();e.style(o)},Y=function(t,e){if(!t)return 0;var i=o("test").style({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(t).bottom("body");X(e,i,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var n=i[0].offsetWidth;return i.remove(),n},G=function(t,e){if("string"!=typeof e||e.length){var i="string"==typeof e?new RegExp(e,"i"):e,n=function(t){var e=0;if(3===t.nodeType){var r=t.data.search(i);if(r>=0&&t.data.length>0){var o=t.data.match(i),a=document.createElement("span");a.className="highlight";var s=t.splitText(r),l=(s.splitText(o[0].length),s.cloneNode(!0));a.appendChild(l),s.parentNode.replaceChild(a,s),e=1}}else if(1===t.nodeType&&t.childNodes&&!/(script|style)/i.test(t.tagName))for(var u=0;u<t.childNodes.length;++u)u+=n(t.childNodes[u]);return e};return d(t,function(t){n(t)})}},J=function(t){t=c(t);var e=null,i=function(i,n){var r,o,a,s,l,u,c,h;n=n||window.event||{},i=i||{},n.metaKey||n.altKey||(i.force||t.selectizeGrow!==!1)&&(r=t.value(),n.type&&"keydown"===n.type.toLowerCase()&&(o=n.keyCode,a=o>=97&&122>=o||o>=65&&90>=o||o>=48&&57>=o||32===o,o===N||o===D?(h=W(t[0]),h.length?r=r.substring(0,h.start)+r.substring(h.start+h.length):o===D&&h.start?r=r.substring(0,h.start-1)+r.substring(h.start+1):o===N&&"undefined"!=typeof h.start&&(r=r.substring(0,h.start)+r.substring(h.start+1))):a&&(u=n.shiftKey,c=String.fromCharCode(n.keyCode),c=u?c.toUpperCase():c.toLowerCase(),r+=c)),s=t.attribute("placeholder"),!r&&s&&(r=s),l=Y(r,t)+4,l!==e&&(e=l,t.style({width:l}),t.emit("resize")))};t.on("keydown",i),t.on("keyup",i),t.on("update",i),t.on("blur",i),i()},K=new n({mixin:[l,u],inherits:s,options:{plugins:[],delimiter:" ",persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,scrollDuration:60,loadThrottle:300,dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",optgroupOrder:null,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},constructor:function(t,e){t=c(t),this.setOptions(e),this.input=t,this.input.selectizeInstance=this,this.tagType="select"==t.tag()?P:R,this.highlightedValue=null,this.isRequired=t.attribute("required"),d(["isOpen","isDisabled","isInvalid","isLocked","isFocused","isInputHidden","isSeup","isShiftDown","isCmdDown","isCtrlDown","ignoreFocus","ignoreBlur","ignoreHover","hasOptions"],function(t){this[t]=!1},this),this.currentResults=null,this.lastValue="",this.caretPos=0,this.loading=0,this.loadedSearches={},this.$activeOption=null,this.$activeItems=[],this.Optgroups={},this.Options={},this.UserOptions={},this.items=[],this.renderCache={},this.onSearchChange=null===this.options.loadThrottle?this.onSearchChange:m(this.onSearchChange,this.options.loadThrottle),this.Options=b(this.Options,V(this.options.valueField,this.options.Options)),this.Optgroups=b(this.Optgroups,V(this.options.optgroupValueField,this.options.Optgroups)),delete this.options.Options,delete this.options.Optgroups,this.sifter=new a(this.Options,{diacritics:this.options.diacritics}),this.options.mode=this.options.mode||(1===this.options.maxItems?"single":"multi"),v(this.options.hideSelected)||(this.options.hideSelected="multi"===this.options.mode),this.setupCallbacks(),this.setupTemplates(),this.setup()},setup:function(){var t,e,i,n,r,a,s,l,u,p=this.input;s=this.options.mode,l=p.attribute("tabindex")||"",u=p.attribute("class")||"",t=o("div").addClass(this.options.wrapperClass).addClass(u).addClass(s).after(this.input),e=o("div").addClass(this.options.inputClass).addClass("items").bottom(t),i=o('input[type="text"][autocomplete="off"]').bottom(e).attribute("tabindex",l),a=c(this.options.dropdownParent||t),n=o("div").addClass(this.options.dropdownClass).addClass(s).style({display:"none"}).bottom(a),r=o("div").addClass(this.options.dropdownContentClass).bottom(n),this.options.copyClassesToDropdown&&d(u.split(" "),function(t){n.addClass(t)}),"single"==s&&t.style({width:parseInt(p.compute("width"))+12+24}),(null===this.options.maxItems||this.options.maxItems>1)&&this.tagType===P&&p.attribute("multiple","multiple"),this.options.placeholder&&i.attribute("placeholder",this.options.placeholder),p.attribute("autocorrect")&&i.attribute("autocorrect",p.attribute("autocorrect")),p.attribute("autocapitalize")&&i.attribute("autocapitalize",p.attribute("autocapitalize")),this.$wrapper=t,this.$control=e,this.$control_input=i,this.$dropdown=n,this.$dropdown_content=r,n.delegate("mouseover","[data-selectable]",h(function(){return this.onOptionHover.apply(this,arguments)},this)),n.delegate("mousedown","[data-selectable]",h(function(){return this.onOptionSelect.apply(this,arguments)},this)),J(i),e.delegate("mousedown","*:not(input)",h(function(t,i){return i==e?!0:void this.onItemSelect(t,i)},this)),e.on("mousedown",h(function(){return this.onMouseDown.apply(this,arguments)},this)),e.on("click",h(function(){return this.onClick.apply(this,arguments)},this)),i.on("mousedown",function(t){t.stopPropagation()}),i.on("keydown",h(function(){return this.onKeyDown.apply(this,arguments)},this)),i.on("keyup",h(function(){return this.onKeyUp.apply(this,arguments)},this)),i.on("keypress",h(function(){return this.onKeyPress.apply(this,arguments)},this)),i.on("resize",h(function(){this.positionDropdown.apply(this,[])},this)),i.on("blur",h(function(){return this.onBlur.apply(this,arguments)},this)),i.on("focus",h(function(){return this.ignoreBlur=!1,this.onFocus(arguments)},this)),i.on("paste",h(function(){return this.onPaste.apply(this,arguments)},this)),c(document).on("keydown",h(function(t){this.isCmdDown=t[x?"metaKey":"ctrlKey"],this.isCtrlDown=t[x?"altKey":"ctrlKey"],this.isShiftDown=t.shiftKey},this)),c(document).on("keyup",h(function(t){t.keyCode===L&&(this.isCtrlDown=!1),t.keyCode===F&&(this.isShiftDown=!1),t.keyCode===j&&(this.isCmdDown=!1)},this)),c(document).on("mousedown",h(function(t){if(this.isFocused){if(t.target===this.$dropdown[0]||t.target.parentNode===this.$dropdown[0])return!1;this.$control.find(c(t.target))||t.target===this.$control[0]||this.blur()}},this)),c(window).on("scroll",h(function(){this.isOpen&&this.positionDropdown.apply(this,arguments)},this)),c(window).on("resize",h(function(){this.isOpen&&this.positionDropdown.apply(this,arguments)},this)),c(window).on("mousemove",h(function(){this.ignoreHover=!1},this)),this.revertSettings={$children:this.input.children(),tabindex:this.input.attribute("tabindex")},this.input.attribute("tabindex",-1).style({display:"none"}).after(t),g(this.options.items)&&(this.setValue(this.options.items),delete this.options.items),this.input[0].validity&&this.input.on("invalid",h(function(t){t.preventDefault(),this.isInvalid=!0,this.refreshState()},this)),this.updateOriginalInput(),this.refreshItems(),this.refreshState(),this.updatePlaceholder(),this.isSetup=!0,this.input.matches(":disabled")&&this.disable(),this.on("change",this.onChange),this.input.selectizeInstance=this,this.input.addClass("selectized"),this.emit("initialize"),this.options.preload===!0&&this.onSearchChange("")},setupTemplates:function(){var t=this.options.labelField,e=this.options.optgroupLabelField,i={optgroup:function(t){return'<div class="optgroup">'+t.html+"</div>"},optgroup_header:function(t,i){return'<div class="optgroup-header">'+i(t[e])+"</div>"},option:function(e,i){return'<div class="option">'+i(e[t])+"</div>"},item:function(e,i){return'<div class="item">'+i(e[t])+"</div>"},option_create:function(t,e){return'<div class="create">Add <strong>'+e(t.input)+"</strong>&hellip;</div>"}};this.options.render=b({},i,this.options.render)},setupCallbacks:function(){var t={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad"};d(t,function(e,i){var n=this.options[t[i]];n&&this.on(i,n)},this)},updateOriginalInput:function(){var t;if(this.tagType===P){t=[];for(var e=0,i=this.items.length;i>e;e++)t.push('<option value="'+w(this.items[e])+'" selected="selected"></option>');t.length||this.input.attribute("multiple")||t.push('<option value="" selected="selected"></option>'),this.input.html(t.join(""))}else this.input.value(this.getValue()),this.input.attribute("value",this.input.value());this.isSetup&&this.emit("change",this.input.value())},getAdjacentOption:function(t,e){var i=this.$dropdown.search("[data-selectable]"),n=p(i,t?t[0]:null)+e;return n>=0&&n<(i?i.length:0)?c(i[n]):c()},getOption:function(t){return this.getElementWithValue(t,this.$dropdown_content.search("[data-selectable]"))},getElementWithValue:function(t,e){if(t=B(t),"undefined"!=typeof t&&null!==t)for(var i=0,n=e?e.length:0;n>i;i++)if(e[i].getAttribute("data-value")===t)return c(e[i]);return c()},getItem:function(t){return this.getElementWithValue(t,this.$control.children())},addItems:function(t){for(var e=g(t)?t:[t],i=0,n=e.length;n>i;i++)this.isPending=n-1>i,this.addItem(e[i])},addItem:function(t){U(this,["change"],function(){var e,i,n,r,a,s=this.options.mode;if(t=B(t),-1!==this.items.indexOf(t))return void("single"===s&&this.isOpen&&this.close());if(this.Options.hasOwnProperty(t)&&("single"===s&&this.clear(),"multi"!==s||!this.isFull()&&t)){var l=o("div").html(this.render("item",this.Options[t]));if(e=l.firstChild(),a=this.isFull(),this.items.splice(this.caretPos,0,t),this.insertAtCaret(e),(!this.isPending||!a&&this.isFull())&&this.refreshState(),this.isSetup){if(n=this.$dropdown_content.search("[data-selectable]"),!this.isPending){i=this.getOption(t);var u=this.getAdjacentOption(i,1);r=u?u.attribute("data-value"):null,this.refreshOptions(this.isFocused&&"single"!==s),r&&this.setActiveOption(this.getOption(r))}!n||this.isFull()?this.close():this.positionDropdown(),this.updatePlaceholder(),this.emit("item_add",t,e),this.updateOriginalInput()}}})},removeItem:function(t){var e,i,n;e="object"==typeof t?t:this.getItem(t),t=B(e.attribute("data-value")),i=this.items.indexOf(t),-1!==i&&(e.remove(),e.hasClass("active")&&(n=this.$activeItems.indexOf(e[0]),this.$activeItems.splice(n,1)),this.items.splice(i,1),this.lastQuery=null,!this.options.persist&&this.UserOptions.hasOwnProperty(t)&&this.removeOption(t),i<this.caretPos&&this.setCaret(this.caretPos-1),this.refreshState(),this.updatePlaceholder(),this.updateOriginalInput(),this.positionDropdown(),this.emit("item_remove",t))},createItem:function(t){var e=k(this.$control_input.value()||""),i=this.caretPos;if(!this.canCreate(e))return!1;this.lock(),"undefined"==typeof t&&(t=!0);var n="function"==typeof this.options.create?this.options.create:h(function(t){var e={};return e[this.options.labelField]=t,e[this.options.valueField]=t,e},this),r=q(h(function(e){if(this.unlock(),e&&"object"==typeof e){var n=B(e[this.options.valueField]);"string"==typeof n&&(this.setTextboxValue(""),this.addOption(e),this.setCaret(i),this.addItem(n),this.refreshOptions(t&&"single"!==this.options.mode))}},this)),o=n.apply(this,[e,r]);return"undefined"!=typeof o&&r(o),!0},refreshItems:function(){if(this.lastQuery=null,this.isSetup)for(var t=0;t<this.items.length;t++)this.addItem(this.items);this.refreshState(),this.updateOriginalInput()},refreshState:function(){var t;this.isRequired&&(this.items.length&&(this.isInvalid=!1),this.$control_input.attribute("required",t)),this.refreshClasses()},refreshClasses:function(){var t=this.isFull(),e=this.isLocked;this.$control.toggleClass("focus",this.isFocused),this.$control.toggleClass("disabled",this.isDisabled),this.$control.toggleClass("required",this.isRequired),this.$control.toggleClass("invalid",this.isInvalid),this.$control.toggleClass("locked",e),this.$control.toggleClass("full",t),this.$control.toggleClass("not-full",!t),
this.$control.toggleClass("input-active",this.isFocused&&!this.isInputHidden),this.$control.toggleClass("dropdown-active",this.isOpen),this.$control.toggleClass("has-options",!y(this.options.Options)),this.$control.toggleClass("has-items",this.items.length>0),this.$control_input.selectizeGrow=!t&&!e},isFull:function(){return null!==this.options.maxItems&&this.items.length>=this.options.maxItems},updatePlaceholder:function(){if(this.options.placeholder){var t=this.$control_input;this.items.length?t.attribute("placeholder",null):t.attribute("placeholder",this.options.placeholder),t.emit("update",{force:!0})}},open:function(){this.isLocked||this.isOpen||"multi"===this.options.mode&&this.isFull()||(this.focus(),this.isOpen=!0,this.refreshState(),this.$dropdown.style({visibility:"hidden",display:"block"}),this.positionDropdown(),this.$dropdown.style({visibility:"visible"}),this.emit("dropdown_open",this.$dropdown))},close:function(){var t=this.isOpen;"single"===this.options.mode&&this.items.length&&this.hideInput(),this.isOpen=!1,this.$dropdown.style({display:"none"}),this.setActiveOption(null),this.refreshState(),"single"!==this.options.mode||this.getValue()||(this.lastQuery=null,this.setTextboxValue(""),this.addItem(this.Options[Object.keys(this.Options)[0]][this.options.valueField])),t&&this.emit("dropdown_close",this.$dropdown)},positionDropdown:function(){var t=this.$control,e=t.position();e.top+=t[0].offsetHeight,this.$dropdown.style({width:t[0].offsetWidth,top:t[0].offsetTop+t[0].offsetHeight,left:t[0].offsetLeft})},clear:function(){var t=this.$control.children(":not(input)");this.items.length&&(t&&t.remove(),this.items=[],this.lastQuery=null,this.setCaret(0),this.setActiveItem(null),this.updatePlaceholder(),this.updateOriginalInput(),this.refreshState(),this.showInput(),this.emit("clear"))},onClick:function(t){this.isFocused||(this.focus(),t.preventDefault())},onMouseDown:function(t){{var e=t.defaultPrevented;c(t.target)}if(this.isFocused){if(t.target!==this.$control_input[0])return"single"===this.options.mode?this.isOpen?this.close():this.open():e||this.setActiveItem(null),t.preventDefault(),t.stopPropagation(),!1}else e||window.setTimeout(h(function(){this.focus()},this),0)},onChange:function(){this.input.emit("change",this.input.value(),this),c("body").emit("change",{target:this.input})},onPaste:function(t){(this.isFull()||this.isInputHidden||this.isLocked)&&t.preventDefault()},onKeyPress:function(t){if(this.isLocked)return t&&t.preventDefault();var e=String.fromCharCode(t.keyCode||t.which);return this.options.create&&e===this.options.delimiter?(this.createItem(),t.preventDefault(),!1):void 0},onKeyDown:function(t){t.target===this.$control_input[0];if(this.isLocked)return void(t.keyCode!==M&&t.preventDefault());switch(t.keyCode){case S:if(this.isCmdDown)return void this.selectAll();break;case E:return this.close(),this.blur(),t.preventDefault(),t.stopPropagation(),!1;case _:if(!t.ctrlKey||t.altKey)break;case z:if(!this.isOpen&&this.hasOptions)this.open();else if(this.$activeOption){this.ignoreHover=!0;var e=this.getAdjacentOption(this.$activeOption,1);e&&this.setActiveOption(e,!0,!0)}return void t.preventDefault();case I:if(!t.ctrlKey||t.altKey)break;case O:if(this.$activeOption){this.ignoreHover=!0;var i=this.getAdjacentOption(this.$activeOption,-1);i&&this.setActiveOption(i,!0,!0)}return void t.preventDefault();case C:return this.isOpen&&this.$activeOption&&this.onOptionSelect({currentTarget:this.$activeOption}),void t.preventDefault();case T:return void this.advanceSelection(-1,t);case A:return void this.advanceSelection(1,t);case M:return this.options.selectOnTab&&this.isOpen&&this.$activeOption&&(this.onOptionSelect({currentTarget:this.$activeOption}),t.preventDefault()),void(this.options.create&&this.createItem()&&t.preventDefault());case D:case N:return void this.deleteSelection(t)}return!this.isFull()&&!this.isInputHidden||(x?t.metaKey:t.ctrlKey)?void 0:void t.preventDefault()},onKeyUp:function(t){if(this.isLocked)return t&&t.preventDefault();var e=this.$control_input.value()||"";this.lastValue!==e&&(this.lastValue=e,this.onSearchChange(e),this.refreshOptions(),this.emit("type",e))},onSearchChange:function(t){var e=this.options.load;e&&(this.loadedSearches.hasOwnProperty(t)||(this.loadedSearches[t]=!0,this.load(function(i){e.apply(this,[t,i])})))},onFocus:function(t){return this.isFocused=!0,this.isDisabled?(this.blur(),t&&t.preventDefault(),!1):void(this.ignoreFocus||("focus"===this.options.preload&&this.onSearchChange(""),this.$activeItems.length||(this.showInput(),this.setActiveItem(null),this.refreshOptions(!!this.options.openOnFocus)),this.refreshState()))},onBlur:function(t){if(this.isFocused=!1,!this.ignoreFocus){if(!this.ignoreBlur&&document.activeElement===this.$dropdown_content[0])return this.ignoreBlur=!0,void this.onFocus(t);this.options.create&&this.options.createOnBlur&&this.createItem(!1),this.close(),this.setTextboxValue(""),this.setActiveItem(null),this.setActiveOption(null),this.setCaret(this.items.length),this.refreshState()}},onOptionHover:function(t,e){e=c(e),this.ignoreHover||this.setActiveOption(e||t.currentTarget,!1)},onOptionSelect:function(t,e){var i,n;t.preventDefault&&(t.preventDefault(),t.stopPropagation()),n=c(e||t.currentTarget),n.hasClass("create")?this.createItem():(i=n.attribute("data-value"),"undefined"!=typeof i&&(this.lastQuery=null,this.setTextboxValue(""),this.addItem(i),!this.options.hideSelected&&t.type&&/mouse/.test(t.type)&&this.setActiveOption(this.getOption(i))))},onItemSelect:function(t,e){this.isLocked||"multi"===this.options.mode&&(t.preventDefault(),this.setActiveItem(e||t.currentTarget,t))},load:function(t){var e=this.$wrapper.addClass("loading");this.loading++,t.apply(this,[h(function(t){this.loading=Math.max(this.loading-1,0),t&&t.length&&(this.addOption(t),this.refreshOptions(this.isFocused&&!this.isInputHidden)),this.loading||e.removeClass("loading"),this.emit("load",t)},this)])},setTextboxValue:function(t){var e=this.$control_input,i=e.value()!==t;i&&(e.value(t).emit("update"),this.lastValue=t)},getValue:function(t){return this.tagType===P&&this.input.attribute("multiple")?t||this.items:(t||this.items).join(this.options.delimiter)},getPreviousValue:function(){return this.previousValue},setValue:function(t){U(this,["change"],function(){this.clear(),this.previousValue=this.getValue()||t,this.addItems(t)})},focus:function(){this.isDisabled||(this.ignoreFocus=!0,this.$control_input[0].focus(),setTimeout(h(function(){this.ignoreFocus=!1,this.onFocus()},this),0))},blur:function(){this.$control_input.emit("blur"),this.$control_input[0].blur()},showInput:function(){this.$control_input.style({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},setActiveItem:function(t,e){var i,n,r,o,t,a,s;if("single"!==this.options.mode){if(t=c(t),!t)return this.$activeItems.length&&c(this.$activeItems).removeClass("active"),this.$activeItems=[],void(this.isFocused&&this.showInput());if(i=e&&e.type.toLowerCase(),"mousedown"===i&&this.isShiftDown&&this.$activeItems.length){s=c(f(this.$control.children(".active"))),r=Array.prototype.indexOf.apply(this.$control[0].childNodes,[s[0]]),o=Array.prototype.indexOf.apply(this.$control[0].childNodes,[t[0]]),r>o&&(a=r,r=o,o=a);for(var l=r;o>=l;l++)t=this.$control[0].childNodes[l],-1===this.$activeItems.indexOf(t)&&(c(t).addClass("active"),this.$activeItems.push(t));e.preventDefault()}else"mousedown"===i&&this.isCtrlDown||"keydown"===i&&this.isShiftDown?t.hasClass("active")?(n=this.$activeItems.indexOf(t[0]),this.$activeItems.splice(n,1),t.removeClass("active")):this.$activeItems.push(t.addClass("active")[0]):(c(this.$activeItems)&&c(this.$activeItems).removeClass("active"),this.$activeItems=[t.addClass("active")[0]]);this.hideInput(),this.isFocused||this.focus()}},refreshOptions:function(t){var e,i,n,r,o,a,s,l,u,h,d,p,f,m,v,y;"undefined"==typeof t&&(t=!0);var w=k(this.$control_input.value()),x=this.search(w),S=this.$dropdown_content,C=this.$activeOption&&B(this.$activeOption.attribute("value"));if(r=x.items.length,"number"==typeof this.options.maxOptions&&(r=Math.min(r,this.options.maxOptions)),o={},this.options.optgroupOrder)for(a=this.options.optgroupOrder,e=0;e<a.length;e++)o[a[e]]=[];else a=[];for(e=0;r>e;e++)for(s=this.Options[x.items[e].id],l=this.render("option",s),u=s[this.options.optgroupField]||"",h=g(u)?u:[u],i=0,n=h&&h.length;n>i;i++)u=h[i],this.Optgroups.hasOwnProperty(u)||(u=""),o.hasOwnProperty(u)||(o[u]=[],a.push(u)),o[u].push(l);for(d=[],e=0,r=a.length;r>e;e++)u=a[e],this.Optgroups.hasOwnProperty(u)&&o[u].length?(p=this.render("optgroup_header",this.Optgroups[u])||"",p+=o[u].join(""),d.push(this.render("optgroup",b({},this.Optgroups[u],{html:p})))):d.push(o[u].join(""));if(S.html(d.join("")),this.options.highlight&&x.query.length&&x.tokens.length)for(e=0,r=x.tokens.length;r>e;e++)G(S,x.tokens[e].regex);if(!this.options.hideSelected)for(e=0,r=this.items.length;r>e;e++)this.getOption(this.items[e]).addClass("selected");f=this.canCreate(w),f&&(S.html(this.render("option_create",{input:w})+S.html()),y=c(S[0].childNodes[0])),this.hasOptions=x.items.length>0||f,this.hasOptions?(x.items.length>0?(v=C&&this.getOption(C),v&&v.length?m=v:"single"===this.options.mode&&this.items.length&&(m=this.getOption(this.items[0])),m&&m.length||(m=y&&!this.options.addPrecedence?this.getAdjacentOption(y,1):S.find("[data-selectable]:first-child"))):m=y,this.setActiveOption(m),t&&!this.isOpen&&this.open()):(this.setActiveOption(null),t&&this.isOpen&&this.close())},addOption:function(t){var e;if(g(t))for(var i=0,n=t.length;n>i;i++)this.addOption(t[i]);else e=B(t[this.options.valueField]),"string"!=typeof e||this.Options.hasOwnProperty(e)||(this.UserOptions[e]=!0,this.Options[e]=t,this.lastQuery=null,this.emit("option_add",e,t))},removeOption:function(t){t=B(t);var e=this.renderCache.item,i=this.renderCache.option;e&&delete e[t],i&&delete i[t],delete this.UserOptions[t],delete this.Options[t],this.lastQuery=null,this.emit("option_remove",t),this.removeItem(t)},setActiveOption:function(t,e,i){var n,r,o,a,s;this.$activeOption&&this.$activeOption.removeClass("active"),this.$activeOption=null,t=c(t),t&&(this.$activeOption=t.addClass("active"),(e||!$(e))&&(n=this.$dropdown_content[0].offsetHeight,r=this.$activeOption[0].offsetHeight,e=this.$dropdown_content[0].scrollTop||0,o=this.$activeOption.position().top-this.$dropdown_content.position().top+e,a=o,s=o-n+r,o+r>n+e?this.$dropdown_content[0].scrollTop=s:e>o&&(this.$dropdown_content[0].scrollTop=a)))},selectAll:function(){if("single"!==this.options.mode){var t=this.$control.children(":not(input)");t&&t.addClass("active"),this.$activeItems=Array.prototype.slice.apply(t||0),this.$activeItems&&(this.hideInput(),this.close()),this.focus()}},hideInput:function(){this.setTextboxValue(""),this.$control_input.style({opacity:0,position:"absolute",left:-1e4}),this.isInputHidden=!0},search:function(t){var e,i,n,r=this.getSearchOptions();if(this.options.score&&(n=this.options.score.apply(this,[t]),"function"!=typeof n))throw new Error('Selectize "score" setting must be a function that returns a function');if(t!==this.lastQuery?(this.lastQuery=t,i=this.sifter.search(t,b(r,{score:n})),this.currentResults=i):i=b({},this.currentResults),this.options.hideSelected)for(e=i.items.length-1;e>=0;e--)-1!==this.items.indexOf(B(i.items[e].id))&&i.items.splice(e,1);return i},getSearchOptions:function(){var t=this.options.sortField;return"string"==typeof t&&(t={field:t}),{fields:this.options.searchField,conjunction:this.options.searchConjunction,sort:t}},canCreate:function(t){if(!this.options.create)return!1;var e=this.options.createFilter;return!(!t.length||"function"==typeof e&&!e.apply(self,[t])||"string"==typeof e&&!new RegExp(e).test(t)||e instanceof RegExp&&!e.test(t))},insertAtCaret:function(t){var e=Math.min(this.caretPos,this.items.length);0===e?t.top(this.$control):t.after(this.$control.find(":nth-child("+e+")")),this.setCaret(e+1)},deleteSelection:function(t){var e,i,n,r,o,a,s,l,u;if(n=t&&t.keyCode===D?-1:1,r=W(this.$control_input[0]),this.$activeOption&&!this.options.hideSelected&&(s=this.getAdjacentOption(this.$activeOption,-1),s&&(s=s.attribute("data-value"))),o=[],this.$activeItems.length){var h=this.$control.children(":not(input)");for(u=this.$control.children(".active"),u&&(u=c(n>0?f(u):u[0])),a=h?p(h,u[0]):-1,n>0&&a++,e=0,i=this.$activeItems.length;i>e;e++)o.push(c(this.$activeItems[e]).attribute("data-value"));t&&(t.preventDefault(),t.stopPropagation())}else(this.isFocused||"single"===this.options.mode)&&this.items.length&&(0>n&&0===r.start&&0===r.length?o.push(this.items[this.caretPos-1]):n>0&&r.start===this.$control_input.value().length&&o.push(this.items[this.caretPos]));if(!o.length||"function"==typeof this.options.onDelete&&this.options.onDelete.apply(this,[o])===!1)return!1;for("undefined"!=typeof a&&this.setCaret(a);o.length;)this.removeItem(o.pop());return this.showInput(),this.positionDropdown(),this.refreshOptions(!0),s&&(l=this.getOption(s),l.length&&this.setActiveOption(l)),!0},advanceSelection:function(t,e){var i,n,r,o,a,s;0!==t&&(this.rtl&&(t*=-1),i=t>0?"last-child":"first-child",n=W(this.$control_input[0]),this.isFocused&&!this.isInputHidden?(o=this.$control_input.value().length,a=0>t?0===n.start&&0===n.length:n.start===o,a&&!o&&this.advanceCaret(t,e)):(s=this.$control.children(".active:"+i),s&&(r=this.$control.children(":not(input)").index(s),this.setActiveItem(null),this.setCaret(t>0?r+1:r))))},advanceCaret:function(t,e){var i,n;0!==t&&(i=t>0?"nextSibling":"previousSibling",this.isShiftDown?(n=this.$control_input[i](),n&&(this.hideInput(),this.setActiveItem(n),e&&e.preventDefault())):this.setCaret(this.caretPos+t))},setCaret:function(t){if(t="single"===this.options.mode?this.items.length:Math.max(0,Math.min(this.items.length,t)),!this.isPending){var e,i,n,r;for(n=this.$control.children(":not(input)"),e=0,i=n?n.length:0;i>e;e++)r=c(n[e]),t>e?r.before(this.$control_input):this.$control.appendChild(r)}this.caretPos=t},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){this.input.attribute("disabled",!0),this.isDisabled=!0,this.lock()},enable:function(){this.input.attribute("disabled",null),this.isDisabled=!1,this.unlock()},destroy:function(){var t=this.revertSettings;this.emit("destroy"),this.off(),this.$wrapper.remove(),this.$dropdown.remove(),this.input.html("").appendChild(t.$children).attribute("tabindex",null).removeClass("selectized").attribute({tabindex:t.tabindex}).style({display:"block"}),delete this.$control_input.selectizeGrow,delete this.input.selectizeInstance},render:function(t,e){var i,n,r="",o=!1,a=/^[\t ]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i;return("option"===t||"item"===t)&&(i=B(e[this.options.valueField]),o=!!i),o&&($(this.renderCache[t])||(this.renderCache[t]={}),this.renderCache[t].hasOwnProperty(i))?this.renderCache[t][i]:(r=this.options.render[t].apply(this,[e,w]),("option"===t||"option_create"===t)&&(r=r.replace(a,"<$1 data-selectable")),"optgroup"===t&&(n=e[this.options.optgroupValueField]||"",r=r.replace(a,'<$1 data-group="'+H(w(n))+'"')),("option"===t||"item"===t)&&(r=r.replace(a,'<$1 data-value="'+H(w(i||""))+'"')),o&&(this.renderCache[t][i]=r),r)},clearCache:function(t){"undefined"==typeof t?this.renderCache={}:delete this.renderCache[t]}});c.implement({selectize:function(t){t=t||{};var e=K.prototype.options,i=b({},e,t),n=i.dataAttr,r=i.labelField,o=i.valueField,a=i.optgroupField,s=i.optgroupLabelField,l=i.optgroupValueField,u=function(t,e){t=c(t);var n,a,s,l,u=k(t.value()||"");if(i.allowEmptyOption||u.length){for(s=u.split(i.delimiter),n=0,a=s.length;a>n;n++)l={},l[r]=s[n],l[o]=s[n],e.Options[s[n]]=l;e.items=s}},h=function(t,e){var u,h,d,p,f=0,m=e.Options,v=function(t){var e=n&&t.attribute(n);return"string"==typeof e&&e.length?JSON.parse(e):null},b=function(t,n){var s,l;if(t=c(t),s=t.attribute("value")||"",s.length||i.allowEmptyOption){if(m.hasOwnProperty(s))return void(n&&(m[s].optgroup?g(m[s].optgroup)?m[s].optgroup.push(n):m[s].optgroup=[m[s].optgroup,n]:m[s].optgroup=n));l=v(t)||{},l[r]=l[r]||t.text(),l[o]=l[o]||s,l[a]=l[a]||n,l.$order=++f,m[s]=l,t.matches(":selected")&&e.items.push(s)}},y=function(t){var i,n,r,o,a;for(t=c(t),r=t.attribute("label"),r&&(o=v(t)||{},o[s]=r,o[l]=r,e.Optgroups[r]=o),a=t.search("option"),i=0,n=a.length;n>i;i++)b(a[i],r)};for(e.maxItems=t.attribute("multiple")?null:1,p=t.children()||0,u=0,h=p.length;h>u;u++)d=p[u].tagName.toLowerCase(),"optgroup"===d?y(p[u]):"option"===d&&b(p[u])};return this.forEach(function(n){if(n=c(n),!n.selectizeInstance){var r,o=n.data("selectize"),a=n.tag().toLowerCase(),s=n.attribute("placeholder")||n.attribute("data-placeholder");if(o&&(o=JSON.parse(o)),i=b({},i,o),!s&&!i.allowEmptyOption){var l=n.children('option[value=""]');s=l?n.children('option[value=""]').text():""}var d={placeholder:s,Options:{},Optgroups:{},items:[]};"select"===a?h(n,d):u(n,d),r=new K(n,b({},e,d,t,o))}})}}),r(function(){var t=c("[data-selectize]");t&&t.selectize()}),e.exports=K},{"../utils/elements.utils":51,"elements/domready":86,"elements/zen":112,moofx:113,"mout/array/indexOf":151,"mout/array/last":155,"mout/collection/forEach":164,"mout/function/bind":167,"mout/function/debounce":168,"mout/lang/isArray":177,"mout/lang/isBoolean":178,"mout/object/merge":208,"mout/object/size":213,"mout/object/unset":215,"mout/object/values":216,"mout/string/escapeHtml":227,"mout/string/trim":236,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256,sifter:268}],47:[function(t,e,i){"use strict";var n=t("prime"),r=t("prime/emitter"),o=t("prime-util/prime/bound"),a=t("prime-util/prime/options"),s=t("elements/zen"),l=t("../utils/elements.utils.js"),u=t("prime/map")(),c=t("mout/function/bind"),h=t("mout/object/merge"),d=new n({mixin:[o,a],inherits:r,options:{tapToDismiss:!0,noticeClass:"g-notifications",containerID:"g-notifications-container",types:{base:"",error:"fa-minus-circle",info:"fa-info-circle",success:"fa-check-circle",warning:"fa-exclamation-triangle"},showDuration:300,showEquation:"cubic-bezier(0.02, 0.01, 0.47, 1)",hideDuration:500,hideEquation:"cubic-bezier(0.02, 0.01, 0.47, 1)",timeOut:2500,extendedTimeout:2500,location:"bottom-right",titleClass:"g-notifications-title",messageClass:"g-notifications-message",closeButton:!0,target:"#g5-container",targetLocation:"bottom",newestOnTop:!0,preventDuplicates:!1,progressBar:!0},constructor:function(t){this.setOptions(t),this.id=0,this.previousNotice=null,this.map=u},mergeOptions:function(t){return h(this.options,t||{})},base:function(t,e,i){return i=this.mergeOptions(i),this.notify(h(i,{title:e||"",type:i.type||"base",message:t}))},success:function(t,e,i){return i=this.mergeOptions(i),this.notify(h(i,{title:e||"Success!",type:"success",message:t}))},info:function(t,e,i){return i=this.mergeOptions(i),this.notify(h(i,{title:e||"Info",type:"info",message:t}))},warning:function(t,e,i){return i=this.mergeOptions(i),this.notify(h(i,{title:e||"Warning!",type:"warning",message:t}))},error:function(t,e,i){return i=this.mergeOptions(i),this.notify(h(i,{title:e||"Error!",type:"error",message:t}))},notify:function(t){if(t=this.mergeOptions(t),!t.preventDuplicates||this.previousNotice!==t.message){this.id++,this.previousNotice=t.message;var e=this.getContainer(t,!0),i=s("div"),n=s("div"),r=s("div"),o=s("i.fa"),a=s("div.g-notifications-progress"),l=s('a.fa.fa-close[href="#"]');if(this.map.set(i,{container:e,interval:null,progressBar:{interval:null,hideETA:null,maxHideTime:null},response:{id:this.id,state:"visible",start:new Date,options:t},options:t}),t.title&&i.appendChild(n.html(t.title).addClass(t.titleClass)),t.message&&i.appendChild(r.html(t.message).addClass(t.messageClass)),t.closeButton&&l.top(i),t.progressBar&&a.top(i),t.type&&t.title&&t.types[t.type]&&(i.addClass("g-notifications-theme-"+t.type),o.top(n).addClass(t.types[t.type])),i.style({opacity:0}),i[t.newestOnTop?"top":"bottom"](e),i.animate({opacity:1},{duration:t.showDuration,equation:t.showEquation,callback:t.onShow}),t.timeOut>0){var u=this.map.get(i);u.interval=setTimeout(c(function(){this.hide(i)},this),t.timeOut),u.progressBar.maxHideTime=parseFloat(t.timeOut),u.progressBar.hideETA=(new Date).getTime()+u.progressBar.maxHideTime,t.progressBar&&(u.progressBar.interval=setInterval(c(function(){this.updateProgress(i,a)},this),10)),this.map.set(i,u)}var h=c(function(){this.stickAround(i)},this),d=c(function(){this.delayedHide(i)},this);i.on("mouseover",h),i.on("mouseout",d),!t.onClick&&t.tapToDismiss&&i.on("click",c(function(){i.off("mouseover",h),i.off("mouseout",d),this.hide(i)},this)),t.closeButton&&l&&l.on("click",c(function(t){t.stopPropagation(),t.preventDefault(),i.off("mouseover",h),i.off("mouseout",d),this.hide(i,!0)},this))}},stickAround:function(t){var e=this.map.get(t);clearTimeout(e.interval),e.progressBar.hideETA=0,t.animate({opacity:1},{duration:e.options.showDuration,equation:e.options.showEquation,callback:e.options.onShow}),this.map.set(t,e)},hide:function(t,e){if(!t.find(":focus")||e){var i=this.map.get(t);return clearTimeout(i.progressBar.interval),this.map.set(t,i),t.animate({opacity:0},{duration:i.options.hideDuration,equation:i.options.hideEquation,callback:c(function(){this.remove(t),i.options.onHidden&&"hidden"!==i.response.state&&i.options.onHidden(),i.response.state="hidden",i.response.endTime=new Date,this.map.set(t,i)},this)})}},delayedHide:function(t,e){var i=this.map.get(t);(i.options.timeOut>0||i.options.extendedTimeout>0)&&(i.interval=setTimeout(c(function(){this.hide(t)},this),i.options.extendedTimeout),i.progressBar.maxHideTime=parseFloat(i.options.extendedTimeout),i.progressBar.hideETA=(new Date).getTime()+i.progressBar.maxHideTime),this.map.set(t,i)},updateProgress:function(t,e){var i=this.map.get(t),n=(i.progressBar.hideETA-(new Date).getTime())/i.progressBar.maxHideTime*100;this.map.set(t,i),e.style({width:n+"%"})},getContainer:function(t,e){t=this.mergeOptions(t);var i=l("#"+t.containerID);return i?i:(e&&(i=this.createContainer(t)),i)},createContainer:function(t){return t=this.mergeOptions(t),s("div#"+t.containerID+"."+t.location)[t.targetLocation](t.target)},remove:function(t){if(t){var e=this.map.get(t);e.container||(e.container=this.getContainer(e.options)),t.remove(),e.container.children()||(e.container.remove(),this.previousNotice=null),this.map.set(t,e)}}}),p=new d;e.exports=p},{"../utils/elements.utils.js":51,"elements/zen":112,"mout/function/bind":167,"mout/object/merge":208,prime:257,"prime-util/prime/bound":253,"prime-util/prime/options":254,"prime/emitter":256,"prime/map":258}],48:[function(t,e,i){"use strict";var n,r=t("elements/domready"),o=t("elements"),a=function(t,e){return t.type.match(/^touch/)&&t.preventDefault(),e=o(e),(n=e.find("~~ [type=hidden]"))?(n.value("0"==n.value()?"1":"0"),n.emit("change"),void o("body").emit("change",{target:n})):!0};r(function(){["touchend","click"].forEach(function(t){o("body").delegate(t,".enabler .toggle",a)})}),e.exports={}},{elements:88,"elements/domready":86}],49:[function(t,e,i){"use strict";var n=(t("prime"),t("../utils/elements.utils")),r=(t("elements/zen"),t("elements/domready")),o=t("prime/map")(),a=t("../ui").modal,s=t("mout/collection/size"),l=t("mout/array/indexOf"),u=t("mout/object/merge"),c=t("mout/random/guid"),h=t("mout/queryString/encode"),d=t("mout/string/contains"),p=t("agent")(),f=t("./history"),m=t("./flags-state"),g=t("./get-ajax-suffix"),v=t("../menu");t("../ui/popover");var b=!1,y=!1,w=-1;f.Adapter.bind(window,"statechange",function(){if(p.running())return!1;var t=n("body"),e=f.getState(),i=e.url,r=e.data,l=n("#navbar"),u=n("#main-header"),c="";if(s(r)&&r.parsed!==!1&&o.get(r.uuid)&&(r=o.get(r.uuid)),r.element){var m=r.element.parent("#main-header")||r.element.matches(".menu-select-wrap");t.emit("statechangeBefore",{target:r.element,Data:r})}else{var v=i.replace(window.location.origin,"");r.element=n('[href="'+v+'"]')}i+=g();var y;if(l&&r.element){{l.search("li.active")}y=l.search("li"),y.removeClass("active"),r.element.parent("#navbar")&&r.element.parent("li").addClass("active")}u&&r.element&&!r.element.matches("a.menu-item")&&!r.element.matches("select.menu-select-wrap")&&(y=u.search(".float-right li"),y.removeClass("active"),r.element.parent("#main-header")&&r.element.parent("li").addClass("active")),r.params&&(c=h(JSON.parse(r.params)),d(i,"?")&&(c=c.replace(/^\?/,"&"))),b||a.closeAll(),p.url(i+c).data(r.extras||{}).method(r.extras?"post":"get").send(function(e,i){if(!i.body.success)return b=!0,a.open({content:i.body.html||i.body,afterOpen:function(t){i.body.html||t.style({width:"90%"})}}),f.back(),r.element&&r.element.hideIndicator(),!1;var o=r.parent?r.element.parent(r.parent):n(r.target),s=o||n("[data-g5-content]")||t;if(i.body&&i.body.html){var l;s.html(i.body.html),(l=s.matches("[data-g5-content]")?s:s.find("[data-g5-content]"))&&(l.style({opacity:0}),n("#navbar")[m?"slideUp":"slideDown"](),l.animate({opacity:1}))}else s.html(i.body);t.getPopover().hideAll(!0).destroy(),r.element&&t.emit("statechangeAfter",{target:r.element,Data:r});var u=r.event&&r.event.activeSpinner||r.element;u&&u.hideIndicator();var c=n("[data-selectize]");c&&c.selectize(),k(),t.emit("statechangeEnd")})});var k=function(){var t=n("[data-selectize-ajaxify]");t&&t.forEach(function(t){t=n(t);var e=t.selectize().selectizeInstance;e&&!e.HasChangeEvent&&(e.on("change",function(){if(y)return y=!1,!1;var i=e.getValue(),r=e.Options,o=function(){m.off("update:pending",o),a.close(),e.input.data("g5-ajaxify","").data("g5-ajaxify-target",t.data("g5-ajaxify-target")||"[data-g5-content-wrapper]").data("g5-ajaxify-target-parent",t.data("g5-ajaxify-target-parent")||null).data("g5-ajaxify-href",r[i].url).data("g5-ajaxify-params",r[i].params?JSON.stringify(r[i].params):null);var s=n("#navbar li.active")||n("#main-header li.active")||n("#navbar li:nth-child(2)");s&&s.showIndicator(),n("body").emit("click",{target:e.input,activeSpinner:s})};if(r[i])return m.get("pending")?void m.warning({callback:function(t,e){var i=e.find("[data-g-unsaved-save]"),r=e.find("[data-g-unsaved-discard]");i&&(i.on("click",function(t){return t.preventDefault(),this.attribute("disabled")?!1:(n([i,r]).attribute("disabled"),m.on("update:pending",o),void n("body").emit("click",{target:n(".button-save")}))}),r.on("click",function(t){return t.preventDefault(),this.attribute("disabled")?!1:(n([i,r]).attribute("disabled"),m.set("pending",!1),void o())}))},afterclose:function(){y=!0,e.setValue(e.getPreviousValue())}}):void o()}),e.HasChangeEvent=!0)})};r(function(){var t=n("body");t.delegate("click",".button-back-to-conf",function(e,i){e.preventDefault(),w=-1==w?1:w;var r=n("#navbar"),o=r.find("li:nth-child("+(w+1)+") [data-g5-ajaxify]");return m.get("pending")?void m.warning({callback:function(e,i){var s=i.find("[data-g-unsaved-save]"),l=i.find("[data-g-unsaved-discard]"),u=function(){m.off("update:pending",u),a.close(),t.emit("click",{target:o}),r.slideDown()};s&&(s.on("click",function(e){return e.preventDefault(),this.attribute("disabled")?!1:(n([s,l]).attribute("disabled"),m.on("update:pending",u),void t.emit("click",{target:n(".button-save")}))}),l.on("click",function(t){return t.preventDefault(),this.attribute("disabled")?!1:(n([s,l]).attribute("disabled"),m.set("pending",!1),void u())}))}}):(i.showIndicator(),t.emit("click",{target:o}),void r.slideDown())}),t.delegate("click","#navbar a[data-g5-ajaxify]",function(t,e){var i=n("#navbar"),r=i.search("li a[data-g5-ajaxify]");w=l(r,e[0])+1}),t.delegate("click","[data-g5-ajaxify]",function(e,i){if(e&&e.preventDefault){if(2===e.which||e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return!0;e.preventDefault()}if(m.get("pending")&&!i.matches("a.menu-item")&&!i.parent("[data-menu-items]"))return void m.warning({callback:function(i,r){var o=r.find("[data-g-unsaved-save]"),s=r.find("[data-g-unsaved-discard]"),l=function(){m.off("update:pending",l),a.close(),t.emit("click",e)};o&&(o.on("click",function(e){return e.preventDefault(),this.attribute("disabled")?!1:(n([o,s]).attribute("disabled"),m.on("update:pending",l),void t.emit("click",{target:n(".button-save")}))}),s.on("click",function(t){return t.preventDefault(),this.attribute("disabled")?!1:(n([o,s]).attribute("disabled"),m.set("pending",!1),void l())}))}});i.showIndicator();var r=i.data("g5-ajaxify"),s=i.data("g5-ajaxify-target"),l=i.data("g5-ajaxify-target-parent"),h=i.attribute("href")||i.data("g5-ajaxify-href"),d=i.data("g5-ajaxify-params")||!1,p=i.attribute("title")||window.document.title;if(r=r?JSON.parse(r):{parsed:!1}){var g,b=c();(i.data("mm-id")||i.parent("[data-mm-id]"))&&(g={},g.menutype=n("select.menu-select-wrap").value(),g.settings=JSON.stringify(v.menumanager.settings),g.ordering=JSON.stringify(v.menumanager.ordering),g.items=JSON.stringify(v.menumanager.items)),o.set(b,u({},r,{target:s,parent:l,element:i,params:d,extras:g,event:e})),r={uuid:b}}f.pushState(r,p,h);var y,w,k=n("#navbar .active, #main-header .active");(y=i.parent("#navbar, #main-header"))&&(k&&k.removeClass("active"),w=y.search(".active"),w&&w.removeClass("active"),i.parent("li").addClass("active"))}),k()}),e.exports={}},{"../menu":27,"../ui":42,"../ui/popover":44,"../utils/elements.utils":51,"./flags-state":54,"./get-ajax-suffix":55,"./history":58,agent:61,"elements/domready":86,"elements/zen":112,"mout/array/indexOf":151,"mout/collection/size":166,"mout/object/merge":208,"mout/queryString/encode":217,"mout/random/guid":220,"mout/string/contains":226,prime:257,"prime/map":258}],50:[function(t,e,i){"use strict";var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),r=function(t,e,i){var r,o=!1;t=t[0]||t;var a=function(t){r=t,s()},s=function(){o||(n(l),o=!0)},l=function(){i.call(t,r),o=!1};t.addEventListener(e,a,!1)};e.exports=r},{}],51:[function(t,e,i){"use strict";var n=t("elements"),r=t("moofx"),o=t("mout/array/map"),a=t("mout/function/series"),s=t("slick"),l=t("elements/zen"),u=t("../ui/progresser"),c=function(t,e){return function(i){var n=s.parse(i||"*");return i=o(n,function(e){return t+" "+e}).join(", "),this[e](i)}};n.implement({style:function(){var t=r(this);return t.style.apply(t,arguments),this},animate:function(){var t=r(this);return t.animate.apply(t,arguments),this},progresser:function(t){var e;this.forEach(function(i){return e=i.ProgresserInstance,e?e.constructor(i,t):e=new u(i,t),i.ProgresserInstance=e,e})},compute:function(){var t=r(this);return t.compute.apply(t,arguments)},showIndicator:function(t,e){this.forEach(function(i){i=n(i),"boolean"==typeof t&&(e=t,t=null);var r=e?!1:i.find("i");i.gHadIcon=!!r,r||(i.find("span")||i.children()||l("span").text(i.text()).top(i.empty()),r=l("i"),r.top(i)),i.gIndicator||(i.gIndicator=r.attribute("class")||!0),r.attribute("class",t||"fa fa-fw fa-spin-fast fa-spinner")})},hideIndicator:function(){this.forEach(function(t){if(t=n(t),t.gIndicator){var e=t.find("i");e&&(t.gHadIcon?e.attribute("class",t.gIndicator):e.remove(),t.gIndicator=null)}})},slideDown:function(t,e){var i=this,n=this.getRealSize(),r=function(){i.gSlideCollapsed=!1},o=function(){i.attribute("style",i.gSlideStyle)};return e="function"==typeof t?t:e||function(){},this.gSlideCollapsed===!1?e():(e=a(r,e,o),t="string"==typeof t?t:{duration:"250ms",callback:e},void this.animate({height:n.height},t))},slideUp:function(t,e){"undefined"==typeof this.gSlideCollapsed&&(this.gSlideStyle=this.attribute("style"));var i=this,n=function(){i.gSlideCollapsed=!0};return e="function"==typeof t?t:e||function(){},this.gSlideCollapsed===!0?e():(e=a(n,e),t="string"==typeof t?t:{duration:"250ms",callback:e},void this.style({overflow:"hidden"}).animate({height:0},t))},slideToggle:function(t,e){var i=this.getRealSize();return this[i.height&&!this.gSlideCollapsed?"slideUp":"slideDown"](t,e)},getRealSize:function(){var t,e=this.attribute("style");return this.style({position:"relative",
overflow:"inherit",top:-5e4,height:"auto",width:"auto"}),t={width:parseInt(this.compute("width"),10),height:parseInt(this.compute("height"),10)},this.attribute("style",e),t},sibling:c("++","find"),siblings:c("~~","search")}),e.exports=n},{"../ui/progresser":45,elements:88,"elements/zen":112,moofx:113,"mout/array/map":156,"mout/function/series":172,slick:270}],52:[function(t,e,i){"use strict";var n=t("elements");n.implement({belowthefold:function(t,e){var i=this.search(t);if(e=e||0,!i)return!1;var r=this.position().height+this[0].scrollTop;return i.filter(function(t){return r<=n(t)[0].offsetTop-e})},abovethetop:function(t,e){var i=this.search(t);if(e=e||0,!i)return!1;var r=this[0].scrollTop;return i.filter(function(t){return r>=n(t)[0].offsetTop+n(t).position().height-e})},rightofscreen:function(t,e){var i=this.search(t);if(e=e||0,!i)return!1;var r=this.position().width+this[0].scrollLeft;return i.filter(function(t){return r<=n(t)[0].offsetLeft-e})},leftofscreen:function(t,e){var i=this.search(t);if(e=e||0,!i)return!1;var r=this[0].scrollLeft;return i.filter(function(t){return r>=n(t)[0].offsetLeft+n(t).position().width-e})},inviewport:function(t,e){var i=this.search(t);if(e=e||0,!i)return!1;var r=this.position();return i.filter(function(t){return t=n(t),t[0].offsetTop+e>=this[0].scrollTop&&t[0].offsetTop-e<=this[0].scrollTop+r.height},this)}}),e.exports=n},{elements:88}],53:[function(t,e,i){"use strict";var n=t("elements"),r=function(t){t=n(t);var e=t[0],i=t.tag(),r=t.type(),a=!0;return~["input","textarea","select"].indexOf(i)?("undefined"!=typeof e.willValidate?("input"==i&&e.type.toLowerCase()!==r&&e.setCustomValidity(o(t)?"":"The field value is invalid"),e.checkValidity()):(e.validity=e.validity||{},e.validity.valid=o(t)),a=e.validity.valid):a},o=function(t){t=n(t);var e=!0,i=t.value(),r=t.type(),o="checkbox"==r||"radio"==r,a=t.attribute("disabled"),s=t.attribute("required"),l=t.attribute("minlength"),u=t.attribute("maxlength"),c=t.attribute("pattern");return a?e:(e=e&&(!s||o&&t.checked()||!o&&i),e=e&&(o||(!l||i.length>=l)&&(!u||i.length<=u)),e&&c&&(c=new RegExp(c),e=c.test(i)),e)};e.exports=r},{elements:88}],54:[function(t,e,i){"use strict";var n=t("prime"),r=t("prime/map"),o=t("prime/emitter"),a=t("../ui").modal,s=t("./get-ajax-url").global,l=t("./get-ajax-suffix"),u=new n({inherits:o,constructor:function(){this.flags=r()},set:function(t,e){return this.flags.set(t,e).get(t)},get:function(t,e){var i=this.flags.get(t);return i?i:this.set(t,e)},keys:function(){return this.flags.keys()},values:function(){return this.flags.values()},warning:function(t){var e=t.callback||function(){},i=t.afterclose||function(){},n=t.url||s("unsaved")+l();a.open({content:"Loading...",remote:n,remoteLoaded:function(t,i){var n=i.elements.content;e&&e.call(this,t,n,i)},afterClose:i||function(){}})}});e.exports=new u},{"../ui":42,"./get-ajax-suffix":55,"./get-ajax-url":56,prime:257,"prime/emitter":256,"prime/map":258}],55:[function(t,e,i){"use strict";var n=function(){return"undefined"==typeof GANTRY_AJAX_SUFFIX?"":GANTRY_AJAX_SUFFIX};e.exports=n},{}],56:[function(t,e,i){"use strict";var n=t("mout/string/unescapeHtml"),r=function(t,e){e||(e="%ajax%");var i=new RegExp(e,"g"),r="undefined"==typeof GANTRY_AJAX_URL?"":GANTRY_AJAX_URL;return n(r.replace(i,t))},o=function(t,e){e||(e="%ajax%");var i=new RegExp(e,"g"),r="undefined"==typeof GANTRY_AJAX_CONF_URL?"":GANTRY_AJAX_CONF_URL;return n(r.replace(i,t))};e.exports={global:r,config:o}},{"mout/string/unescapeHtml":237}],57:[function(t,e,i){"use strict";var n=t("elements"),r=t("elements/domready"),o={};if("undefined"!=typeof o.Adapter)throw new Error("History.js Adapter has already been loaded...");o.Adapter={bind:function(t,e,i){n(t).on(e,i)},trigger:function(t,e,i){n(t).emit(e,i)},extractEventData:function(t,e){return e&&e.event&&e.event[t]||e&&e[t]||void 0},onDomLoad:function(t){r(t)}},"undefined"!=typeof o.init&&o.init(),e.exports=o},{elements:88,"elements/domready":86}],58:[function(t,e,i){"use strict";var n=window.console||void 0,r=window.document,o=window.navigator,a=!1,s=window.setTimeout,l=window.clearTimeout,u=window.setInterval,c=window.clearInterval,h=window.JSON,d=window.alert,p=window.History=t("./history-adapter")||{},f=window.history;try{a=window.sessionStorage,a.setItem("TEST","1"),a.removeItem("TEST")}catch(m){a=!1}h.stringify=h.stringify||h.encode,h.parse=h.parse||h.decode,"undefined"==typeof p.init&&(p.init=function(t){return"undefined"==typeof p.Adapter?!1:("undefined"!=typeof p.initCore&&p.initCore(),"undefined"!=typeof p.initHtml4&&p.initHtml4(),!0)},p.initCore=function(t){if("undefined"!=typeof p.initCore.initialized)return!1;if(p.initCore.initialized=!0,p.options=p.options||{},p.options.hashChangeInterval=p.options.hashChangeInterval||100,p.options.safariPollInterval=p.options.safariPollInterval||500,p.options.doubleCheckInterval=p.options.doubleCheckInterval||500,p.options.disableSuid=p.options.disableSuid||!1,p.options.storeInterval=p.options.storeInterval||1e3,p.options.busyDelay=p.options.busyDelay||250,p.options.debug=p.options.debug||!1,p.options.initialTitle=p.options.initialTitle||r.title,p.options.html4Mode=p.options.html4Mode||!1,p.options.delayInit=p.options.delayInit||!1,p.intervalList=[],p.clearAllIntervals=function(){var t,e=p.intervalList;if("undefined"!=typeof e&&null!==e){for(t=0;t<e.length;t++)c(e[t]);p.intervalList=null}},p.debug=function(){p.options.debug&&p.log.apply(p,arguments)},p.log=function(){var t,e,i,o,a,s=!("undefined"==typeof n||"undefined"==typeof n.log||"undefined"==typeof n.log.apply),l=r.getElementById("log");for(s?(o=Array.prototype.slice.call(arguments),t=o.shift(),"undefined"!=typeof n.debug?n.debug.apply(n,[t,o]):n.log.apply(n,[t,o])):t="\n"+arguments[0]+"\n",e=1,i=arguments.length;i>e;++e){if(a=arguments[e],"object"==typeof a&&"undefined"!=typeof h)try{a=h.stringify(a)}catch(u){}t+="\n"+a+"\n"}return l?(l.value+=t+"\n-----\n",l.scrollTop=l.scrollHeight-l.clientHeight):s||d(t),!0},p.getInternetExplorerMajorVersion=function(){var t=p.getInternetExplorerMajorVersion.cached="undefined"!=typeof p.getInternetExplorerMajorVersion.cached?p.getInternetExplorerMajorVersion.cached:function(){for(var t=3,e=r.createElement("div"),i=e.getElementsByTagName("i");(e.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->")&&i[0];);return t>4?t:!1}();return t},p.isInternetExplorer=function(){var t=p.isInternetExplorer.cached="undefined"!=typeof p.isInternetExplorer.cached?p.isInternetExplorer.cached:Boolean(p.getInternetExplorerMajorVersion());return t},p.emulated=p.options.html4Mode?{pushState:!0,hashChange:!0}:{pushState:!Boolean(window.history&&window.history.pushState&&window.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(o.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(o.userAgent))),hashChange:Boolean(!("onhashchange"in window||"onhashchange"in r)||p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<8)},p.enabled=!p.emulated.pushState,p.bugs={setHash:Boolean(!p.emulated.pushState&&"Apple Computer, Inc."===o.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(o.userAgent)),safariPoll:Boolean(!p.emulated.pushState&&"Apple Computer, Inc."===o.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(o.userAgent)),ieDoubleCheck:Boolean(p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<7)},p.isEmptyObject=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},p.cloneObject=function(t){var e,i;return t?(e=h.stringify(t),i=h.parse(e)):i={},i},p.getRootUrl=function(){var t=r.location.protocol+"//"+(r.location.hostname||r.location.host);return r.location.port&&(t+=":"+r.location.port),t+="/"},p.getBaseHref=function(){var t=r.getElementsByTagName("base"),e=null,i="";return 1===t.length&&(e=t[0],i=e.href.replace(/[^\/]+$/,"")),i=i.replace(/\/+$/,""),i&&(i+="/"),i},p.getBaseUrl=function(){var t=p.getBaseHref()||p.getBasePageUrl()||p.getRootUrl();return t},p.getPageUrl=function(){var t,e=p.getState(!1,!1),i=(e||{}).url||p.getLocationHref();return t=i.replace(/\/+$/,"").replace(/[^\/]+$/,function(t,e,i){return/\./.test(t)?t:t+"/"})},p.getBasePageUrl=function(){var t=p.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(t,e,i){return/[^\/]$/.test(t)?"":t}).replace(/\/+$/,"")+"/";return t},p.getFullUrl=function(t,e){var i=t,n=t.substring(0,1);return e="undefined"==typeof e?!0:e,/[a-z]+\:\/\//.test(t)||(i="/"===n?p.getRootUrl()+t.replace(/^\/+/,""):"#"===n?p.getPageUrl().replace(/#.*/,"")+t:"?"===n?p.getPageUrl().replace(/[\?#].*/,"")+t:e?p.getBaseUrl()+t.replace(/^(\.\/)+/,""):p.getBasePageUrl()+t.replace(/^(\.\/)+/,"")),i.replace(/\#$/,"")},p.getShortUrl=function(t){var e=t,i=p.getBaseUrl(),n=p.getRootUrl();return p.emulated.pushState&&(e=e.replace(i,"")),e=e.replace(n,"/"),p.isTraditionalAnchor(e)&&(e="./"+e),e=e.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},p.getLocationHref=function(t){return t=t||r,t.URL===t.location.href?t.location.href:t.location.href===decodeURIComponent(t.URL)?t.URL:t.location.hash&&decodeURIComponent(t.location.href.replace(/^[^#]+/,""))===t.location.hash?t.location.href:-1==t.URL.indexOf("#")&&-1!=t.location.href.indexOf("#")?t.location.href:t.URL||t.location.href},p.store={},p.idToState=p.idToState||{},p.stateToId=p.stateToId||{},p.urlToId=p.urlToId||{},p.storedStates=p.storedStates||[],p.savedStates=p.savedStates||[],p.normalizeStore=function(){p.store.idToState=p.store.idToState||{},p.store.urlToId=p.store.urlToId||{},p.store.stateToId=p.store.stateToId||{}},p.getState=function(t,e){"undefined"==typeof t&&(t=!0),"undefined"==typeof e&&(e=!0);var i=p.getLastSavedState();return!i&&e&&(i=p.createStateObject()),t&&(i=p.cloneObject(i),i.url=i.cleanUrl||i.url),i},p.getIdByState=function(t){var e,i=p.extractId(t.url);if(!i)if(e=p.getStateString(t),"undefined"!=typeof p.stateToId[e])i=p.stateToId[e];else if("undefined"!=typeof p.store.stateToId[e])i=p.store.stateToId[e];else{for(;;)if(i=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"==typeof p.idToState[i]&&"undefined"==typeof p.store.idToState[i])break;p.stateToId[e]=i,p.idToState[i]=t}return i},p.normalizeState=function(t){var e,i;return t&&"object"==typeof t||(t={}),"undefined"!=typeof t.normalized?t:(t.data&&"object"==typeof t.data||(t.data={}),e={},e.normalized=!0,e.title=t.title||"",e.url=p.getFullUrl(t.url?t.url:p.getLocationHref()),e.hash=p.getShortUrl(e.url),e.data=p.cloneObject(t.data),e.id=p.getIdByState(e),e.cleanUrl=e.url.replace(/\??\&_suid.*/,""),e.url=e.cleanUrl,i=!p.isEmptyObject(e.data),(e.title||i)&&p.options.disableSuid!==!0&&(e.hash=p.getShortUrl(e.url).replace(/\??\&_suid.*/,""),/\?/.test(e.hash)||(e.hash+="?"),e.hash+="&_suid="+e.id),e.hashedUrl=p.getFullUrl(e.hash),(p.emulated.pushState||p.bugs.safariPoll)&&p.hasUrlDuplicate(e)&&(e.url=e.hashedUrl),e)},p.createStateObject=function(t,e,i){var n={data:t,title:e,url:i};return n=p.normalizeState(n)},p.getStateById=function(t){t=String(t);var e=p.idToState[t]||p.store.idToState[t]||void 0;return e},p.getStateString=function(t){var e,i,n;return e=p.normalizeState(t),i={data:e.data,title:t.title,url:t.url},n=h.stringify(i)},p.getStateId=function(t){var e,i;return e=p.normalizeState(t),i=e.id},p.getHashByState=function(t){var e,i;return e=p.normalizeState(t),i=e.hash},p.extractId=function(t){var e,i,n,r;return r=-1!=t.indexOf("#")?t.split("#")[0]:t,i=/(.*)\&_suid=([0-9]+)$/.exec(r),n=i?i[1]||t:t,e=i?String(i[2]||""):"",e||!1},p.isTraditionalAnchor=function(t){var e=!/[\/\?\.]/.test(t);return e},p.extractState=function(t,e){var i,n,r=null;return e=e||!1,i=p.extractId(t),i&&(r=p.getStateById(i)),r||(n=p.getFullUrl(t),i=p.getIdByUrl(n)||!1,i&&(r=p.getStateById(i)),r||!e||p.isTraditionalAnchor(t)||(r=p.createStateObject(null,null,n))),r},p.getIdByUrl=function(t){var e=p.urlToId[t]||p.store.urlToId[t]||void 0;return e},p.getLastSavedState=function(){return p.savedStates[p.savedStates.length-1]||void 0},p.getLastStoredState=function(){return p.storedStates[p.storedStates.length-1]||void 0},p.hasUrlDuplicate=function(t){var e,i=!1;return e=p.extractState(t.url),i=e&&e.id!==t.id},p.storeState=function(t){return p.urlToId[t.url]=t.id,p.storedStates.push(p.cloneObject(t)),t},p.isLastSavedState=function(t){var e,i,n,r=!1;return p.savedStates.length&&(e=t.id,i=p.getLastSavedState(),n=i.id,r=e===n),r},p.saveState=function(t){return p.isLastSavedState(t)?!1:(p.savedStates.push(p.cloneObject(t)),!0)},p.getStateByIndex=function(t){var e=null;return e="undefined"==typeof t?p.savedStates[p.savedStates.length-1]:0>t?p.savedStates[p.savedStates.length+t]:p.savedStates[t]},p.getCurrentIndex=function(){var t=null;return t=p.savedStates.length<1?0:p.savedStates.length-1},p.getHash=function(t){var e,i=p.getLocationHref(t);return e=p.getHashByUrl(i)},p.unescapeHash=function(t){var e=p.normalizeHash(t);return e=decodeURIComponent(e)},p.normalizeHash=function(t){var e=t.replace(/[^#]*#/,"").replace(/#.*/,"");return e},p.setHash=function(t,e){var i,n;return e!==!1&&p.busy()?(p.pushQueue({scope:p,callback:p.setHash,args:arguments,queue:e}),!1):(p.busy(!0),i=p.extractState(t,!0),i&&!p.emulated.pushState?p.pushState(i.data,i.title,i.url,!1):p.getHash()!==t&&(p.bugs.setHash?(n=p.getPageUrl(),p.pushState(null,null,n+"#"+t,!1)):r.location.hash=t),p)},p.escapeHash=function(t){var e=p.normalizeHash(t);return e=window.encodeURIComponent(e),p.bugs.hashEscape||(e=e.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),e},p.getHashByUrl=function(t){var e=String(t).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return e=p.unescapeHash(e)},p.setTitle=function(t){var e,i=t.title;i||(e=p.getStateByIndex(0),e&&e.url===t.url&&(i=e.title||p.options.initialTitle));try{r.getElementsByTagName("title")[0].innerHTML=i.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(n){}return r.title=i,p},p.queues=[],p.busy=function(t){if("undefined"!=typeof t?p.busy.flag=t:"undefined"==typeof p.busy.flag&&(p.busy.flag=!1),!p.busy.flag){l(p.busy.timeout);var e=function(){var t,i,n;if(!p.busy.flag)for(t=p.queues.length-1;t>=0;--t)i=p.queues[t],0!==i.length&&(n=i.shift(),p.fireQueueItem(n),p.busy.timeout=s(e,p.options.busyDelay))};p.busy.timeout=s(e,p.options.busyDelay)}return p.busy.flag},p.busy.flag=!1,p.fireQueueItem=function(t){return t.callback.apply(t.scope||p,t.args||[])},p.pushQueue=function(t){return p.queues[t.queue||0]=p.queues[t.queue||0]||[],p.queues[t.queue||0].push(t),p},p.queue=function(t,e){return"function"==typeof t&&(t={callback:t}),"undefined"!=typeof e&&(t.queue=e),p.busy()?p.pushQueue(t):p.fireQueueItem(t),p},p.clearQueue=function(){return p.busy.flag=!1,p.queues=[],p},p.stateChanged=!1,p.doubleChecker=!1,p.doubleCheckComplete=function(){return p.stateChanged=!0,p.doubleCheckClear(),p},p.doubleCheckClear=function(){return p.doubleChecker&&(l(p.doubleChecker),p.doubleChecker=!1),p},p.doubleCheck=function(t){return p.stateChanged=!1,p.doubleCheckClear(),p.bugs.ieDoubleCheck&&(p.doubleChecker=s(function(){return p.doubleCheckClear(),p.stateChanged||t(),!0},p.options.doubleCheckInterval)),p},p.safariStatePoll=function(){var t,e=p.extractState(p.getLocationHref());if(!p.isLastSavedState(e))return t=e,t||(t=p.createStateObject()),p.Adapter.trigger(window,"popstate"),p},p.back=function(t){return t!==!1&&p.busy()?(p.pushQueue({scope:p,callback:p.back,args:arguments,queue:t}),!1):(p.busy(!0),p.doubleCheck(function(){p.back(!1)}),f.go(-1),!0)},p.forward=function(t){return t!==!1&&p.busy()?(p.pushQueue({scope:p,callback:p.forward,args:arguments,queue:t}),!1):(p.busy(!0),p.doubleCheck(function(){p.forward(!1)}),f.go(1),!0)},p.go=function(t,e){var i;if(t>0)for(i=1;t>=i;++i)p.forward(e);else{if(!(0>t))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(i=-1;i>=t;--i)p.back(e)}return p},p.emulated.pushState){var e=function(){};p.pushState=p.pushState||e,p.replaceState=p.replaceState||e}else p.onPopState=function(t,e){var i,n,r=!1,o=!1;return p.doubleCheckComplete(),(i=p.getHash())?(n=p.extractState(i||p.getLocationHref(),!0),n?p.replaceState(n.data,n.title,n.url,!1):(p.Adapter.trigger(window,"anchorchange"),p.busy(!1)),p.expectedStateId=!1,!1):(r=p.Adapter.extractEventData("state",t,e)||!1,o=r?p.getStateById(r):p.expectedStateId?p.getStateById(p.expectedStateId):p.extractState(p.getLocationHref()),o||(o=p.createStateObject(null,null,p.getLocationHref())),p.expectedStateId=!1,p.isLastSavedState(o)?(p.busy(!1),!1):(p.storeState(o),p.saveState(o),p.setTitle(o),p.Adapter.trigger(window,"statechange"),p.busy(!1),!0))},p.Adapter.bind(window,"popstate",p.onPopState),p.pushState=function(t,e,i,n){if(p.getHashByUrl(i)&&p.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(n!==!1&&p.busy())return p.pushQueue({scope:p,callback:p.pushState,args:arguments,queue:n}),!1;p.busy(!0);var r=p.createStateObject(t,e,i);return p.isLastSavedState(r)?p.busy(!1):(p.storeState(r),p.expectedStateId=r.id,f.pushState(r.id,r.title,r.url),p.Adapter.trigger(window,"popstate")),!0},p.replaceState=function(t,e,i,n){if(p.getHashByUrl(i)&&p.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(n!==!1&&p.busy())return p.pushQueue({scope:p,callback:p.replaceState,args:arguments,queue:n}),!1;p.busy(!0);var r=p.createStateObject(t,e,i);return p.isLastSavedState(r)?p.busy(!1):(p.storeState(r),p.expectedStateId=r.id,f.replaceState(r.id,r.title,r.url),p.Adapter.trigger(window,"popstate")),!0};if(a){try{p.store=h.parse(a.getItem("History.store"))||{}}catch(i){p.store={}}p.normalizeStore()}else p.store={},p.normalizeStore();p.Adapter.bind(window,"unload",p.clearAllIntervals),p.saveState(p.storeState(p.extractState(p.getLocationHref(),!0))),a&&(p.onUnload=function(){var t,e,i;try{t=h.parse(a.getItem("History.store"))||{}}catch(n){t={}}t.idToState=t.idToState||{},t.urlToId=t.urlToId||{},t.stateToId=t.stateToId||{};for(e in p.idToState)p.idToState.hasOwnProperty(e)&&(t.idToState[e]=p.idToState[e]);for(e in p.urlToId)p.urlToId.hasOwnProperty(e)&&(t.urlToId[e]=p.urlToId[e]);for(e in p.stateToId)p.stateToId.hasOwnProperty(e)&&(t.stateToId[e]=p.stateToId[e]);p.store=t,p.normalizeStore(),i=h.stringify(t);try{a.setItem("History.store",i)}catch(r){if(r.code!==DOMException.QUOTA_EXCEEDED_ERR)throw r;a.length&&(a.removeItem("History.store"),a.setItem("History.store",i))}},p.isInternetExplorer()&&p.intervalList.push(u(p.onUnload,p.options.storeInterval)),p.Adapter.bind(window,"beforeunload",p.onUnload),p.Adapter.bind(window,"unload",p.onUnload)),p.emulated.pushState||(p.bugs.safariPoll&&p.intervalList.push(u(p.safariStatePoll,p.options.safariPollInterval)),("Apple Computer, Inc."===o.vendor||"Mozilla"===(o.appCodeName||""))&&(p.Adapter.bind(window,"hashchange",function(){p.Adapter.trigger(window,"popstate")}),p.getHash()&&p.Adapter.onDomLoad(function(){p.Adapter.trigger(window,"hashchange")})))},p.options&&p.options.delayInit||p.init()),e.exports=p},{"./history-adapter":57}],59:[function(t,e,i){!function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var n=(new Date).getTime(),r=Math.max(0,16-(n-t)),o=window.setTimeout(function(){e(n+r)},r);return t=n+r,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),e.exports={}},{}],60:[function(t,e,i){var n=t("prime"),r=t("mout/lang/deepClone"),o=new n({constructor:function(t){t=r(t),this.setSession(t)},setSession:function(t){return t=t?{time:+new Date,data:r(t)}:{},this.session=t,this.session},getTime:function(){return this.session.time},getData:function(){return this.session.data},getSession:function(){return this.session},getDiff:function(t){return t}});e.exports=o},{"mout/lang/deepClone":174,prime:257}],61:[function(t,e,i){"use strict";var n=t("prime"),r=t("prime/emitter"),o=t("mout/lang/isObject"),a=t("mout/lang/isString"),s=t("mout/lang/isArray"),l=t("mout/lang/isFunction"),u=t("mout/string/trim"),c=t("mout/string/upperCase"),h=t("mout/object/forIn"),d=t("mout/object/mixIn"),p=t("mout/array/remove"),f=t("mout/array/forEach"),m=function(t){return t.replace(/\b[a-z]/g,c)},g=function(){var t=function(){return new XMLHttpRequest},e=function(){return new ActiveXObject("MSXML2.XMLHTTP")},i=function(){return new ActiveXObject("Microsoft.XMLHTTP")};try{return t(),t}catch(n){}try{return e(),e}catch(n){}try{return i(),i}catch(n){}return null}(),v=function(t){return null==t?"":t.toJSON?t.toJSON():JSON.stringify(t)},b=function(t,e){if(null==t)return"";if(t.toQueryString)return t.toQueryString();var i=[];return h(t,function(t,n){e&&(n=e+"["+n+"]");var r;if(null!=t){if(s(t)){for(var a={},l=0;l<t.length;l++)a[l]=t[l];r=b(a,n)}else r=o(t)?b(t,n):n+"="+encodeURIComponent(t);i.push(r)}}),i.join("&")},y=JSON.parse,w=function(t){for(var e=t.split("&"),i={},n=0;n<e.length;n++){var r=e[n].split("="),o=decodeURIComponent(r[0]),a=decodeURIComponent(r[1]),s=/\[\]$/.test(o),l=o.match(/^(.+)\[([^\]]+)\]$/);if(l){o=l[1];var u=l[2];i[o]=i[o]||{},i[o][u]=a}else s?(o=o.substring(0,o.length-2),i[o]=i[o]||[],i[o].push(a)):i[o]=a}return i},k={"application/json":v,"application/x-www-form-urlencoded":b},x={"application/json":y,"application/x-www-form-urlencoded":w},S=function(t){var e=t.split(/\r?\n/),i={};e.pop();for(var n=0,r=e.length;r>n;++n){var o=e[n],a=o.indexOf(":"),s=m(o.slice(0,a)),l=u(o.slice(a+1));i[s]=l}return i},C=0,E=[],T=n({constructor:function(){this._header={"Content-Type":"application/x-www-form-urlencoded"}},header:function(t,e){if(o(t))for(var i in t)this.header(i,t[i]);else{if(!arguments.length)return this._header;if(1===arguments.length)return this._header[m(t)];2===arguments.length&&(null==e?delete this._header[m(t)]:this._header[m(t)]=e)}return this},running:function(){return!!this._running},abort:function(){return this._queued&&(p(E,this._queued),delete this._queued),this._xhr&&(this._xhr.abort(),this._end()),this},method:function(t){return arguments.length?(this._method=t.toUpperCase(),this):this._method},data:function(t){return arguments.length?(this._data=t,this):this._data},url:function(t){return arguments.length?(this._url=t,this):this._url},user:function(t){return arguments.length?(this._user=t,this):this._user},password:function(t){return arguments.length?(this._password=t,this):this._password},_send:function(t,e,i,n,r,o,a){var s=this;if(C===z.MAX_REQUESTS)return E.unshift(this._queued=function(){delete s._queued,s._send(t,e,i,n,r,o,a)});C++;var l=this._xhr=z.getRequest();l.addEventListener&&f(["progress","load","error","abort","loadend"],function(t){l.addEventListener(t,function(e){s.emit(t,e)},!1)}),l.open(t,e,!0,r,o),null!=r&&"withCredentials"in l&&(l.withCredentials=!0),l.onreadystatechange=function(){if(4===l.readyState){var i=l.status,n=new O(l.responseText,i,S(l.getAllResponseHeaders())),r=n.error?new Error(t+" "+e+" "+i):null;s._end(),a(r,n)}};for(var u in n)l.setRequestHeader(u,n[u]);l.send(i||null)},_end:function(){this._xhr.onreadystatechange=function(){},delete this._xhr,delete this._running,C--;var t=E.pop();t&&t()},send:function(t){this._running&&this.abort(),this._running=!0,t||(t=function(){});var e=this._method||"POST",i=this._data||null,n=this._url,r=this._user||null,o=this._password||null;if(i&&!a(i)){var s=this._header["Content-Type"].split(/ *; */).shift(),l=k[s];l&&(i=l(i))}/GET|HEAD/.test(e)&&i&&(n+=(n.indexOf("?")>-1?"&":"?")+i);var u=d({},this._header);return this._send(e,n,i,u,r,o,t),this}});T.implement(new r);var O=n({constructor:function(t,e,i){this.text=t,this.status=e,this.header=i;var n=e/100|0;this.info=1===n,this.ok=2===n,this.clientError=4===n,this.serverError=5===n,this.error=4===n||5===n;var r=""+i["Content-Length"];this.accepted=202===e,this.noContent="0"===r||204===e||1223===e,this.badRequest=400===e,this.unauthorized=401===e,this.notAcceptable=406===e,this.notFound=404===e;var o,a=i["Content-Type"]?i["Content-Type"].split(/ *; */).shift():"";this.noContent||(o=x[a]),this.body=o?o(this.text):this.text}}),I="get|post|put|delete|head|patch|options",A=new RegExp("^"+I+"$","i"),z=function(t,e,i,n){var r=new T;return arguments.length?(A.test(t)||(n=i,i=e,e=t,t="post"),l(i)&&(n=i,i=null),r.method(t),e&&r.url(e),i&&r.data(i),n&&r.send(n),r):r};z.encoder=function(t,e){return 1===arguments.length?k[t]:(k[t]=e,z)},z.decoder=function(t,e){return 1===arguments.length?x[t]:(x[t]=e,z)},f(I.split("|"),function(t){z[t]=function(e,i,n){return z(t,e,i,n)}}),z.MAX_REQUESTS=1/0,z.getRequest=g,z.Request=T,z.Response=O,e.exports=z},{"mout/array/forEach":62,"mout/array/remove":64,"mout/lang/isArray":65,"mout/lang/isFunction":66,"mout/lang/isObject":68,"mout/lang/isString":69,"mout/object/forIn":72,"mout/object/mixIn":75,"mout/string/trim":79,"mout/string/upperCase":80,prime:257,"prime/emitter":256}],62:[function(t,e,i){function n(t,e,i){if(null!=t)for(var n=-1,r=t.length;++n<r&&e.call(i,t[n],n,t)!==!1;);}e.exports=n},{}],63:[function(t,e,i){function n(t,e,i){if(i=i||0,null==t)return-1;for(var n=t.length,r=0>i?n+i:i;n>r;){if(t[r]===e)return r;r++}return-1}e.exports=n},{}],64:[function(t,e,i){function n(t,e){var i=r(t,e);-1!==i&&t.splice(i,1)}var r=t("./indexOf");e.exports=n},{"./indexOf":63}],65:[function(t,e,i){var n=t("./isKind"),r=Array.isArray||function(t){return n(t,"Array")};e.exports=r},{"./isKind":67}],66:[function(t,e,i){function n(t){return r(t,"Function")}var r=t("./isKind");e.exports=n},{"./isKind":67}],67:[function(t,e,i){function n(t,e){return r(t)===e}var r=t("./kindOf");e.exports=n},{"./kindOf":70}],68:[function(t,e,i){function n(t){return r(t,"Object")}var r=t("./isKind");e.exports=n},{"./isKind":67}],69:[function(t,e,i){function n(t){return r(t,"String")}var r=t("./isKind");e.exports=n},{"./isKind":67}],70:[function(t,e,i){function n(t){return null===t?"Null":t===r?"Undefined":o.exec(a.call(t))[1]}var r,o=/^\[object (.*)\]$/,a=Object.prototype.toString;e.exports=n},{}],71:[function(t,e,i){function n(t){return null==t?"":t.toString()}e.exports=n},{}],72:[function(t,e,i){function n(){s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=!0;for(var t in{toString:null})a=!1}function r(t,e,i){var r,u=0;null==a&&n();for(r in t)if(o(e,t,r,i)===!1)break;if(a)for(var c=t.constructor,h=!!c&&t===c.prototype;(r=s[u++])&&("constructor"===r&&(h||!l(t,r))||t[r]===Object.prototype[r]||o(e,t,r,i)!==!1););}function o(t,e,i,n){return t.call(n,e[i],i,e)}var a,s,l=t("./hasOwn");e.exports=r},{"./hasOwn":74}],73:[function(t,e,i){function n(t,e,i){o(t,function(n,o){return r(t,o)?e.call(i,t[o],o,t):void 0})}var r=t("./hasOwn"),o=t("./forIn");e.exports=n},{"./forIn":72,"./hasOwn":74}],74:[function(t,e,i){function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=n},{}],75:[function(t,e,i){function n(t,e){for(var i,n=0,a=arguments.length;++n<a;)i=arguments[n],null!=i&&o(i,r,t);return t}function r(t,e){this[e]=t}var o=t("./forOwn");e.exports=n},{"./forOwn":73}],76:[function(t,e,i){e.exports=[" ","\n","\r","	","\f","","","","","","","","","","","","","","","","\u2028","\u2029","","",""]},{}],77:[function(t,e,i){function n(t,e){t=r(t),e=e||o;for(var i,n,a=0,s=t.length,l=e.length,u=!0;u&&s>a;)for(u=!1,i=-1,n=t.charAt(a);++i<l;)if(n===e[i]){u=!0,a++;break}return a>=s?"":t.substr(a,s)}var r=t("../lang/toString"),o=t("./WHITE_SPACES");e.exports=n},{"../lang/toString":71,"./WHITE_SPACES":76}],78:[function(t,e,i){function n(t,e){t=r(t),e=e||o;for(var i,n,a=t.length-1,s=e.length,l=!0;l&&a>=0;)for(l=!1,i=-1,n=t.charAt(a);++i<s;)if(n===e[i]){l=!0,a--;break}return a>=0?t.substring(0,a+1):""}var r=t("../lang/toString"),o=t("./WHITE_SPACES");e.exports=n},{"../lang/toString":71,"./WHITE_SPACES":76}],79:[function(t,e,i){function n(t,e){return t=r(t),e=e||o,a(s(t,e),e)}var r=t("../lang/toString"),o=t("./WHITE_SPACES"),a=t("./ltrim"),s=t("./rtrim");e.exports=n},{"../lang/toString":71,"./WHITE_SPACES":76,"./ltrim":77,"./rtrim":78}],80:[function(t,e,i){function n(t){return t=r(t),t.toUpperCase()}var r=t("../lang/toString");e.exports=n},{"../lang/toString":71}],81:[function(t,e,i){(function(t){!function(){function i(t){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,t.apply(n,arguments)}}var n,r,o={};n=this,null!=n&&(r=n.async),o.noConflict=function(){return n.async=r,o};var a=Object.prototype.toString,s=Array.isArray||function(t){return"[object Array]"===a.call(t)},l=function(t,e){if(t.forEach)return t.forEach(e);for(var i=0;i<t.length;i+=1)e(t[i],i,t)},u=function(t,e){if(t.map)return t.map(e);var i=[];return l(t,function(t,n,r){i.push(e(t,n,r))}),i},c=function(t,e,i){return t.reduce?t.reduce(e,i):(l(t,function(t,n,r){i=e(i,t,n,r)}),i)},h=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e};"undefined"!=typeof t&&t.nextTick?(o.nextTick=t.nextTick,o.setImmediate="undefined"!=typeof setImmediate?function(t){setImmediate(t)}:o.nextTick):"function"==typeof setImmediate?(o.nextTick=function(t){setImmediate(t)},o.setImmediate=o.nextTick):(o.nextTick=function(t){setTimeout(t,0)},o.setImmediate=o.nextTick),o.each=function(t,e,n){function r(e){e?(n(e),n=function(){}):(o+=1,o>=t.length&&n())}if(n=n||function(){},!t.length)return n();var o=0;l(t,function(t){e(t,i(r))})},o.forEach=o.each,o.eachSeries=function(t,e,i){if(i=i||function(){},!t.length)return i();var n=0,r=function(){e(t[n],function(e){e?(i(e),i=function(){}):(n+=1,n>=t.length?i():r())})};r()},o.forEachSeries=o.eachSeries,o.eachLimit=function(t,e,i,n){var r=d(e);r.apply(null,[t,i,n])},o.forEachLimit=o.eachLimit;var d=function(t){return function(e,i,n){if(n=n||function(){},!e.length||0>=t)return n();var r=0,o=0,a=0;!function s(){if(r>=e.length)return n();for(;t>a&&o<e.length;)o+=1,a+=1,i(e[o-1],function(t){t?(n(t),n=function(){}):(r+=1,a-=1,r>=e.length?n():s())})}()}},p=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[o.each].concat(e))}},f=function(t,e){return function(){var i=Array.prototype.slice.call(arguments);return e.apply(null,[d(t)].concat(i))}},m=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[o.eachSeries].concat(e))}},g=function(t,e,i,n){if(e=u(e,function(t,e){return{index:e,value:t}}),n){var r=[];t(e,function(t,e){i(t.value,function(i,n){r[t.index]=n,e(i)})},function(t){n(t,r)})}else t(e,function(t,e){i(t.value,function(t){e(t)})})};o.map=p(g),o.mapSeries=m(g),o.mapLimit=function(t,e,i,n){return v(e)(t,i,n)};var v=function(t){return f(t,g)};o.reduce=function(t,e,i,n){o.eachSeries(t,function(t,n){i(e,t,function(t,i){e=i,n(t)})},function(t){n(t,e)})},o.inject=o.reduce,o.foldl=o.reduce,o.reduceRight=function(t,e,i,n){var r=u(t,function(t){return t}).reverse();o.reduce(r,e,i,n)},o.foldr=o.reduceRight;var b=function(t,e,i,n){var r=[];e=u(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){i(t.value,function(i){i&&r.push(t),e()})},function(t){n(u(r.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};o.filter=p(b),o.filterSeries=m(b),o.select=o.filter,o.selectSeries=o.filterSeries;var y=function(t,e,i,n){var r=[];e=u(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){i(t.value,function(i){i||r.push(t),e()})},function(t){n(u(r.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};o.reject=p(y),o.rejectSeries=m(y);var w=function(t,e,i,n){t(e,function(t,e){i(t,function(i){i?(n(t),n=function(){}):e()})},function(t){n()})};o.detect=p(w),o.detectSeries=m(w),o.some=function(t,e,i){o.each(t,function(t,n){e(t,function(t){t&&(i(!0),i=function(){}),n()})},function(t){i(!1)})},o.any=o.some,
o.every=function(t,e,i){o.each(t,function(t,n){e(t,function(t){t||(i(!1),i=function(){}),n()})},function(t){i(!0)})},o.all=o.every,o.sortBy=function(t,e,i){o.map(t,function(t,i){e(t,function(e,n){e?i(e):i(null,{value:t,criteria:n})})},function(t,e){if(t)return i(t);var n=function(t,e){var i=t.criteria,n=e.criteria;return n>i?-1:i>n?1:0};i(null,u(e.sort(n),function(t){return t.value}))})},o.auto=function(t,e){e=e||function(){};var i=h(t),n=i.length;if(!n)return e();var r={},a=[],u=function(t){a.unshift(t)},d=function(t){for(var e=0;e<a.length;e+=1)if(a[e]===t)return void a.splice(e,1)},p=function(){n--,l(a.slice(0),function(t){t()})};u(function(){if(!n){var t=e;e=function(){},t(null,r)}}),l(i,function(i){var n=s(t[i])?t[i]:[t[i]],a=function(t){var n=Array.prototype.slice.call(arguments,1);if(n.length<=1&&(n=n[0]),t){var a={};l(h(r),function(t){a[t]=r[t]}),a[i]=n,e(t,a),e=function(){}}else r[i]=n,o.setImmediate(p)},f=n.slice(0,Math.abs(n.length-1))||[],m=function(){return c(f,function(t,e){return t&&r.hasOwnProperty(e)},!0)&&!r.hasOwnProperty(i)};if(m())n[n.length-1](a,r);else{var g=function(){m()&&(d(g),n[n.length-1](a,r))};u(g)}})},o.retry=function(t,e,i){var n=5,r=[];"function"==typeof t&&(i=e,e=t,t=n),t=parseInt(t,10)||n;var a=function(n,a){for(var s=function(t,e){return function(i){t(function(t,n){i(!t||e,{err:t,result:n})},a)}};t;)r.push(s(e,!(t-=1)));o.series(r,function(t,e){e=e[e.length-1],(n||i)(e.err,e.result)})};return i?a():a},o.waterfall=function(t,e){if(e=e||function(){},!s(t)){var i=new Error("First argument to waterfall must be an array of functions");return e(i)}if(!t.length)return e();var n=function(t){return function(i){if(i)e.apply(null,arguments),e=function(){};else{var r=Array.prototype.slice.call(arguments,1),a=t.next();r.push(a?n(a):e),o.setImmediate(function(){t.apply(null,r)})}}};n(o.iterator(t))()};var k=function(t,e,i){if(i=i||function(){},s(e))t.map(e,function(t,e){t&&t(function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),e.call(null,t,i)})},i);else{var n={};t.each(h(e),function(t,i){e[t](function(e){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),n[t]=r,i(e)})},function(t){i(t,n)})}};o.parallel=function(t,e){k({map:o.map,each:o.each},t,e)},o.parallelLimit=function(t,e,i){k({map:v(e),each:d(e)},t,i)},o.series=function(t,e){if(e=e||function(){},s(t))o.mapSeries(t,function(t,e){t&&t(function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),e.call(null,t,i)})},e);else{var i={};o.eachSeries(h(t),function(e,n){t[e](function(t){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),i[e]=r,n(t)})},function(t){e(t,i)})}},o.iterator=function(t){var e=function(i){var n=function(){return t.length&&t[i].apply(null,arguments),n.next()};return n.next=function(){return i<t.length-1?e(i+1):null},n};return e(0)},o.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var x=function(t,e,i,n){var r=[];t(e,function(t,e){i(t,function(t,i){r=r.concat(i||[]),e(t)})},function(t){n(t,r)})};o.concat=p(x),o.concatSeries=m(x),o.whilst=function(t,e,i){t()?e(function(n){return n?i(n):void o.whilst(t,e,i)}):i()},o.doWhilst=function(t,e,i){t(function(n){if(n)return i(n);var r=Array.prototype.slice.call(arguments,1);e.apply(null,r)?o.doWhilst(t,e,i):i()})},o.until=function(t,e,i){t()?i():e(function(n){return n?i(n):void o.until(t,e,i)})},o.doUntil=function(t,e,i){t(function(n){if(n)return i(n);var r=Array.prototype.slice.call(arguments,1);e.apply(null,r)?i():o.doUntil(t,e,i)})},o.queue=function(t,e){function n(t,e,i,n){return t.started||(t.started=!0),s(e)||(e=[e]),0==e.length?o.setImmediate(function(){t.drain&&t.drain()}):void l(e,function(e){var r={data:e,callback:"function"==typeof n?n:null};i?t.tasks.unshift(r):t.tasks.push(r),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),o.setImmediate(t.process)})}void 0===e&&(e=1);var r=0,a={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(t,e){n(a,t,!1,e)},kill:function(){a.drain=null,a.tasks=[]},unshift:function(t,e){n(a,t,!0,e)},process:function(){if(!a.paused&&r<a.concurrency&&a.tasks.length){var e=a.tasks.shift();a.empty&&0===a.tasks.length&&a.empty(),r+=1;var n=function(){r-=1,e.callback&&e.callback.apply(e,arguments),a.drain&&a.tasks.length+r===0&&a.drain(),a.process()},o=i(n);t(e.data,o)}},length:function(){return a.tasks.length},running:function(){return r},idle:function(){return a.tasks.length+r===0},pause:function(){a.paused!==!0&&(a.paused=!0,a.process())},resume:function(){a.paused!==!1&&(a.paused=!1,a.process())}};return a},o.priorityQueue=function(t,e){function i(t,e){return t.priority-e.priority}function n(t,e,i){for(var n=-1,r=t.length-1;r>n;){var o=n+(r-n+1>>>1);i(e,t[o])>=0?n=o:r=o-1}return n}function r(t,e,r,a){return t.started||(t.started=!0),s(e)||(e=[e]),0==e.length?o.setImmediate(function(){t.drain&&t.drain()}):void l(e,function(e){var s={data:e,priority:r,callback:"function"==typeof a?a:null};t.tasks.splice(n(t.tasks,s,i)+1,0,s),t.saturated&&t.tasks.length===t.concurrency&&t.saturated(),o.setImmediate(t.process)})}var a=o.queue(t,e);return a.push=function(t,e,i){r(a,t,e,i)},delete a.unshift,a},o.cargo=function(t,e){var i=!1,n=[],r={tasks:n,payload:e,saturated:null,empty:null,drain:null,drained:!0,push:function(t,i){s(t)||(t=[t]),l(t,function(t){n.push({data:t,callback:"function"==typeof i?i:null}),r.drained=!1,r.saturated&&n.length===e&&r.saturated()}),o.setImmediate(r.process)},process:function a(){if(!i){if(0===n.length)return r.drain&&!r.drained&&r.drain(),void(r.drained=!0);var o="number"==typeof e?n.splice(0,e):n.splice(0,n.length),s=u(o,function(t){return t.data});r.empty&&r.empty(),i=!0,t(s,function(){i=!1;var t=arguments;l(o,function(e){e.callback&&e.callback.apply(null,t)}),a()})}},length:function(){return n.length},running:function(){return i}};return r};var S=function(t){return function(e){var i=Array.prototype.slice.call(arguments,1);e.apply(null,i.concat([function(e){var i=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[t]&&l(i,function(e){console[t](e)}))}]))}};o.log=S("log"),o.dir=S("dir"),o.memoize=function(t,e){var i={},n={};e=e||function(t){return t};var r=function(){var r=Array.prototype.slice.call(arguments),a=r.pop(),s=e.apply(null,r);s in i?o.nextTick(function(){a.apply(null,i[s])}):s in n?n[s].push(a):(n[s]=[a],t.apply(null,r.concat([function(){i[s]=arguments;var t=n[s];delete n[s];for(var e=0,r=t.length;r>e;e++)t[e].apply(null,arguments)}])))};return r.memo=i,r.unmemoized=t,r},o.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},o.times=function(t,e,i){for(var n=[],r=0;t>r;r++)n.push(r);return o.map(n,e,i)},o.timesSeries=function(t,e,i){for(var n=[],r=0;t>r;r++)n.push(r);return o.mapSeries(n,e,i)},o.seq=function(){var t=arguments;return function(){var e=this,i=Array.prototype.slice.call(arguments),n=i.pop();o.reduce(t,i,function(t,i,n){i.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);n(t,e)}]))},function(t,i){n.apply(e,[t].concat(i))})}},o.compose=function(){return o.seq.apply(null,Array.prototype.reverse.call(arguments))};var C=function(t,e){var i=function(){var i=this,n=Array.prototype.slice.call(arguments),r=n.pop();return t(e,function(t,e){t.apply(i,n.concat([e]))},r)};if(arguments.length>2){var n=Array.prototype.slice.call(arguments,2);return i.apply(this,n)}return i};o.applyEach=p(C),o.applyEachSeries=m(C),o.forever=function(t,e){function i(n){if(n){if(e)return e(n);throw n}t(i)}i()},"undefined"!=typeof e&&e.exports?e.exports=o:"undefined"!=typeof define&&define.amd?define([],function(){return o}):n.async=o}()}).call(this,t("_process"))},{_process:2}],82:[function(t,e,i){(function(){var t,i,n,r,o,a,s,l,u=[].slice,c={}.hasOwnProperty,h=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};s=function(){},i=function(){function t(){}return t.prototype.addEventListener=t.prototype.on,t.prototype.on=function(t,e){return this._callbacks=this._callbacks||{},this._callbacks[t]||(this._callbacks[t]=[]),this._callbacks[t].push(e),this},t.prototype.emit=function(){var t,e,i,n,r,o;if(n=arguments[0],t=2<=arguments.length?u.call(arguments,1):[],this._callbacks=this._callbacks||{},i=this._callbacks[n])for(r=0,o=i.length;o>r;r++)e=i[r],e.apply(this,t);return this},t.prototype.removeListener=t.prototype.off,t.prototype.removeAllListeners=t.prototype.off,t.prototype.removeEventListener=t.prototype.off,t.prototype.off=function(t,e){var i,n,r,o,a;if(!this._callbacks||0===arguments.length)return this._callbacks={},this;if(n=this._callbacks[t],!n)return this;if(1===arguments.length)return delete this._callbacks[t],this;for(r=o=0,a=n.length;a>o;r=++o)if(i=n[r],i===e){n.splice(r,1);break}return this},t}(),t=function(t){function e(t,i){var r,o,a;if(this.element=t,this.version=e.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(e.instances.push(this),this.element.dropzone=this,r=null!=(a=e.optionsForElement(this.element))?a:{},this.options=n({},this.defaultOptions,r,null!=i?i:{}),this.options.forceFallback||!e.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(o=this.getExistingFallback())&&o.parentNode&&o.parentNode.removeChild(o),this.options.previewsContainer!==!1&&(this.previewsContainer=this.options.previewsContainer?e.getElement(this.options.previewsContainer,"previewsContainer"):this.element),this.options.clickable&&(this.clickableElements=this.options.clickable===!0?[this.element]:e.getElements(this.options.clickable,"clickable")),this.init()}var n,r;return h(e,t),e.prototype.Emitter=i,e.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],e.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1e3,maxFiles:null,filesizeBase:1e3,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,capture:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(t,e){return e()},init:function(){return s},forceFallback:!1,fallback:function(){var t,i,n,r,o,a;for(this.element.className=""+this.element.className+" dz-browser-not-supported",a=this.element.getElementsByTagName("div"),r=0,o=a.length;o>r;r++)t=a[r],/(^| )dz-message($| )/.test(t.className)&&(i=t,t.className="dz-message");return i||(i=e.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(i)),n=i.getElementsByTagName("span")[0],n&&(n.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(t){var e,i,n;return e={srcX:0,srcY:0,srcWidth:t.width,srcHeight:t.height},i=t.width/t.height,e.optWidth=this.options.thumbnailWidth,e.optHeight=this.options.thumbnailHeight,null==e.optWidth&&null==e.optHeight?(e.optWidth=e.srcWidth,e.optHeight=e.srcHeight):null==e.optWidth?e.optWidth=i*e.optHeight:null==e.optHeight&&(e.optHeight=1/i*e.optWidth),n=e.optWidth/e.optHeight,t.height<e.optHeight||t.width<e.optWidth?(e.trgHeight=e.srcHeight,e.trgWidth=e.srcWidth):i>n?(e.srcHeight=t.height,e.srcWidth=e.srcHeight*n):(e.srcWidth=t.width,e.srcHeight=e.srcWidth/n),e.srcX=(t.width-e.srcWidth)/2,e.srcY=(t.height-e.srcHeight)/2,e},drop:function(t){return this.element.classList.remove("dz-drag-hover")},dragstart:s,dragend:function(t){return this.element.classList.remove("dz-drag-hover")},dragenter:function(t){return this.element.classList.add("dz-drag-hover")},dragover:function(t){return this.element.classList.add("dz-drag-hover")},dragleave:function(t){return this.element.classList.remove("dz-drag-hover")},paste:s,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(t){var i,n,r,o,a,s,l,u,c,h,d,p,f;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(t.previewElement=e.createElement(this.options.previewTemplate.trim()),t.previewTemplate=t.previewElement,this.previewsContainer.appendChild(t.previewElement),h=t.previewElement.querySelectorAll("[data-dz-name]"),o=0,l=h.length;l>o;o++)i=h[o],i.textContent=t.name;for(d=t.previewElement.querySelectorAll("[data-dz-size]"),a=0,u=d.length;u>a;a++)i=d[a],i.innerHTML=this.filesize(t.size);for(this.options.addRemoveLinks&&(t._removeLink=e.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),t.previewElement.appendChild(t._removeLink)),n=function(i){return function(n){return n.preventDefault(),n.stopPropagation(),t.status===e.UPLOADING?e.confirm(i.options.dictCancelUploadConfirmation,function(){return i.removeFile(t)}):i.options.dictRemoveFileConfirmation?e.confirm(i.options.dictRemoveFileConfirmation,function(){return i.removeFile(t)}):i.removeFile(t)}}(this),p=t.previewElement.querySelectorAll("[data-dz-remove]"),f=[],s=0,c=p.length;c>s;s++)r=p[s],f.push(r.addEventListener("click",n));return f}},removedfile:function(t){var e;return t.previewElement&&null!=(e=t.previewElement)&&e.parentNode.removeChild(t.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(t,e){var i,n,r,o;if(t.previewElement){for(t.previewElement.classList.remove("dz-file-preview"),o=t.previewElement.querySelectorAll("[data-dz-thumbnail]"),n=0,r=o.length;r>n;n++)i=o[n],i.alt=t.name,i.src=e;return setTimeout(function(e){return function(){return t.previewElement.classList.add("dz-image-preview")}}(this),1)}},error:function(t,e){var i,n,r,o,a;if(t.previewElement){for(t.previewElement.classList.add("dz-error"),"String"!=typeof e&&e.error&&(e=e.error),o=t.previewElement.querySelectorAll("[data-dz-errormessage]"),a=[],n=0,r=o.length;r>n;n++)i=o[n],a.push(i.textContent=e);return a}},errormultiple:s,processing:function(t){return t.previewElement&&(t.previewElement.classList.add("dz-processing"),t._removeLink)?t._removeLink.textContent=this.options.dictCancelUpload:void 0},processingmultiple:s,uploadprogress:function(t,e,i){var n,r,o,a,s;if(t.previewElement){for(a=t.previewElement.querySelectorAll("[data-dz-uploadprogress]"),s=[],r=0,o=a.length;o>r;r++)n=a[r],s.push("PROGRESS"===n.nodeName?n.value=e:n.style.width=""+e+"%");return s}},totaluploadprogress:s,sending:s,sendingmultiple:s,success:function(t){return t.previewElement?t.previewElement.classList.add("dz-success"):void 0},successmultiple:s,canceled:function(t){return this.emit("error",t,"Upload canceled.")},canceledmultiple:s,complete:function(t){return t._removeLink&&(t._removeLink.textContent=this.options.dictRemoveFile),t.previewElement?t.previewElement.classList.add("dz-complete"):void 0},completemultiple:s,maxfilesexceeded:s,maxfilesreached:s,queuecomplete:s,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Check</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n      </g>\n    </svg>\n  </div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Error</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>'},n=function(){var t,e,i,n,r,o,a;for(n=arguments[0],i=2<=arguments.length?u.call(arguments,1):[],o=0,a=i.length;a>o;o++){e=i[o];for(t in e)r=e[t],n[t]=r}return n},e.prototype.getAcceptedFiles=function(){var t,e,i,n,r;for(n=this.files,r=[],e=0,i=n.length;i>e;e++)t=n[e],t.accepted&&r.push(t);return r},e.prototype.getRejectedFiles=function(){var t,e,i,n,r;for(n=this.files,r=[],e=0,i=n.length;i>e;e++)t=n[e],t.accepted||r.push(t);return r},e.prototype.getFilesWithStatus=function(t){var e,i,n,r,o;for(r=this.files,o=[],i=0,n=r.length;n>i;i++)e=r[i],e.status===t&&o.push(e);return o},e.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(e.QUEUED)},e.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(e.UPLOADING)},e.prototype.getActiveFiles=function(){var t,i,n,r,o;for(r=this.files,o=[],i=0,n=r.length;n>i;i++)t=r[i],(t.status===e.UPLOADING||t.status===e.QUEUED)&&o.push(t);return o},e.prototype.init=function(){var t,i,n,r,o,a,s;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(e.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(n=function(t){return function(){return t.hiddenFileInput&&document.body.removeChild(t.hiddenFileInput),t.hiddenFileInput=document.createElement("input"),t.hiddenFileInput.setAttribute("type","file"),(null==t.options.maxFiles||t.options.maxFiles>1)&&t.hiddenFileInput.setAttribute("multiple","multiple"),t.hiddenFileInput.className="dz-hidden-input",null!=t.options.acceptedFiles&&t.hiddenFileInput.setAttribute("accept",t.options.acceptedFiles),null!=t.options.capture&&t.hiddenFileInput.setAttribute("capture",t.options.capture),t.hiddenFileInput.style.visibility="hidden",t.hiddenFileInput.style.position="absolute",t.hiddenFileInput.style.top="0",t.hiddenFileInput.style.left="0",t.hiddenFileInput.style.height="0",t.hiddenFileInput.style.width="0",document.body.appendChild(t.hiddenFileInput),t.hiddenFileInput.addEventListener("change",function(){var e,i,r,o;if(i=t.hiddenFileInput.files,i.length)for(r=0,o=i.length;o>r;r++)e=i[r],t.addFile(e);return n()})}}(this))(),this.URL=null!=(a=window.URL)?a:window.webkitURL,s=this.events,r=0,o=s.length;o>r;r++)t=s[r],this.on(t,this.options[t]);return this.on("uploadprogress",function(t){return function(){return t.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(t){return function(){return t.updateTotalUploadProgress()}}(this)),this.on("canceled",function(t){return function(e){return t.emit("complete",e)}}(this)),this.on("complete",function(t){return function(e){return 0===t.getUploadingFiles().length&&0===t.getQueuedFiles().length?setTimeout(function(){return t.emit("queuecomplete")},0):void 0}}(this)),i=function(t){return t.stopPropagation(),t.preventDefault?t.preventDefault():t.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(t){return function(e){return t.emit("dragstart",e)}}(this),dragenter:function(t){return function(e){return i(e),t.emit("dragenter",e)}}(this),dragover:function(t){return function(e){var n;try{n=e.dataTransfer.effectAllowed}catch(r){}return e.dataTransfer.dropEffect="move"===n||"linkMove"===n?"move":"copy",i(e),t.emit("dragover",e)}}(this),dragleave:function(t){return function(e){return t.emit("dragleave",e)}}(this),drop:function(t){return function(e){return i(e),t.drop(e)}}(this),dragend:function(t){return function(e){return t.emit("dragend",e)}}(this)}}],this.clickableElements.forEach(function(t){return function(i){return t.listeners.push({element:i,events:{click:function(n){return i!==t.element||n.target===t.element||e.elementInside(n.target,t.element.querySelector(".dz-message"))?t.hiddenFileInput.click():void 0}}})}}(this)),this.enable(),this.options.init.call(this)},e.prototype.destroy=function(){var t;return this.disable(),this.removeAllFiles(!0),(null!=(t=this.hiddenFileInput)?t.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,e.instances.splice(e.instances.indexOf(this),1)},e.prototype.updateTotalUploadProgress=function(){var t,e,i,n,r,o,a,s;if(n=0,i=0,t=this.getActiveFiles(),t.length){for(s=this.getActiveFiles(),o=0,a=s.length;a>o;o++)e=s[o],n+=e.upload.bytesSent,i+=e.upload.total;r=100*n/i}else r=100;return this.emit("totaluploadprogress",r,i,n)},e.prototype._getParamName=function(t){return"function"==typeof this.options.paramName?this.options.paramName(t):""+this.options.paramName+(this.options.uploadMultiple?"["+t+"]":"")},e.prototype.getFallbackForm=function(){var t,i,n,r;return(t=this.getExistingFallback())?t:(n='<div class="dz-fallback">',this.options.dictFallbackText&&(n+="<p>"+this.options.dictFallbackText+"</p>"),n+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',i=e.createElement(n),"FORM"!==this.element.tagName?(r=e.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),r.appendChild(i)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=r?r:i)},e.prototype.getExistingFallback=function(){var t,e,i,n,r,o;for(e=function(t){var e,i,n;for(i=0,n=t.length;n>i;i++)if(e=t[i],/(^| )fallback($| )/.test(e.className))return e},o=["div","form"],n=0,r=o.length;r>n;n++)if(i=o[n],t=e(this.element.getElementsByTagName(i)))return t},e.prototype.setupEventListeners=function(){var t,e,i,n,r,o,a;for(o=this.listeners,a=[],n=0,r=o.length;r>n;n++)t=o[n],a.push(function(){var n,r;n=t.events,r=[];for(e in n)i=n[e],r.push(t.element.addEventListener(e,i,!1));return r}());return a},e.prototype.removeEventListeners=function(){var t,e,i,n,r,o,a;for(o=this.listeners,a=[],n=0,r=o.length;r>n;n++)t=o[n],a.push(function(){var n,r;n=t.events,r=[];for(e in n)i=n[e],r.push(t.element.removeEventListener(e,i,!1));return r}());return a},e.prototype.disable=function(){var t,e,i,n,r;for(this.clickableElements.forEach(function(t){return t.classList.remove("dz-clickable")}),this.removeEventListeners(),n=this.files,r=[],e=0,i=n.length;i>e;e++)t=n[e],r.push(this.cancelUpload(t));return r},e.prototype.enable=function(){return this.clickableElements.forEach(function(t){return t.classList.add("dz-clickable")}),this.setupEventListeners()},e.prototype.filesize=function(t){var e,i,n,r,o,a,s,l;for(a=["TB","GB","MB","KB","b"],n=r=null,i=s=0,l=a.length;l>s;i=++s)if(o=a[i],e=Math.pow(this.options.filesizeBase,4-i)/10,t>=e){n=t/Math.pow(this.options.filesizeBase,4-i),r=o;break}return n=Math.round(10*n)/10,"<strong>"+n+"</strong> "+r},e.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},e.prototype.drop=function(t){var e,i;t.dataTransfer&&(this.emit("drop",t),e=t.dataTransfer.files,e.length&&(i=t.dataTransfer.items,i&&i.length&&null!=i[0].webkitGetAsEntry?this._addFilesFromItems(i):this.handleFiles(e)))},e.prototype.paste=function(t){var e,i;if(null!=(null!=t&&null!=(i=t.clipboardData)?i.items:void 0))return this.emit("paste",t),e=t.clipboardData.items,e.length?this._addFilesFromItems(e):void 0},e.prototype.handleFiles=function(t){var e,i,n,r;for(r=[],i=0,n=t.length;n>i;i++)e=t[i],r.push(this.addFile(e));return r},e.prototype._addFilesFromItems=function(t){var e,i,n,r,o;for(o=[],n=0,r=t.length;r>n;n++)i=t[n],o.push(null!=i.webkitGetAsEntry&&(e=i.webkitGetAsEntry())?e.isFile?this.addFile(i.getAsFile()):e.isDirectory?this._addFilesFromDirectory(e,e.name):void 0:null!=i.getAsFile?null==i.kind||"file"===i.kind?this.addFile(i.getAsFile()):void 0:void 0);return o},e.prototype._addFilesFromDirectory=function(t,e){var i,n;return i=t.createReader(),n=function(t){return function(i){var n,r,o;for(r=0,o=i.length;o>r;r++)n=i[r],n.isFile?n.file(function(i){return t.options.ignoreHiddenFiles&&"."===i.name.substring(0,1)?void 0:(i.fullPath=""+e+"/"+i.name,t.addFile(i))}):n.isDirectory&&t._addFilesFromDirectory(n,""+e+"/"+n.name)}}(this),i.readEntries(n,function(t){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(t):void 0})},e.prototype.accept=function(t,i){return t.size>1024*this.options.maxFilesize*1024?i(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(t.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):e.isValidFile(t,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(i(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",t)):this.options.accept.call(this,t,i):i(this.options.dictInvalidFileType)},e.prototype.addFile=function(t){return t.upload={progress:0,total:t.size,bytesSent:0},this.files.push(t),t.status=e.ADDED,this.emit("addedfile",t),this._enqueueThumbnail(t),this.accept(t,function(e){return function(i){return i?(t.accepted=!1,e._errorProcessing([t],i)):(t.accepted=!0,e.options.autoQueue&&e.enqueueFile(t)),e._updateMaxFilesReachedClass()}}(this))},e.prototype.enqueueFiles=function(t){var e,i,n;for(i=0,n=t.length;n>i;i++)e=t[i],this.enqueueFile(e);return null},e.prototype.enqueueFile=function(t){if(t.status!==e.ADDED||t.accepted!==!0)throw new Error("This file can't be queued because it has already been processed or was rejected.");return t.status=e.QUEUED,this.options.autoProcessQueue?setTimeout(function(t){return function(){return t.processQueue()}}(this),0):void 0},e.prototype._thumbnailQueue=[],e.prototype._processingThumbnail=!1,e.prototype._enqueueThumbnail=function(t){return this.options.createImageThumbnails&&t.type.match(/image.*/)&&t.size<=1024*this.options.maxThumbnailFilesize*1024?(this._thumbnailQueue.push(t),setTimeout(function(t){return function(){return t._processThumbnailQueue()}}(this),0)):void 0},e.prototype._processThumbnailQueue=function(){return this._processingThumbnail||0===this._thumbnailQueue.length?void 0:(this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(t){return function(){return t._processingThumbnail=!1,t._processThumbnailQueue()}}(this)))},e.prototype.removeFile=function(t){return t.status===e.UPLOADING&&this.cancelUpload(t),this.files=l(this.files,t),this.emit("removedfile",t),0===this.files.length?this.emit("reset"):void 0},e.prototype.removeAllFiles=function(t){var i,n,r,o;for(null==t&&(t=!1),o=this.files.slice(),n=0,r=o.length;r>n;n++)i=o[n],(i.status!==e.UPLOADING||t)&&this.removeFile(i);return null},e.prototype.createThumbnail=function(t,e){var i;return i=new FileReader,i.onload=function(n){return function(){return"image/svg+xml"===t.type?(n.emit("thumbnail",t,i.result),void(null!=e&&e())):n.createThumbnailFromUrl(t,i.result,e)}}(this),i.readAsDataURL(t)},e.prototype.createThumbnailFromUrl=function(t,e,i){var n;return n=document.createElement("img"),n.onload=function(e){return function(){var r,o,s,l,u,c,h,d;return t.width=n.width,t.height=n.height,s=e.options.resize.call(e,t),null==s.trgWidth&&(s.trgWidth=s.optWidth),null==s.trgHeight&&(s.trgHeight=s.optHeight),r=document.createElement("canvas"),o=r.getContext("2d"),r.width=s.trgWidth,r.height=s.trgHeight,a(o,n,null!=(u=s.srcX)?u:0,null!=(c=s.srcY)?c:0,s.srcWidth,s.srcHeight,null!=(h=s.trgX)?h:0,null!=(d=s.trgY)?d:0,s.trgWidth,s.trgHeight),l=r.toDataURL("image/png"),e.emit("thumbnail",t,l),null!=i?i():void 0}}(this),null!=i&&(n.onerror=i),n.src=e},e.prototype.processQueue=function(){var t,e,i,n;if(e=this.options.parallelUploads,i=this.getUploadingFiles().length,
t=i,!(i>=e)&&(n=this.getQueuedFiles(),n.length>0)){if(this.options.uploadMultiple)return this.processFiles(n.slice(0,e-i));for(;e>t;){if(!n.length)return;this.processFile(n.shift()),t++}}},e.prototype.processFile=function(t){return this.processFiles([t])},e.prototype.processFiles=function(t){var i,n,r;for(n=0,r=t.length;r>n;n++)i=t[n],i.processing=!0,i.status=e.UPLOADING,this.emit("processing",i);return this.options.uploadMultiple&&this.emit("processingmultiple",t),this.uploadFiles(t)},e.prototype._getFilesWithXhr=function(t){var e,i;return i=function(){var i,n,r,o;for(r=this.files,o=[],i=0,n=r.length;n>i;i++)e=r[i],e.xhr===t&&o.push(e);return o}.call(this)},e.prototype.cancelUpload=function(t){var i,n,r,o,a,s,l;if(t.status===e.UPLOADING){for(n=this._getFilesWithXhr(t.xhr),r=0,a=n.length;a>r;r++)i=n[r],i.status=e.CANCELED;for(t.xhr.abort(),o=0,s=n.length;s>o;o++)i=n[o],this.emit("canceled",i);this.options.uploadMultiple&&this.emit("canceledmultiple",n)}else((l=t.status)===e.ADDED||l===e.QUEUED)&&(t.status=e.CANCELED,this.emit("canceled",t),this.options.uploadMultiple&&this.emit("canceledmultiple",[t]));return this.options.autoProcessQueue?this.processQueue():void 0},r=function(){var t,e;return e=arguments[0],t=2<=arguments.length?u.call(arguments,1):[],"function"==typeof e?e.apply(this,t):e},e.prototype.uploadFile=function(t){return this.uploadFiles([t])},e.prototype.uploadFiles=function(t){var i,o,a,s,l,u,c,h,d,p,f,m,g,v,b,y,w,k,x,S,C,E,T,O,I,A,z,_,D,N,F,j,L,M;for(x=new XMLHttpRequest,S=0,O=t.length;O>S;S++)i=t[S],i.xhr=x;m=r(this.options.method,t),w=r(this.options.url,t),x.open(m,w,!0),x.withCredentials=!!this.options.withCredentials,b=null,a=function(e){return function(){var n,r,o;for(o=[],n=0,r=t.length;r>n;n++)i=t[n],o.push(e._errorProcessing(t,b||e.options.dictResponseError.replace("{{statusCode}}",x.status),x));return o}}(this),y=function(e){return function(n){var r,o,a,s,l,u,c,h,d;if(null!=n)for(o=100*n.loaded/n.total,a=0,u=t.length;u>a;a++)i=t[a],i.upload={progress:o,total:n.total,bytesSent:n.loaded};else{for(r=!0,o=100,s=0,c=t.length;c>s;s++)i=t[s],(100!==i.upload.progress||i.upload.bytesSent!==i.upload.total)&&(r=!1),i.upload.progress=o,i.upload.bytesSent=i.upload.total;if(r)return}for(d=[],l=0,h=t.length;h>l;l++)i=t[l],d.push(e.emit("uploadprogress",i,o,i.upload.bytesSent));return d}}(this),x.onload=function(i){return function(n){var r;if(t[0].status!==e.CANCELED&&4===x.readyState){if(b=x.responseText,x.getResponseHeader("content-type")&&~x.getResponseHeader("content-type").indexOf("application/json"))try{b=JSON.parse(b)}catch(o){n=o,b="Invalid JSON response from server."}return y(),200<=(r=x.status)&&300>r?i._finished(t,b,n):a()}}}(this),x.onerror=function(i){return function(){return t[0].status!==e.CANCELED?a():void 0}}(this),v=null!=(D=x.upload)?D:x,v.onprogress=y,u={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&n(u,this.options.headers);for(s in u)l=u[s],x.setRequestHeader(s,l);if(o=new FormData,this.options.params){N=this.options.params;for(f in N)k=N[f],o.append(f,k)}for(C=0,I=t.length;I>C;C++)i=t[C],this.emit("sending",i,x,o);if(this.options.uploadMultiple&&this.emit("sendingmultiple",t,x,o),"FORM"===this.element.tagName)for(F=this.element.querySelectorAll("input, textarea, select, button"),E=0,A=F.length;A>E;E++)if(h=F[E],d=h.getAttribute("name"),p=h.getAttribute("type"),"SELECT"===h.tagName&&h.hasAttribute("multiple"))for(j=h.options,T=0,z=j.length;z>T;T++)g=j[T],g.selected&&o.append(d,g.value);else(!p||"checkbox"!==(L=p.toLowerCase())&&"radio"!==L||h.checked)&&o.append(d,h.value);for(c=_=0,M=t.length-1;M>=0?M>=_:_>=M;c=M>=0?++_:--_)o.append(this._getParamName(c),t[c],t[c].name);return x.send(o)},e.prototype._finished=function(t,i,n){var r,o,a;for(o=0,a=t.length;a>o;o++)r=t[o],r.status=e.SUCCESS,this.emit("success",r,i,n),this.emit("complete",r);return this.options.uploadMultiple&&(this.emit("successmultiple",t,i,n),this.emit("completemultiple",t)),this.options.autoProcessQueue?this.processQueue():void 0},e.prototype._errorProcessing=function(t,i,n){var r,o,a;for(o=0,a=t.length;a>o;o++)r=t[o],r.status=e.ERROR,this.emit("error",r,i,n),this.emit("complete",r);return this.options.uploadMultiple&&(this.emit("errormultiple",t,i,n),this.emit("completemultiple",t)),this.options.autoProcessQueue?this.processQueue():void 0},e}(i),t.version="4.0.1",t.options={},t.optionsForElement=function(e){return e.getAttribute("id")?t.options[n(e.getAttribute("id"))]:void 0},t.instances=[],t.forElement=function(t){if("string"==typeof t&&(t=document.querySelector(t)),null==(null!=t?t.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return t.dropzone},t.autoDiscover=!0,t.discover=function(){var e,i,n,r,o,a;for(document.querySelectorAll?n=document.querySelectorAll(".dropzone"):(n=[],e=function(t){var e,i,r,o;for(o=[],i=0,r=t.length;r>i;i++)e=t[i],o.push(/(^| )dropzone($| )/.test(e.className)?n.push(e):void 0);return o},e(document.getElementsByTagName("div")),e(document.getElementsByTagName("form"))),a=[],r=0,o=n.length;o>r;r++)i=n[r],a.push(t.optionsForElement(i)!==!1?new t(i):void 0);return a},t.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],t.isBrowserSupported=function(){var e,i,n,r,o;if(e=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(o=t.blacklistedBrowsers,n=0,r=o.length;r>n;n++)i=o[n],i.test(navigator.userAgent)&&(e=!1);else e=!1;else e=!1;return e},l=function(t,e){var i,n,r,o;for(o=[],n=0,r=t.length;r>n;n++)i=t[n],i!==e&&o.push(i);return o},n=function(t){return t.replace(/[\-_](\w)/g,function(t){return t.charAt(1).toUpperCase()})},t.createElement=function(t){var e;return e=document.createElement("div"),e.innerHTML=t,e.childNodes[0]},t.elementInside=function(t,e){if(t===e)return!0;for(;t=t.parentNode;)if(t===e)return!0;return!1},t.getElement=function(t,e){var i;if("string"==typeof t?i=document.querySelector(t):null!=t.nodeType&&(i=t),null==i)throw new Error("Invalid `"+e+"` option provided. Please provide a CSS selector or a plain HTML element.");return i},t.getElements=function(t,e){var i,n,r,o,a,s,l,u;if(t instanceof Array){r=[];try{for(o=0,s=t.length;s>o;o++)n=t[o],r.push(this.getElement(n,e))}catch(c){i=c,r=null}}else if("string"==typeof t)for(r=[],u=document.querySelectorAll(t),a=0,l=u.length;l>a;a++)n=u[a],r.push(n);else null!=t.nodeType&&(r=[t]);if(null==r||!r.length)throw new Error("Invalid `"+e+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return r},t.confirm=function(t,e,i){return window.confirm(t)?e():null!=i?i():void 0},t.isValidFile=function(t,e){var i,n,r,o,a;if(!e)return!0;for(e=e.split(","),n=t.type,i=n.replace(/\/.*$/,""),o=0,a=e.length;a>o;o++)if(r=e[o],r=r.trim(),"."===r.charAt(0)){if(-1!==t.name.toLowerCase().indexOf(r.toLowerCase(),t.name.length-r.length))return!0}else if(/\/\*$/.test(r)){if(i===r.replace(/\/.*$/,""))return!0}else if(n===r)return!0;return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(e){return this.each(function(){return new t(this,e)})}),"undefined"!=typeof e&&null!==e?e.exports=t:window.Dropzone=t,t.ADDED="added",t.QUEUED="queued",t.ACCEPTED=t.QUEUED,t.UPLOADING="uploading",t.PROCESSING=t.UPLOADING,t.CANCELED="canceled",t.ERROR="error",t.SUCCESS="success",o=function(t){var e,i,n,r,o,a,s,l,u,c;for(s=t.naturalWidth,a=t.naturalHeight,i=document.createElement("canvas"),i.width=1,i.height=a,n=i.getContext("2d"),n.drawImage(t,0,0),r=n.getImageData(0,0,1,a).data,c=0,o=a,l=a;l>c;)e=r[4*(l-1)+3],0===e?o=l:c=l,l=o+c>>1;return u=l/a,0===u?1:u},a=function(t,e,i,n,r,a,s,l,u,c){var h;return h=o(e),t.drawImage(e,i,n,r,a,s,l,u,c/h)},r=function(t,e){var i,n,r,o,a,s,l,u,c;if(r=!1,c=!0,n=t.document,u=n.documentElement,i=n.addEventListener?"addEventListener":"attachEvent",l=n.addEventListener?"removeEventListener":"detachEvent",s=n.addEventListener?"":"on",o=function(i){return"readystatechange"!==i.type||"complete"===n.readyState?(("load"===i.type?t:n)[l](s+i.type,o,!1),!r&&(r=!0)?e.call(t,i.type||i):void 0):void 0},a=function(){var t;try{u.doScroll("left")}catch(e){return t=e,void setTimeout(a,50)}return o("poll")},"complete"!==n.readyState){if(n.createEventObject&&u.doScroll){try{c=!t.frameElement}catch(h){}c&&a()}return n[i](s+"DOMContentLoaded",o,!1),n[i](s+"readystatechange",o,!1),t[i](s+"load",o,!1)}},t._autoDiscoverFunction=function(){return t.autoDiscover?t.discover():void 0},r(window,t._autoDiscoverFunction)}).call(this)},{}],83:[function(t,e,i){"use strict";var n=t("./base"),r=t("mout/string/trim"),o=t("mout/array/forEach"),a=t("mout/array/filter"),s=t("mout/array/indexOf");n.implement({setAttribute:function(t,e){return this.forEach(function(i){i.setAttribute(t,e)})},getAttribute:function(t){var e=this[0].getAttributeNode(t);return e&&e.specified?e.value:null},hasAttribute:function(t){var e=this[0];if(e.hasAttribute)return e.hasAttribute(t);var i=e.getAttributeNode(t);return!(!i||!i.specified)},removeAttribute:function(t){return this.forEach(function(e){var i=e.getAttributeNode(t);i&&e.removeAttributeNode(i)})}});var l={};o(["type","value","name","href","title","id"],function(t){l[t]=function(e){return void 0!==e?this.forEach(function(i){i[t]=e}):this[0][t]}}),o(["checked","disabled","selected"],function(t){l[t]=function(e){return void 0!==e?this.forEach(function(i){i[t]=!!e}):!!this[0][t]}});var u=function(t){var e=r(t).replace(/\s+/g," ").split(" "),i={};return a(e,function(t){return""===t||i[t]?void 0:i[t]=t}).sort()};l.className=function(t){return void 0!==t?this.forEach(function(e){e.className=u(t).join(" ")}):u(this[0].className).join(" ")},n.implement({attribute:function(t,e){var i=l[t];return i?i.call(this,e):null!=e?this.setAttribute(t,e):null===e?this.removeAttribute(t):void 0===e?this.getAttribute(t):void 0}}),n.implement(l),n.implement({check:function(){return this.checked(!0)},uncheck:function(){return this.checked(!1)},disable:function(){return this.disabled(!0)},enable:function(){return this.disabled(!1)},select:function(){return this.selected(!0)},deselect:function(){return this.selected(!1)}}),n.implement({classNames:function(){return u(this[0].className)},hasClass:function(t){return s(this.classNames(),t)>-1},addClass:function(t){return this.forEach(function(e){var i=e.className,n=u(i+" "+t).join(" ");i!==n&&(e.className=n)})},removeClass:function(t){return this.forEach(function(e){var i=u(e.className);o(u(t),function(t){var e=s(i,t);e>-1&&i.splice(e,1)}),e.className=i.join(" ")})},toggleClass:function(t,e){var i=void 0!==e?e:!this.hasClass(t);return i?this.addClass(t):this.removeClass(t),!!i}}),n.prototype.toString=function(){var t=this.tag(),e=this.id(),i=this.classNames(),n=t;return e&&(n+="#"+e),i.length&&(n+="."+i.join(".")),n};var c=null==document.createElement("div").textContent?"innerText":"textContent";n.implement({tag:function(){return this[0].tagName.toLowerCase()},html:function(t){return void 0!==t?this.forEach(function(e){e.innerHTML=t}):this[0].innerHTML},text:function(t){return void 0!==t?this.forEach(function(e){e[c]=t}):this[0][c]},data:function(t,e){switch(e){case void 0:return this.getAttribute("data-"+t);case null:return this.removeAttribute("data-"+t);default:return this.setAttribute("data-"+t,e)}}}),e.exports=n},{"./base":84,"mout/array/filter":91,"mout/array/forEach":92,"mout/array/indexOf":93,"mout/string/trim":110}],84:[function(t,e,i){"use strict";var n=t("prime"),r=t("mout/array/forEach"),o=t("mout/array/map"),a=t("mout/array/filter"),s=t("mout/array/every"),l=t("mout/array/some"),u=0,c=document.__counter,h=document.__counter=(c?parseInt(c,36)+1:0).toString(36),d="uid:"+h,p=function(t){return t===window?"window":t===document?"document":t===document.documentElement?"html":t[d]||(t[d]=(u++).toString(36))},f={},m=n({constructor:function v(t,e){if(null==t)return this&&this.constructor===v?new g:null;var i,n;if(t.constructor!==g){if(i=new g,"string"==typeof t)return i.search?(i[i.length++]=e||document,i.search(t)):null;if(t.nodeType||t===window)i[i.length++]=t;else if(t.length)for(var r={},o=0,a=t.length;a>o;o++){var s=v(t[o],e);if(s&&s.length)for(var l=0,u=s.length;u>l;l++){var c=s[l];n=p(c),r[n]||(i[i.length++]=c,r[n]=!0)}}}else i=t;return i.length?1===i.length?(n=p(i[0]),f[n]||(f[n]=i)):i:null}}),g=n({inherits:m,constructor:function(){this.length=0},unlink:function(){return this.map(function(t){return delete f[p(t)],t})},forEach:function(t,e){return r(this,t,e),this},map:function(t,e){return o(this,t,e)},filter:function(t,e){return a(this,t,e)},every:function(t,e){return s(this,t,e)},some:function(t,e){return l(this,t,e)}});e.exports=m},{"mout/array/every":90,"mout/array/filter":91,"mout/array/forEach":92,"mout/array/map":94,"mout/array/some":95,prime:257}],85:[function(t,e,i){"use strict";var n=t("prime/map"),r=t("./events");t("./traversal"),r.implement({delegate:function(t,e,i,o){return this.forEach(function(a){var s=r(a),l=s._delegation||(s._delegation={}),u=l[t]||(l[t]={}),c=u[e]||(u[e]=new n);if(!c.get(i)){var h=function(t){var n,o=r(t.target||t.srcElement),a=o.matches(e)?o:o.parent(e);return a&&(n=i.call(s,t,a)),n};c.set(i,h),s.on(t,h,o)}})},undelegate:function(t,e,i,n){return this.forEach(function(o){var a,s,l,u=r(o);if((a=u._delegation)&&(s=a[t])&&(l=s[e])){var c=l.get(i);if(c){u.off(t,c,n),l.remove(c),l.count()||delete s[e];var h,d=!0,p=!0;for(h in s){d=!1;break}d&&delete a[t];for(h in a){p=!1;break}p&&delete u._delegation}}})}}),e.exports=r},{"./events":87,"./traversal":111,"prime/map":258}],86:[function(t,e,i){"use strict";var n=t("./events"),r="onreadystatechange"in document,o=!1,a=!1,s=[],l=[],u=null,c=null,h=document.createElement("div"),d=n(document),p=n(window),f=function(){if(c&&(c=clearTimeout(c)),!a){r&&d.off("readystatechange",m),d.off("DOMContentLoaded",f),p.off("load",f),a=!0;for(var t=0;u=s[t++];)u()}return a},m=function(){for(var t=l.length;t--;)if(l[t]())return f();return!1},g=function(){clearTimeout(c),m()||(c=setTimeout(g,1e3/60))};if(document.readyState){var v=function(){return!!/loaded|complete/.test(document.readyState)};l.push(v),v()?f():r?d.on("readystatechange",m):o=!0}if(h.doScroll){var b=function(){try{return h.doScroll(),!0}catch(t){}return!1};b()||(l.push(b),o=!0)}o&&g(),d.on("DOMContentLoaded",f),p.on("load",f),e.exports=function(t){return a?t():s.push(t),null}},{"./events":87}],87:[function(t,e,i){"use strict";var n=t("prime/emitter"),r=t("./base"),o=document.documentElement,a=o.addEventListener?function(t,e,i,n){return t.addEventListener(e,i,n||!1),i}:function(t,e,i){return t.attachEvent("on"+e,i),i},s=o.removeEventListener?function(t,e,i,n){t.removeEventListener(e,i,n||!1)}:function(t,e,i){t.detachEvent("on"+e,i)};r.implement({on:function(t,e,i){return this.forEach(function(o){var s=r(o),l=t+(i?":capture":"");n.prototype.on.call(s,l,e);var u=s._domListeners||(s._domListeners={});u[l]||(u[l]=a(o,t,function(t){n.prototype.emit.call(s,l,t||window.event,n.EMIT_SYNC)},i))})},off:function(t,e,i){return this.forEach(function(o){var a,l,u=r(o),c=t+(i?":capture":""),h=u._domListeners,d=u._listeners;if(h&&(a=h[c])&&d&&(l=d[c])&&(n.prototype.off.call(u,c,e),!u._listeners||!u._listeners[t])){s(o,t,a),delete h[t];for(var p in h)return;delete u._domListeners}})},emit:function(){var t=arguments;return this.forEach(function(e){n.prototype.emit.apply(r(e),t)})}}),e.exports=r},{"./base":84,"prime/emitter":256}],88:[function(t,e,i){"use strict";var n=t("./base");t("./attributes"),t("./events"),t("./insertion"),t("./traversal"),t("./delegation"),e.exports=n},{"./attributes":83,"./base":84,"./delegation":85,"./events":87,"./insertion":89,"./traversal":111}],89:[function(t,e,i){"use strict";var n=t("./base");n.implement({appendChild:function(t){return this[0].appendChild(n(t)[0]),this},insertBefore:function(t,e){return this[0].insertBefore(n(t)[0],n(e)[0]),this},removeChild:function(t){return this[0].removeChild(n(t)[0]),this},replaceChild:function(t,e){return this[0].replaceChild(n(t)[0],n(e)[0]),this}}),n.implement({before:function(t){t=n(t)[0];var e=t.parentNode;return e&&this.forEach(function(i){e.insertBefore(i,t)}),this},after:function(t){t=n(t)[0];var e=t.parentNode;return e&&this.forEach(function(i){e.insertBefore(i,t.nextSibling)}),this},bottom:function(t){return t=n(t)[0],this.forEach(function(e){t.appendChild(e)})},top:function(t){return t=n(t)[0],this.forEach(function(e){t.insertBefore(e,t.firstChild)})}}),n.implement({insert:n.prototype.bottom,remove:function(){return this.forEach(function(t){var e=t.parentNode;e&&e.removeChild(t)})},replace:function(t){return t=n(t)[0],t.parentNode.replaceChild(this[0],t),this}}),e.exports=n},{"./base":84}],90:[function(t,e,i){function n(t,e,i){e=r(e,i);var n=!0;if(null==t)return n;for(var o=-1,a=t.length;++o<a;)if(!e(t[o],o,t)){n=!1;break}return n}var r=t("../function/makeIterator_");e.exports=n},{"../function/makeIterator_":97}],91:[function(t,e,i){function n(t,e,i){e=r(e,i);var n=[];if(null==t)return n;for(var o,a=-1,s=t.length;++a<s;)o=t[a],e(o,a,t)&&n.push(o);return n}var r=t("../function/makeIterator_");e.exports=n},{"../function/makeIterator_":97}],92:[function(t,e,i){arguments[4][62][0].apply(i,arguments)},{dup:62}],93:[function(t,e,i){arguments[4][63][0].apply(i,arguments)},{dup:63}],94:[function(t,e,i){function n(t,e,i){e=r(e,i);var n=[];if(null==t)return n;for(var o=-1,a=t.length;++o<a;)n[o]=e(t[o],o,t);return n}var r=t("../function/makeIterator_");e.exports=n},{"../function/makeIterator_":97}],95:[function(t,e,i){function n(t,e,i){e=r(e,i);var n=!1;if(null==t)return n;for(var o=-1,a=t.length;++o<a;)if(e(t[o],o,t)){n=!0;break}return n}var r=t("../function/makeIterator_");e.exports=n},{"../function/makeIterator_":97}],96:[function(t,e,i){function n(t){return t}e.exports=n},{}],97:[function(t,e,i){function n(t,e){if(null==t)return r;switch(typeof t){case"function":return"undefined"!=typeof e?function(i,n,r){return t.call(e,i,n,r)}:t;case"object":return function(e){return a(e,t)};case"string":case"number":return o(t)}}var r=t("./identity"),o=t("./prop"),a=t("../object/deepMatches");e.exports=n},{"../object/deepMatches":103,"./identity":96,"./prop":98}],98:[function(t,e,i){function n(t){return function(e){return e[t]}}e.exports=n},{}],99:[function(t,e,i){arguments[4][65][0].apply(i,arguments)},{"./isKind":100,dup:65}],100:[function(t,e,i){arguments[4][67][0].apply(i,arguments)},{"./kindOf":101,dup:67}],101:[function(t,e,i){arguments[4][70][0].apply(i,arguments)},{dup:70}],102:[function(t,e,i){arguments[4][71][0].apply(i,arguments)},{dup:71}],103:[function(t,e,i){function n(t,e){for(var i=-1,n=t.length;++i<n;)if(a(t[i],e))return!0;return!1}function r(t,e){for(var i=-1,r=e.length;++i<r;)if(!n(t,e[i]))return!1;return!0}function o(t,e){var i=!0;return s(e,function(e,n){return a(t[n],e)?void 0:i=!1}),i}function a(t,e){return t&&"object"==typeof t?l(t)&&l(e)?r(t,e):o(t,e):t===e}var s=t("./forOwn"),l=t("../lang/isArray");e.exports=a},{"../lang/isArray":99,"./forOwn":105}],104:[function(t,e,i){arguments[4][72][0].apply(i,arguments)},{"./hasOwn":106,dup:72}],105:[function(t,e,i){arguments[4][73][0].apply(i,arguments)},{"./forIn":104,"./hasOwn":106,dup:73}],106:[function(t,e,i){arguments[4][74][0].apply(i,arguments)},{dup:74}],107:[function(t,e,i){arguments[4][76][0].apply(i,arguments)},{dup:76}],108:[function(t,e,i){arguments[4][77][0].apply(i,arguments)},{"../lang/toString":102,"./WHITE_SPACES":107,dup:77}],109:[function(t,e,i){arguments[4][78][0].apply(i,arguments)},{"../lang/toString":102,"./WHITE_SPACES":107,dup:78}],110:[function(t,e,i){arguments[4][79][0].apply(i,arguments)},{"../lang/toString":102,"./WHITE_SPACES":107,"./ltrim":108,"./rtrim":109,dup:79}],111:[function(t,e,i){"use strict";var n=t("mout/array/map"),r=t("slick"),o=t("./base"),a=function(t,e){return n(r.parse(e||"*"),function(e){return t+" "+e}).join(", ")},s=Array.prototype.push;o.implement({search:function(t){if(1===this.length)return o(r.search(t,this[0],new o));for(var e,i=[],n=0;e=this[n];n++)s.apply(i,r.search(t,e));return i=o(i),i&&i.sort()},find:function(t){if(1===this.length)return o(r.find(t,this[0]));for(var e,i=0;e=this[i];i++){var n=r.find(t,e);if(n)return o(n)}return null},sort:function(){return r.sort(this)},matches:function(t){return r.matches(this[0],t)},contains:function(t){return r.contains(this[0],t)},nextSiblings:function(t){return this.search(a("~",t))},nextSibling:function(t){return this.find(a("+",t))},previousSiblings:function(t){return this.search(a("!~",t))},previousSibling:function(t){return this.find(a("!+",t))},children:function(t){return this.search(a(">",t))},firstChild:function(t){return this.find(a("^",t))},lastChild:function(t){return this.find(a("!^",t))},parent:function(t){var e=[];t:for(var i,n=0;i=this[n];n++)for(;(i=i.parentNode)&&i!==document;)if(!t||r.matches(i,t)){e.push(i);break t}return o(e)},parents:function(t){for(var e,i=[],n=0;e=this[n];n++)for(;(e=e.parentNode)&&e!==document;)(!t||r.matches(e,t))&&i.push(e);return o(i)}}),e.exports=o},{"./base":84,"mout/array/map":94,slick:270}],112:[function(t,e,i){"use strict";var n=t("mout/array/forEach"),r=t("mout/array/map"),o=t("slick/parser"),a=t("./base");e.exports=function(t,e){return a(r(o(t),function(t){var i,r;return n(t,function(t,o){var s=(e||document).createElement(t.tag);if(t.id&&(s.id=t.id),t.classList&&(s.className=t.classList.join(" ")),t.attributes&&n(t.attributes,function(t){s.setAttribute(t.name,t.value||"")}),t.pseudos&&n(t.pseudos,function(t){var e=a(s),i=e[t.name];i&&i.call(e,t.value)}),0===o)r=s;else if(" "===t.combinator)i.appendChild(s);else if("+"===t.combinator){var l=i.parentNode;l&&l.appendChild(s)}i=s}),r}))}},{"./base":84,"mout/array/forEach":92,"mout/array/map":94,"slick/parser":271}],113:[function(t,e,i){"use strict";var n=t("./lib/color"),r=t("./lib/frame"),o=t("undefined"!=typeof document?"./lib/browser":"./lib/fx");o.requestFrame=function(t){return r.request(t),this},o.cancelFrame=function(t){return r.cancel(t),this},o.color=n,e.exports=o},{"./lib/browser":114,"./lib/color":115,"./lib/frame":116,"./lib/fx":117}],114:[function(t,e,i){(function(i){"use strict";var n=t("./color"),r=t("./frame"),o=(r.cancel,r.request),a=t("prime"),s=t("prime/string/camelize"),l=t("prime/string/clean"),u=t("prime/string/capitalize"),c=t("prime/string/hyphenate"),h=t("prime/array/map"),d=t("prime/array/forEach"),p=t("prime/array/indexOf"),f=t("elements"),m=t("./fx"),g=function(t,e){return String.prototype.match.call(t,e)},v={},b=function(t){return v[t]||(v[t]=c(t))},y=function(t){return Math.round(1e3*t)/1e3},w=i.getComputedStyle?function(t){var e=getComputedStyle(t,null);return function(t){return e?e.getPropertyValue(b(t)):""}}:function(t){var e=t.currentStyle;return function(t){return e?e[s(t)]:""}},k=document.createElement("div"),x="border:none;margin:none;padding:none;visibility:hidden;position:absolute;height:0;",S=function(t,e){var i=t.parentNode,n=1;return i&&(k.style.cssText=x+("width:100"+e+";"),i.appendChild(k),n=k.offsetWidth/100,i.removeChild(k)),n},C=function(t){var e=t.length;return 1===e?t.push(t[0],t[0],t[0]):2===e?t.push(t[0],t[1]):3===e&&t.push(t[1]),t},E="([-.\\d]+)(%|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vm)",T=E+"?",O="none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset|inherit",I=RegExp(E,"g"),A=RegExp(T),z=RegExp(T,"g"),_=RegExp(O),D=function(t){return null==t?"":t+""},N=function(t,e){return null==t||""===t?e?"1":"":isFinite(t=+t)?0>t?"0":t+"":"1"};try{k.style.color="rgba(0,0,0,0.5)"}catch(F){}var j=/^rgba/.test(k.style.color),L=function(t,e){var i,r="rgba(0,0,0,1)";if(!t||!(i=n(t,!0)))return e?r:"";if(e)return"rgba("+i+")";var o=i[3];return 0===o?"transparent":j&&1!==o?"rgba("+i+")":"rgb("+i.slice(0,3)+")"},M=function(t,e){if(null==t||""===t)return e?"0px":"";var i=g(t,A);return i?i[1]+(i[2]||"px"):t},P=function(t,e){if(null==t||""===t)return e?"none":"";var i=t.match(_);return i?t:e?"none":""},R=function(t,e){var i="0px none rgba(0,0,0,1)";if(null==t||""===t)return e?i:"";if(0===t||"none"===t)return e?i:t+"";var r;t=t.replace(n.x,function(t){return r=t,""});var o=t.match(_),a=t.match(z);return l([M(a?a[0]:"",e),P(o?o[0]:"",e),L(r,e)].join(" "))},B=function(t,e){return null==t||""===t?e?"0px 0px 0px 0px":"":l(C(h(l(t).split(" "),function(t){return M(t,e)})).join(" "))},$=function(t,e,i){var r="rgba(0,0,0,0)",o=3===i?r+" 0px 0px 0px":r+" 0px 0px 0px 0px";if(null==t||""===t)return e?o:"";if("none"===t)return e?o:t;var a=[],t=l(t).replace(n.x,function(t){return a.push(t),""});return h(t.split(","),function(t,n){var r=L(a[n],e),o=/inset/.test(t),s=t.match(z)||["0px"];for(s=h(s,function(t){return M(t,e)});s.length<i;)s.push("0px");var l=o?["inset",r]:[r];return l.concat(s).join(" ")}).join(", ")},H=function(t,e){return null==t||""===t?"":t.replace(n.x,function(t){return L(t,e)}).replace(I,function(t){return M(t,e)})},q={},U={},V={},W={},X=function(t){return q[t]||(q[t]=function(){var e=W[t]||t,i=V[t]||H;return function(){return i(w(this)(e),!0)}}())},Y=function(t){return U[t]||(U[t]=function(){var e=W[t]||t,i=V[t]||H;return function(t){this.style[e]=i(t,!1)}}())},G=["Top","Right","Bottom","Left"],J=["TopLeft","TopRight","BottomRight","BottomLeft"];d(G,function(t){var e="border"+t;d(["margin"+t,"padding"+t,e+"Width",t.toLowerCase()],function(t){V[t]=M}),V[e+"Color"]=L,V[e+"Style"]=P,V[e]=R,q[e]=function(){return[X(e+"Width").call(this),X(e+"Style").call(this),X(e+"Color").call(this)].join(" ")}}),d(J,function(t){V["border"+t+"Radius"]=M}),V.color=V.backgroundColor=L,V.width=V.height=V.minWidth=V.minHeight=V.maxWidth=V.maxHeight=V.fontSize=V.backgroundSize=M,d(["margin","padding"],function(t){V[t]=B,q[t]=function(){return h(G,function(e){return X(t+e).call(this)},this).join(" ")}}),V.borderWidth=B,V.borderStyle=function(t,e){return null==t||""===t?e?C(["none"]).join(" "):"":(t=l(t).split(" "),l(C(h(t,function(t){P(t,e)})).join(" ")))},V.borderColor=function(t,e){return t&&(t=g(t,n.x))?l(C(h(t,function(t){return L(t,e)})).join(" ")):e?C(["rgba(0,0,0,1)"]).join(" "):""},d(["Width","Style","Color"],function(t){q["border"+t]=function(){return h(G,function(e){return X("border"+e+t).call(this)},this).join(" ")}}),V.borderRadius=B,q.borderRadius=function(){return h(J,function(t){return X("border"+t+"Radius").call(this)},this).join(" ")},V.border=R,q.border=function(){for(var t,e=0;e<G.length;e++){var i=X("border"+G[e]).call(this);if(t&&i!==t)return null;t=i}return t},V.zIndex=D,V.opacity=N;var K=null!=k.style.MsFilter&&"MsFilter"||null!=k.style.filter&&"filter";if(K&&null==k.style.opacity){var Q=/alpha\(opacity=([\d.]+)\)/i;U.opacity=function(t){t="1"===(t=N(t))?"":"alpha(opacity="+Math.round(100*t)+")";var e=w(this)(K);return this.style[K]=Q.test(e)?e.replace(Q,t):e+" "+t},q.opacity=function(){var t=w(this)(K).match(Q);return(t?t[1]/100:1)+""}}var Z=V.boxShadow=function(t,e){return $(t,e,4)},tt=V.textShadow=function(t,e){return $(t,e,3)};d(["Webkit","Moz","ms","O",null],function(t){d(["transition","transform","transformOrigin","transformStyle","perspective","perspectiveOrigin","backfaceVisibility"],function(e){var i=t?t+u(e):e;"ms"===t&&(v[i]="-ms-"+b(e)),null!=k.style[i]&&(W[e]=i)})});var et=W.transition,it=W.transform;"OTransition"===et&&(et=null);var nt,rt;!et&&it&&function(){var e=t("./unmatrix2d"),i="\\s*([-\\d\\w.]+)\\s*",n=RegExp("matrix\\("+[i,i,i,i,i,i]+"\\)"),r=function(t){var i=e.apply(null,t.match(n).slice(1))||[[0,0],0,0,[0,0]];return["translate("+h(i[0],function(t){return y(t)+"px"})+")","rotate("+y(180*i[1]/Math.PI)+"deg)","skewX("+y(180*i[2]/Math.PI)+"deg)","scale("+h(i[3],y)+")"].join(" ")},o=function(t){return t||"0px"},s=function(t){return t||"1"},u=function(t){return t||"0deg"},c={translate:function(t){t||(t="0px,0px");var e=t.split(",");return e[1]||(e[1]="0px"),h(e,l)+""},translateX:o,translateY:o,scale:function(t){t||(t="1,1");var e=t.split(",");return e[1]||(e[1]=e[0]),h(e,l)+""},scaleX:s,scaleY:s,rotate:u,skewX:u,skewY:u};rt=a({constructor:function(t){var e=this.names=[],i=this.values=[];t.replace(/(\w+)\(([-.\d\s\w,]+)\)/g,function(t,n,r){e.push(n),i.push(r)})},identity:function(){var t=[];return d(this.names,function(e){var i=c[e];i&&t.push(e+"("+i()+")")}),t.join(" ")},sameType:function(t){return this.names.toString()===t.names.toString()},decompose:function(){var t=this.toString();k.style.cssText=x+b(it)+":"+t+";",document.body.appendChild(k);var e=w(k)(it);return e&&"none"!==e||(e="matrix(1, 0, 0, 1, 0, 0)"),document.body.removeChild(k),r(e)}}),rt.prototype.toString=function(t){var e=this.values,i=[];return d(this.names,function(n,r){var o=c[n];if(o){var a=o(e[r]);t&&a===o()||i.push(n+"("+a+")")}}),i.length?i.join(" "):"none"},rt.union=function(t,e){if(t!==e){var i,n;if("none"===t?(n=new rt(e),e=n.toString(),t=n.identity(),i=new rt(t)):"none"===e?(i=new rt(t),t=i.toString(),e=i.identity(),n=new rt(e)):(i=new rt(t),t=i.toString(),n=new rt(e),e=n.toString()),t!==e&&(i.sameType(n)||(t=i.decompose(),e=n.decompose()),t!==e))return[t,e]}},nt=V.transform=function(t){return t&&"none"!==t?new rt(n.test(t)?r(t):t).toString(!0):"none"},q.transform=function(){var t=this.style;return t[it]||(t[it]=nt(w(this)(it)))}}();var ot,at=function(t,e,i){var n=V[e]||H,r=X(e).call(t),i=n(i,!0);if(r!==i){if(n===M||n===R||n===B){var o=i.match(I),a=0;o&&(r=r.replace(I,function(e,i,n){var r=o[a++],s=r.match(A),l=s[2];if(n!==l){var u="px"===n?i:S(t,n)*i;return y(u/S(t,l))+l}return e})),a>0&&Y(e).call(t,r)}else if(n===nt)return rt.union(r,i);return r!==i?[r,i]:null}},st=a({inherits:m,constructor:function dt(t,e){var i=X(e),n=Y(e);this.get=function(){return i.call(t)},this.set=function(e){return n.call(t,e)},dt.parent.constructor.call(this,this.set),this.node=t,this.property=e}});ot=a({inherits:st,constructor:function pt(){return pt.parent.constructor.apply(this,arguments)},start:function(t){if(this.stop(),0===this.duration)return this.cancel(t),this;var e=at(this.node,this.property,t);if(!e)return this.cancel(t),this;if(ot.parent.start.apply(this,e),!this.cancelStep)return this;var i=V[this.property]||H;return i!==Z&&i!==tt&&i!==H||this.templateFrom===this.templateTo||(this.cancelStep(),delete this.cancelStep,this.cancel(t)),this},parseEquation:function(t){return"string"==typeof t?ot.parent.parseEquation.call(this,t):void 0}});var lt=function(t,e,i,n){var r=p(e,t);-1!==r&&(e.splice(r,1),i.splice(r,1),n.splice(r,1))},ut=a({inherits:st,constructor:function ft(t,e){ft.parent.constructor.call(this,t,e),this.hproperty=b(W[e]||e);var i=this;this.bSetTransitionCSS=function(t){i.setTransitionCSS(t)},this.bSetStyleCSS=function(t){i.setStyleCSS(t)},this.bComplete=function(){i.complete()}},start:function(t){if(this.stop(),0===this.duration)return this.cancel(t),this;var e=at(this.node,this.property,t);return e?(this.to=e[1],this.cancelSetTransitionCSS=o(this.bSetTransitionCSS),this):(this.cancel(t),this)},setTransitionCSS:function(t){delete this.cancelSetTransitionCSS,this.resetCSS(!0),this.cancelSetStyleCSS=o(this.bSetStyleCSS)},setStyleCSS:function(t){delete this.cancelSetStyleCSS;var e=this.duration;this.cancelComplete=setTimeout(this.bComplete,e),this.endTime=t+e,this.set(this.to)},complete:function(){delete this.cancelComplete,this.resetCSS(),this.callback(this.endTime)},stop:function(t){return this.cancelExit?(this.cancelExit(),delete this.cancelExit):this.cancelSetTransitionCSS?(this.cancelSetTransitionCSS(),delete this.cancelSetTransitionCSS):this.cancelSetStyleCSS?(this.cancelSetStyleCSS(),delete this.cancelSetStyleCSS,t&&this.resetCSS()):this.cancelComplete&&(clearTimeout(this.cancelComplete),delete this.cancelComplete,t&&(this.resetCSS(),this.set(this.get()))),this},resetCSS:function(t){var e=w(this.node),i=(e(et+"Property").replace(/\s+/g,"")||"all").split(","),n=(e(et+"Duration").replace(/\s+/g,"")||"0s").split(","),r=(e(et+"TimingFunction").replace(/\s+/g,"")||"ease").match(/cubic-bezier\([\d-.,]+\)|([a-z-]+)/g);

lt("all",i,n,r),lt(this.hproperty,i,n,r),t&&(i.push(this.hproperty),n.push(this.duration+"ms"),r.push("cubic-bezier("+this.equation+")"));var o=this.node.style;o[et+"Property"]=i,o[et+"Duration"]=n,o[et+"TimingFunction"]=r},parseEquation:function(t){return"string"==typeof t?ut.parent.parseEquation.call(this,t,!0):void 0}}),ct=et?ut:ot,ht=function(t,e){return"function"==typeof t?m(t):f(t,e)};f.implement({animate:function(t,e,i){var n=t,r=e;"string"==typeof t&&(n={},n[t]=e,r=i),null==r&&(r={});var o=typeof r;r="function"===o?{callback:r}:"string"===o||"number"===o?{duration:r}:r;var a=r.callback||function(){},l=0,u=0;r.callback=function(t){++l===u&&a(t)};for(var c in n){var h=n[c],c=s(c);this.forEach(function(t){u++;var e=f(t),i=e._animations||(e._animations={}),n=i[c]||(i[c]=new ct(t,c));n.setOptions(r).start(h)})}return this},style:function(t,e){var i=t;"string"==typeof t&&(i={},i[t]=e);for(var n in i){var r=i[n],o=Y(n=s(n));this.forEach(function(t){var e,i=f(t),a=i._animations;a&&(e=a[n])&&e.stop(!0),o.call(t,r)})}return this},compute:function(t){t=s(t);var e=this[0];if("transform"===t&&nt)return w(e)(it);var i=X(t).call(e);return null!=i?i.replace(I,function(t,i,n){return"px"===n?t:S(e,n)*i+"px"}):""}}),ht.parse=function(t,e,i){return(V[s(t)]||H)(e,i)},e.exports=ht}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./color":115,"./frame":116,"./fx":117,"./unmatrix2d":118,elements:120,prime:127,"prime/array/forEach":123,"prime/array/indexOf":124,"prime/array/map":125,"prime/string/camelize":134,"prime/string/capitalize":135,"prime/string/clean":136,"prime/string/hyphenate":137}],115:[function(t,e,i){"use strict";var n={maroon:"#800000",red:"#ff0000",orange:"#ffA500",yellow:"#ffff00",olive:"#808000",purple:"#800080",fuchsia:"#ff00ff",white:"#ffffff",lime:"#00ff00",green:"#008000",navy:"#000080",blue:"#0000ff",aqua:"#00ffff",teal:"#008080",black:"#000000",silver:"#c0c0c0",gray:"#808080",transparent:"#0000"},r=function(t,e,i,n){return(null==n||""===n)&&(n=1),t=parseFloat(t),e=parseFloat(e),i=parseFloat(i),n=parseFloat(n),255>=t&&t>=0&&255>=e&&e>=0&&255>=i&&i>=0&&1>=n&&n>=0?[Math.round(t),Math.round(e),Math.round(i),n]:null},o=function(t){if(3===t.length&&(t+="f"),4===t.length){var e=t.charAt(0),i=t.charAt(1),n=t.charAt(2),r=t.charAt(3);t=e+e+i+i+n+n+r+r}6===t.length&&(t+="ff");for(var o=[],a=0,s=t.length;s>a;a+=2)o.push(parseInt(t.substr(a,2),16)/(6===a?255:1));return o},a=function(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+(e-t)*(2/3-i)*6:t},s=function(t,e,i,n){var r,o,s;if((null==n||""===n)&&(n=1),t=parseFloat(t)/360,e=parseFloat(e)/100,i=parseFloat(i)/100,n=parseFloat(n)/1,t>1||0>t||e>1||0>e||i>1||0>i||n>1||0>n)return null;if(0===e)r=o=s=i;else{var l=.5>i?i*(1+e):i+e-i*e,u=2*i-l;r=a(u,l,t+1/3),s=a(u,l,t),o=a(u,l,t-1/3)}return[255*r,255*s,255*o,n]},l=[];for(var u in n)l.push(u);var c="(?:#([a-f0-9]{3,8}))",h="\\s*([.\\d%]+)\\s*",d="(?:,\\s*([.\\d]+)\\s*)?",p="\\("+[h,h,h]+d+"\\)",f="(?:rgb)a?",m="(?:hsl)a?",g="("+l.join("|")+")",v=RegExp(c,"i"),b=RegExp(f+p,"i"),y=RegExp(m+p,"i"),w=function(t,e){if(null==t)return null;t=(t+"").replace(/\s+/,"");var i=n[t];if(i)return w(i,e);if(i=t.match(v))t=o(i[1]);else if(i=t.match(b))t=i.slice(1);else{if(!(i=t.match(y)))return null;t=s.apply(null,i.slice(1))}return t&&(t=r.apply(null,t))?e?t:(1===t[3]&&t.splice(3,1),"rgb"+(4===t.length?"a":"")+"("+t+")"):null};w.x=RegExp([g,c,f+p,m+p].join("|"),"gi"),e.exports=w},{}],116:[function(t,e,i){(function(e){"use strict";var n=t("prime/array/indexOf"),r=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){return setTimeout(function(){t()},1e3/60)},o=[],a=function(t){for(var e=o.splice(0,o.length),i=0,n=e.length;n>i;i++)e[i](t||(t=+new Date))},s=function(t){var e=n(o,t);e>-1&&o.splice(e,1)},l=function(t){var e=o.push(t);return 1===e&&r(a),function(){s(t)}};i.request=l,i.cancel=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"prime/array/indexOf":124}],117:[function(t,e,i){"use strict";var n=t("prime"),r=t("./frame").request,o=t("cubic-bezier"),a=t("prime/array/map"),s="([\\d.]+)(s|ms)?",l="cubic-bezier\\(([-.\\d]+),([-.\\d]+),([-.\\d]+),([-.\\d]+)\\)",u=RegExp(s),c=RegExp(l),h=(RegExp(l,"g"),{"default":"cubic-bezier(0.25, 0.1, 0.25, 1.0)",linear:"cubic-bezier(0, 0, 1, 1)","ease-in":"cubic-bezier(0.42, 0, 1.0, 1.0)","ease-out":"cubic-bezier(0, 0, 0.58, 1.0)","ease-in-out":"cubic-bezier(0.42, 0, 0.58, 1.0)"});h.ease=h["default"];var d=function(t,e,i){return(e-t)*i+t},p=function(t){var e=[],i=(t+"").replace(/[-.\d]+/g,function(t){return e.push(+t),"@"});return[e,i]},f=n({constructor:function(t,e){this.setOptions(e),this.render=t||function(){};var i=this;this.bStep=function(t){return i.step(t)},this.bExit=function(t){i.exit(t)}},setOptions:function(t){if(null==t&&(t={}),!(this.duration=this.parseDuration(t.duration||"500ms")))throw new Error("invalid duration");if(!(this.equation=this.parseEquation(t.equation||"default")))throw new Error("invalid equation");return this.callback=t.callback||function(){},this},parseDuration:function(t){if(t=(t+"").match(u)){var e=+t[1],i=t[2]||"ms";if("s"===i)return 1e3*e;if("ms"===i)return e}},parseEquation:function(t,e){var i=typeof t;if("function"===i)return t;if("string"===i){t=h[t]||t;var n=t.replace(/\s+/g,"").match(c);if(n){if(t=a(n.slice(1),function(t){return+t}),e)return t;if("0,0,1,1"===t.toString())return function(t){return t};i="object"}}return"object"===i?o(t[0],t[1],t[2],t[3],1e3/60/this.duration/4):void 0},cancel:function(t){this.to=t,this.cancelExit=r(this.bExit)},exit:function(t){this.render(this.to),delete this.cancelExit,this.callback(t)},start:function(t,e){if(this.stop(),0===this.duration)return this.cancel(e),this;this.isArray=!1,this.isNumber=!1;var i=typeof t,n=typeof e;"object"===i&&"object"===n?this.isArray=!0:"number"===i&&"number"===n&&(this.isNumber=!0);var o=p(t),a=p(e);return this.from=o[0],this.to=a[0],this.templateFrom=o[1],this.templateTo=a[1],this.from.length!==this.to.length||this.from.toString()===this.to.toString()?(this.cancel(e),this):(delete this.time,this.length=this.from.length,this.cancelStep=r(this.bStep),this)},stop:function(){return this.cancelExit?(this.cancelExit(),delete this.cancelExit):this.cancelStep&&(this.cancelStep(),delete this.cancelStep),this},step:function(t){this.time||(this.time=t);var e=(t-this.time)/this.duration;e>1&&(e=1);for(var i=this.equation(e),n=this.from,o=this.to,a=this.templateTo,s=0,l=this.length;l>s;s++){var u=n[s],c=o[s];a=a.replace("@",c!==u?d(u,c,i):c)}this.render(this.isArray?a.split(","):this.isNumber?+a:a,e),1!==e?this.cancelStep=r(this.bStep):(delete this.cancelStep,this.callback(t))}}),m=function(t){var e=new f(t);return{start:function(t,i,n){var r=typeof n;return e.setOptions("function"===r?{callback:n}:"string"===r||"number"===r?{duration:n}:n).start(t,i),this},stop:function(){return e.stop(),this}}};m.prototype=f.prototype,e.exports=m},{"./frame":116,"cubic-bezier":119,prime:127,"prime/array/map":125}],118:[function(t,e,i){"use strict";var n=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},r=function(t){var e=n(t);return e?[t[0]/e,t[1]/e]:[0,0]},o=function(t,e){return t[0]*e[0]+t[1]*e[1]},a=Math.atan2,s=function(t,e,i,n){return[i*t[0]+n*e[0],i*t[1]+n*e[1]]};e.exports=function(t,e,i,l,u,c){if(t*l-e*i===0)return!1;var h=[u,c],d=[[t,e],[i,l]],p=[n(d[0])];d[0]=r(d[0]);var f=o(d[0],d[1]);d[1]=s(d[1],d[0],1,-f),p[1]=n(d[1]),f/=p[1];var m=a(d[0][1],d[0][0]);return[h,m,f,p]}},{}],119:[function(t,e,i){e.exports=function(t,e,i,n,r){var o=function(e){var n=1-e;return 3*n*n*e*t+3*n*e*e*i+e*e*e},a=function(t){var i=1-t;return 3*i*i*t*e+3*i*t*t*n+t*t*t},s=function(e){var n=1-e;return 3*(2*(e-1)*e+n*n)*t+3*(-e*e*e+2*n*e)*i};return function(t){var e,i,n,l,u,c,h=t;for(n=h,c=0;8>c;c++){if(l=o(n)-h,Math.abs(l)<r)return a(n);if(u=s(n),Math.abs(u)<1e-6)break;n-=l/u}if(e=0,i=1,n=h,e>n)return a(e);if(n>i)return a(i);for(;i>e;){if(l=o(n),Math.abs(l-h)<r)return a(n);h>l?e=n:i=n,n=.5*(i-e)+e}return a(n)}}},{}],120:[function(t,e,i){(function(i){"use strict";var n=t("prime"),r=t("prime/array/forEach"),o=t("prime/array/map"),a=t("prime/array/filter"),s=t("prime/array/every"),l=t("prime/array/some"),u=0,c=function(t){return t===i?"global":t.uniqueNumber||(t.uniqueNumber="n:"+(u++).toString(36))},h={},d=n({constructor:function f(t,e){if(null==t)return this&&this.constructor===f?new p:null;var n=t;if(t.constructor!==p){n=new p;var r;if("string"==typeof t)return n.search?(n[n.length++]=e||document,n.search(t)):null;if(t.nodeType||t===i)n[n.length++]=t;else if(t.length)for(var o={},a=0,s=t.length;s>a;a++){var l=f(t[a],e);if(l&&l.length)for(var u=0,d=l.length;d>u;u++){var m=l[u];r=c(m),o[r]||(n[n.length++]=m,o[r]=!0)}}}return n.length?1===n.length?(r=c(n[0]),h[r]||(h[r]=n)):n:null}}),p=n({inherits:d,constructor:function(){this.length=0},unlink:function(){return this.map(function(t,e){return delete h[c(t)],t})},forEach:function(t,e){return r(this,t,e)},map:function(t,e){return o(this,t,e)},filter:function(t,e){return a(this,t,e)},every:function(t,e){return s(this,t,e)},some:function(t,e){return l(this,t,e)}});e.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{prime:127,"prime/array/every":121,"prime/array/filter":122,"prime/array/forEach":123,"prime/array/map":125,"prime/array/some":126}],121:[function(t,e,i){"use strict";var n=function(t,e,i){for(var n=0,r=t.length>>>0;r>n;n++)if(!e.call(i,t[n],n,t))return!1;return!0};e.exports=n},{}],122:[function(t,e,i){"use strict";var n=function(t,e,i){for(var n=[],r=0,o=t.length>>>0;o>r;r++){var a=t[r];e.call(i,a,r,t)&&n.push(a)}return n};e.exports=n},{}],123:[function(t,e,i){"use strict";var n=function(t,e,i){for(var n=0,r=t.length>>>0;r>n&&e.call(i,t[n],n,t)!==!1;n++);return t};e.exports=n},{}],124:[function(t,e,i){"use strict";var n=function(t,e,i){for(var n=t.length>>>0,r=0>i?Math.max(0,n+i):i||0;n>r;r++)if(t[r]===e)return r;return-1};e.exports=n},{}],125:[function(t,e,i){"use strict";var n=function(t,e,i){for(var n=t.length>>>0,r=Array(n),o=0,a=n;a>o;o++)r[o]=e.call(i,t[o],o,t);return r};e.exports=n},{}],126:[function(t,e,i){"use strict";var n=function(t,e,i){for(var n=0,r=t.length>>>0;r>n;n++)if(e.call(i,t[n],n,t))return!0;return!1};e.exports=n},{}],127:[function(t,e,i){"use strict";var n=t("./object/hasOwn"),r=t("./object/forIn"),o=t("./object/mixIn"),a=t("./object/filter"),s=t("./object/create"),l=t("./type"),u=Object.defineProperty,c=Object.getOwnPropertyDescriptor;try{u({},"~",{}),c({},"~")}catch(h){u=null,c=null}var d=function(t,e,i){u(this,e,c(i,e)||{writable:!0,enumerable:!0,configurable:!0,value:t})},p=function(t,e){this[e]=t},f=function(t){return r(t,u?d:p,this.prototype),this},m=/^constructor|inherits|mixin$/,g=function(t){"function"===l(t)&&(t={constructor:t});var e=t.inherits,i=n(t,"constructor")?t.constructor:e?function(){return e.apply(this,arguments)}:function(){};if(e){o(i,e);var r=e.prototype,u=i.prototype=s(r);i.parent=r,u.constructor=i}i.implement||(i.implement=f);var c=t.mixin;if(c){"array"!==l(c)&&(c=[c]);for(var h=0;h<c.length;h++)i.implement(s(c[h].prototype))}return i.implement(a(t,function(t,e){return!e.match(m)}))};e.exports=g},{"./object/create":128,"./object/filter":129,"./object/forIn":130,"./object/hasOwn":132,"./object/mixIn":133,"./type":139}],128:[function(t,e,i){"use strict";var n=function(t){var e=function(){};return e.prototype=t,new e};e.exports=n},{}],129:[function(t,e,i){"use strict";var n=t("./forIn"),r=function(t,e,i){var r={};return n(t,function(n,o){e.call(i,n,o,t)&&(r[o]=n)}),r};e.exports=r},{"./forIn":130}],130:[function(t,e,i){"use strict";var n=t("./hasOwn"),r=function(t,e,i){for(var n in t)if(e.call(i,t[n],n,t)===!1)break;return t};if(!{valueOf:0}.propertyIsEnumerable("valueOf")){var o="constructor,toString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString".split(","),a=Object.prototype;r=function(t,e,i){for(var r in t)if(e.call(i,t[r],r,t)===!1)return t;for(var s=0;r=o[s];s++){var l=t[r];if((l!==a[r]||n(t,r))&&e.call(i,l,r,t)===!1)break}return t}}e.exports=r},{"./hasOwn":132}],131:[function(t,e,i){"use strict";var n=t("./forIn"),r=t("./hasOwn"),o=function(t,e,i){return n(t,function(n,o){return r(t,o)?e.call(i,n,o,t):void 0}),t};e.exports=o},{"./forIn":130,"./hasOwn":132}],132:[function(t,e,i){"use strict";var n=Object.hasOwnProperty,r=function(t,e){return n.call(t,e)};e.exports=r},{}],133:[function(t,e,i){"use strict";var n=t("./forOwn"),r=function(t,e){this[e]=t},o=function(t){for(var e=1,i=arguments.length;i>e;e++)n(arguments[e],r,t);return t};e.exports=o},{"./forOwn":131}],134:[function(t,e,i){"use strict";var n=function(t){return(t+"").replace(/-\D/g,function(t){return t.charAt(1).toUpperCase()})};e.exports=n},{}],135:[function(t,e,i){"use strict";var n=function(t){return(t+"").replace(/\b[a-z]/g,function(t){return t.toUpperCase()})};e.exports=n},{}],136:[function(t,e,i){"use strict";var n=t("./trim"),r=function(t){return n((t+"").replace(/\s+/g," "))};e.exports=r},{"./trim":138}],137:[function(t,e,i){"use strict";var n=function(t){return(t+"").replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})};e.exports=n},{}],138:[function(t,e,i){"use strict";var n=function(t){return(t+"").replace(/^\s+|\s+$/g,"")};e.exports=n},{}],139:[function(t,e,i){"use strict";var n=Object.prototype.toString,r=/number|object|array|string|function|date|regexp|boolean/,o=function(t){if(null==t)return"null";var e=n.call(t).slice(8,-1).toLowerCase();return"number"===e&&isNaN(t)?"null":r.test(e)?e:"object"};e.exports=o},{}],140:[function(t,e,i){function n(t,e){if(null==e)return t;for(var i=t.length,n=-1,r=e.length;++n<r;)t[i+n]=e[n];return t}e.exports=n},{}],141:[function(t,e,i){function n(t,e){if(null==e)return t;for(var i=-1,n=e.length;++i<n;)-1===r(t,e[i])&&t.push(e[i]);return t}var r=t("./indexOf");e.exports=n},{"./indexOf":151}],142:[function(t,e,i){function n(t,e){return-1!==r(t,e)}var r=t("./indexOf");e.exports=n},{"./indexOf":151}],143:[function(t,e,i){function n(t){var e=l(arguments,1),i=o(r(t),function(t){return!a(e,function(e){return s(e,t)})});return i}var r=t("./unique"),o=t("./filter"),a=t("./some"),s=t("./contains"),l=t("./slice");e.exports=n},{"./contains":142,"./filter":146,"./slice":159,"./some":160,"./unique":162}],144:[function(t,e,i){function n(t,e,i){return i=i||o,a(t)&&a(e)?t.length!==e.length?!1:s(t,r(i),e):i(t,e)}function r(t){return function(e,i){return i in this&&t(e,this[i])}}var o=t("../lang/is"),a=t("../lang/isArray"),s=t("./every");e.exports=n},{"../lang/is":176,"../lang/isArray":177,"./every":145}],145:[function(t,e,i){arguments[4][90][0].apply(i,arguments)},{"../function/makeIterator_":170,dup:90}],146:[function(t,e,i){arguments[4][91][0].apply(i,arguments)},{"../function/makeIterator_":170,dup:91}],147:[function(t,e,i){function n(t,e,i){var n=r(t,e,i);return n>=0?t[n]:void 0}var r=t("./findIndex");e.exports=n},{"./findIndex":148}],148:[function(t,e,i){function n(t,e,i){if(e=r(e,i),null==t)return-1;for(var n=-1,o=t.length;++n<o;)if(e(t[n],n,t))return n;return-1}var r=t("../function/makeIterator_");e.exports=n},{"../function/makeIterator_":170}],149:[function(t,e,i){function n(t,e,i){if(null==t)return e;if(0===i)return a(e,t),e;for(var r,s=-1,l=t.length;++s<l;)r=t[s],o(r)?n(r,e,i-1):e.push(r);return e}function r(t,e){return e=null==e?-1:e,n(t,[],e)}var o=t("../lang/isArray"),a=t("./append");e.exports=r},{"../lang/isArray":177,"./append":140}],150:[function(t,e,i){arguments[4][62][0].apply(i,arguments)},{dup:62}],151:[function(t,e,i){arguments[4][63][0].apply(i,arguments)},{dup:63}],152:[function(t,e,i){function n(t,e){var i=r(o(arguments,1),t);return i.length&&Array.prototype.push.apply(t,i),t.length}var r=t("./difference"),o=t("./slice");e.exports=n},{"./difference":143,"./slice":159}],153:[function(t,e,i){function n(t){var e=l(arguments,1),i=o(r(t),function(t){return a(e,function(e){return s(e,t)})});return i}var r=t("./unique"),o=t("./filter"),a=t("./every"),s=t("./contains"),l=t("./slice");e.exports=n},{"./contains":142,"./every":145,"./filter":146,"./slice":159,"./unique":162}],154:[function(t,e,i){function n(t,e,i){if(null==t)return t;for(var n,o=r(arguments,2),a=-1,s=t.length;++a<s;)n=t[a],n[e].apply(n,o);return t}var r=t("./slice");e.exports=n},{"./slice":159}],155:[function(t,e,i){function n(t){return null==t||t.length<1?void 0:t[t.length-1]}e.exports=n},{}],156:[function(t,e,i){arguments[4][94][0].apply(i,arguments)},{"../function/makeIterator_":170,dup:94}],157:[function(t,e,i){function n(t,e){return r(t,e)}var r=t("./map");e.exports=n},{"./map":156}],158:[function(t,e,i){function n(t,e){for(var i=r(t,e);-1!==i;)t.splice(i,1),i=r(t,e,i)}var r=t("./indexOf");e.exports=n},{"./indexOf":151}],159:[function(t,e,i){function n(t,e,i){var n=t.length;e=null==e?0:0>e?Math.max(n+e,0):Math.min(e,n),i=null==i?n:0>i?Math.max(n+i,0):Math.min(i,n);for(var r=[];i>e;)r.push(t[e++]);return r}e.exports=n},{}],160:[function(t,e,i){arguments[4][95][0].apply(i,arguments)},{"../function/makeIterator_":170,dup:95}],161:[function(t,e,i){function n(t,e){e=e||2;var i=[];if(null==t)return i;for(var n,r=Math.floor(t.length/e),o=t.length%e,a=0,s=t.length,l=0;s>a;)n=r,o>l&&n++,i.push(t.slice(a,a+n)),l++,a+=n;return i}e.exports=n},{}],162:[function(t,e,i){function n(t,e){return e=e||r,o(t,function(t,i,n){for(var r=n.length;++i<r;)if(e(t,n[i]))return!1;return!0})}function r(t,e){return t===e}var o=t("./filter");e.exports=n},{"./filter":146}],163:[function(t,e,i){var n=t("./make_"),r=t("../array/find"),o=t("../object/find");e.exports=n(r,o)},{"../array/find":147,"../object/find":201,"./make_":165}],164:[function(t,e,i){var n=t("./make_"),r=t("../array/forEach"),o=t("../object/forOwn");e.exports=n(r,o)},{"../array/forEach":150,"../object/forOwn":203,"./make_":165}],165:[function(t,e,i){function n(t,e,i){return function(){var n=r(arguments);return null==n[0]?i:"number"==typeof n[0].length?t.apply(null,n):e.apply(null,n)}}var r=t("../array/slice");e.exports=n},{"../array/slice":159}],166:[function(t,e,i){function n(t){return t?r(t)?t.length:o(t):0}var r=t("../lang/isArray"),o=t("../object/size");e.exports=n},{"../lang/isArray":177,"../object/size":213}],167:[function(t,e,i){function n(t,e,i){var n=r(arguments,2);return function(){return t.apply(e,n.concat(r(arguments)))}}var r=t("../array/slice");e.exports=n},{"../array/slice":159}],168:[function(t,e,i){function n(t,e,i){function n(){function n(){i||(o=t.apply(s,a)),r=null}var a=arguments,s=this;return r?clearTimeout(r):i&&(o=t.apply(s,a)),r=setTimeout(n,e),o}var r,o;return n.cancel=function(){clearTimeout(r)},n}e.exports=n},{}],169:[function(t,e,i){arguments[4][96][0].apply(i,arguments)},{dup:96}],170:[function(t,e,i){arguments[4][97][0].apply(i,arguments)},{"../object/deepMatches":198,"./identity":169,"./prop":171,dup:97}],171:[function(t,e,i){arguments[4][98][0].apply(i,arguments)},{dup:98}],172:[function(t,e,i){function n(){var t=arguments;return function(){for(var e=0,i=t.length;i>e;)t[e].apply(this,arguments),e+=1}}e.exports=n},{}],173:[function(t,e,i){function n(t){switch(l(t)){case"Object":return r(t);case"Array":return s(t);case"RegExp":return o(t);case"Date":return a(t);default:return t}}function r(t){return u(t)?c({},t):t}function o(t){var e="";return e+=t.multiline?"m":"",e+=t.global?"g":"",e+=t.ignoreCase?"i":"",new RegExp(t.source,e)}function a(t){return new Date(+t)}function s(t){return t.slice()}var l=t("./kindOf"),u=t("./isPlainObject"),c=t("../object/mixIn");e.exports=n},{"../object/mixIn":209,"./isPlainObject":183,"./kindOf":186}],174:[function(t,e,i){function n(t,e){switch(l(t)){case"Object":return r(t,e);case"Array":return o(t,e);default:return a(t)}}function r(t,e){if(u(t)){var i={};return s(t,function(t,i){this[i]=n(t,e)},i),i}return e?e(t):t}function o(t,e){for(var i=[],r=-1,o=t.length;++r<o;)i[r]=n(t[r],e);return i}var a=t("./clone"),s=t("../object/forOwn"),l=t("./kindOf"),u=t("./isPlainObject");e.exports=n},{"../object/forOwn":203,"./clone":173,"./isPlainObject":183,"./kindOf":186}],175:[function(t,e,i){function n(t,e,i){function u(t,e){return n(t,e,i)}i=i||r;var c=o(t)&&o(e),h=!c&&a(t)&&a(e);if(!c&&!h)return i(t,e);var d=c?s:l;return d(t,e,u)}var r=t("./is"),o=t("./isObject"),a=t("./isArray"),s=t("../object/equals"),l=t("../array/equals");e.exports=n},{"../array/equals":144,"../object/equals":199,"./is":176,"./isArray":177,"./isObject":182}],176:[function(t,e,i){function n(t,e){return t===e?0!==t||1/t===1/e:t!==t&&e!==e}e.exports=n},{}],177:[function(t,e,i){arguments[4][65][0].apply(i,arguments)},{"./isKind":180,dup:65}],178:[function(t,e,i){function n(t){return r(t,"Boolean")}var r=t("./isKind");e.exports=n},{"./isKind":180}],179:[function(t,e,i){arguments[4][66][0].apply(i,arguments)},{"./isKind":180,dup:66}],180:[function(t,e,i){arguments[4][67][0].apply(i,arguments)},{"./kindOf":186,dup:67}],181:[function(t,e,i){function n(t){return r(t,"Number")}var r=t("./isKind");e.exports=n},{"./isKind":180}],182:[function(t,e,i){arguments[4][68][0].apply(i,arguments)},{"./isKind":180,dup:68}],183:[function(t,e,i){function n(t){return!!t&&"object"==typeof t&&t.constructor===Object}e.exports=n},{}],184:[function(t,e,i){function n(t){switch(typeof t){case"string":case"number":case"boolean":return!0}return null==t}e.exports=n},{}],185:[function(t,e,i){arguments[4][69][0].apply(i,arguments)},{"./isKind":180,dup:69}],186:[function(t,e,i){arguments[4][70][0].apply(i,arguments)},{dup:70}],187:[function(t,e,i){function n(t){return"number"==typeof t?t:t?"string"==typeof t?parseFloat(t):r(t)?0/0:Number(t):0}var r=t("./isArray");e.exports=n},{"./isArray":177}],188:[function(t,e,i){arguments[4][71][0].apply(i,arguments)},{dup:71}],189:[function(t,e,i){function n(t,e,i){return e>t?e:t>i?i:t}e.exports=n},{}],190:[function(t,e,i){function n(t,e,i){return e+(i-e)*t}e.exports=n},{}],191:[function(t,e,i){function n(t,e,i,n,a){return r(o(t,e,i),n,a)}var r=t("./lerp"),o=t("./norm");e.exports=n},{"./lerp":190,"./norm":192}],192:[function(t,e,i){function n(t,e,i){if(e>t||t>i)throw new RangeError("value ("+t+") must be between "+e+" and "+i);return t===i?1:(t-e)/(i-e)}e.exports=n},{}],193:[function(t,e,i){e.exports=2147483647},{}],194:[function(t,e,i){e.exports=-2147483648},{}],195:[function(t,e,i){function n(t,e){t=r(t);var i=Math.pow(10,e);return+(Math.round(t*i)/i).toFixed(e)}var r=t("../lang/toNumber");e.exports=n},{"../lang/toNumber":187}],196:[function(t,e,i){function n(t){return~~t}e.exports=n},{}],197:[function(t,e,i){function n(t,e){for(var i,a=0,s=arguments.length;++a<s;)i=arguments[a],i&&r(i,function(e,i){var r=t[i];null==r?t[i]=e:o(r)&&o(e)&&n(r,e)});return t}var r=t("./forOwn"),o=t("../lang/isPlainObject");e.exports=n},{"../lang/isPlainObject":183,"./forOwn":203}],198:[function(t,e,i){arguments[4][103][0].apply(i,arguments)},{"../lang/isArray":177,"./forOwn":203,dup:103}],199:[function(t,e,i){function n(t){return function(e,i){return a(this,i)&&t(e,this[i])}}function r(t,e){return a(this,e)}function o(t,e,i){return i=i||u,l(t)&&l(e)?s(t,n(i),e)&&s(e,r,t):i(t,e)}var a=t("./hasOwn"),s=t("./every"),l=t("../lang/isObject"),u=t("../lang/is");e.exports=o},{"../lang/is":176,"../lang/isObject":182,"./every":200,"./hasOwn":206}],200:[function(t,e,i){function n(t,e,i){e=o(e,i);var n=!0;return r(t,function(i,r){return e(i,r,t)?void 0:(n=!1,!1)}),n}var r=t("./forOwn"),o=t("../function/makeIterator_");e.exports=n},{"../function/makeIterator_":170,"./forOwn":203}],201:[function(t,e,i){function n(t,e,i){e=o(e,i);var n;return r(t,function(t,i,r){return e(t,i,r)?(n=t,!0):void 0}),n}var r=t("./some"),o=t("../function/makeIterator_");e.exports=n},{"../function/makeIterator_":170,"./some":214}],202:[function(t,e,i){arguments[4][72][0].apply(i,arguments)},{"./hasOwn":206,dup:72}],203:[function(t,e,i){arguments[4][73][0].apply(i,arguments)},{"./forIn":202,"./hasOwn":206,dup:73}],204:[function(t,e,i){function n(t,e){for(var i=e.split("."),n=i.pop();e=i.shift();)if(t=t[e],null==t)return;return t[n]}t("../lang/isPrimitive");e.exports=n},{"../lang/isPrimitive":184}],205:[function(t,e,i){function n(t,e){return o(t,e)!==r}var r,o=t("./get");e.exports=n},{"./get":204}],206:[function(t,e,i){arguments[4][74][0].apply(i,arguments)},{dup:74}],207:[function(t,e,i){var n=t("./forOwn"),r=Object.keys||function(t){var e=[];return n(t,function(t,i){e.push(i)}),e};e.exports=r},{"./forOwn":203}],208:[function(t,e,i){function n(){var t,e,i,s,l=1;for(s=o(arguments[0]);i=arguments[l++];)for(t in i)r(i,t)&&(e=i[t],s[t]=a(e)&&a(s[t])?n(s[t],e):o(e));return s}var r=t("./hasOwn"),o=t("../lang/deepClone"),a=t("../lang/isObject");e.exports=n},{"../lang/deepClone":174,"../lang/isObject":182,"./hasOwn":206}],209:[function(t,e,i){arguments[4][75][0].apply(i,arguments)},{"./forOwn":203,dup:75}],210:[function(t,e,i){function n(t,e){return e?(r(e.split("."),function(e){t[e]||(t[e]={}),t=t[e]}),t):t}var r=t("../array/forEach");e.exports=n},{"../array/forEach":150}],211:[function(t,e,i){function n(t,e){var i="string"!=typeof arguments[1]?arguments[1]:r(arguments,1),n={};for(var a in t)t.hasOwnProperty(a)&&!o(i,a)&&(n[a]=t[a]);return n}var r=t("../array/slice"),o=t("../array/contains");e.exports=n},{"../array/contains":142,"../array/slice":159}],212:[function(t,e,i){function n(t,e,i){var n=/^(.+)\.(.+)$/.exec(e);n?r(t,n[1])[n[2]]=i:t[e]=i}var r=t("./namespace");e.exports=n},{"./namespace":210}],213:[function(t,e,i){function n(t){var e=0;return r(t,function(){e++}),e}var r=t("./forOwn");e.exports=n},{"./forOwn":203}],214:[function(t,e,i){function n(t,e,i){e=o(e,i);var n=!1;return r(t,function(i,r){return e(i,r,t)?(n=!0,!1):void 0}),n}var r=t("./forOwn"),o=t("../function/makeIterator_");e.exports=n},{"../function/makeIterator_":170,"./forOwn":203}],215:[function(t,e,i){function n(t,e){if(r(t,e)){for(var i=e.split("."),n=i.pop();e=i.shift();)t=t[e];return delete t[n]}return!0}var r=t("./has");e.exports=n},{"./has":205}],216:[function(t,e,i){function n(t){var e=[];return r(t,function(t,i){e.push(t)}),e}var r=t("./forOwn");e.exports=n},{"./forOwn":203}],217:[function(t,e,i){function n(t){var e,i,n=[];return r(t,function(t,r){o(t)?(e=r+"=",i=new RegExp("&"+r+"+=$"),a(t,function(t){e+=encodeURIComponent(t)+"&"+r+"="}),n.push(e.replace(i,""))):n.push(r+"="+encodeURIComponent(t))}),n.length?"?"+n.join("&"):""}var r=t("../object/forOwn"),o=t("../lang/isArray"),a=t("../array/forEach");e.exports=n},{"../array/forEach":150,"../lang/isArray":177,"../object/forOwn":203}],218:[function(t,e,i){function n(t,e,i){t=t||"";var n=new RegExp("(\\?|&)"+e+"=[^&]*"),r=e+"="+encodeURIComponent(i);return n.test(t)?t.replace(n,"$1"+r):(-1===t.indexOf("?")&&(t+="?"),-1!==t.indexOf("=")&&(t+="&"),t+r)}e.exports=n},{}],219:[function(t,e,i){function n(t){var e=1===arguments.length&&o(t)?t:arguments;return e[r(0,e.length-1)]}var r=t("./randInt"),o=t("../lang/isArray");e.exports=n},{"../lang/isArray":177,"./randInt":223}],220:[function(t,e,i){function n(){return r(8)+"-"+r(4)+"-4"+r(3)+"-"+o(8,9,"a","b")+r(3)+"-"+r(12)}var r=t("./randHex"),o=t("./choice");e.exports=n},{"./choice":219,"./randHex":222}],221:[function(t,e,i){function n(t,e){return t=null==t?o:t,e=null==e?a:e,t+(e-t)*r()}var r=t("./random"),o=t("../number/MIN_INT"),a=t("../number/MAX_INT");e.exports=n},{"../number/MAX_INT":193,"../number/MIN_INT":194,"./random":224}],222:[function(t,e,i){function n(t){t=t&&t>0?t:6;for(var e="";t--;)e+=r(o);return e}var r=t("./choice"),o="0123456789abcdef".split("");e.exports=n},{"./choice":219}],223:[function(t,e,i){function n(t,e){return t=null==t?r:~~t,e=null==e?o:~~e,Math.round(a(t-.5,e+.499999999999))}var r=t("../number/MIN_INT"),o=t("../number/MAX_INT"),a=t("./rand");e.exports=n},{"../number/MAX_INT":193,"../number/MIN_INT":194,"./rand":221}],224:[function(t,e,i){function n(){return n.get()}n.get=Math.random,e.exports=n},{}],225:[function(t,e,i){arguments[4][76][0].apply(i,arguments)},{dup:76}],226:[function(t,e,i){function n(t,e,i){return t=r(t),e=r(e),-1!==t.indexOf(e,i)}var r=t("../lang/toString");e.exports=n},{"../lang/toString":188}],227:[function(t,e,i){function n(t){return t=r(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")}var r=t("../lang/toString");e.exports=n},{"../lang/toString":188}],228:[function(t,e,i){function n(t,e){return t=r(t),t.replace(/[\s\S]/g,function(t){return!e&&/[\x20-\x7E]/.test(t)?t:"\\u"+("000"+t.charCodeAt(0).toString(16)).slice(-4)})}var r=t("../lang/toString");e.exports=n},{"../lang/toString":188}],229:[function(t,e,i){function n(t,e,i){t=r(t);var n=function(t,i){return r(o(e,i))};return t.replace(i||a,n)}var r=t("../lang/toString"),o=t("../object/get"),a=/\{\{([^\}]+)\}\}/g;e.exports=n},{"../lang/toString":188,"../object/get":204}],230:[function(t,e,i){function n(t){return t=r(t),t.toLowerCase()}var r=t("../lang/toString");e.exports=n},{"../lang/toString":188}],231:[function(t,e,i){arguments[4][77][0].apply(i,arguments)},{"../lang/toString":188,"./WHITE_SPACES":225,dup:77}],232:[function(t,e,i){function n(t){return t=r(t),o(t).replace(/^\w|\s\w/g,a)}var r=t("../lang/toString"),o=t("./lowerCase"),a=t("./upperCase");e.exports=n},{"../lang/toString":188,"./lowerCase":230,"./upperCase":239}],233:[function(t,e,i){function n(t,e){var i="";if(t=r(t),e=o(e),1>e)return"";for(;e>0;)e%2&&(i+=t),e=Math.floor(e/2),t+=t;return i}var r=t("../lang/toString"),o=t("../number/toInt");e.exports=n},{"../lang/toString":188,"../number/toInt":196}],234:[function(t,e,i){function n(t,e,i){return t=r(t),i=i||" ",t.length<e?t+o(i,e-t.length):t}var r=t("../lang/toString"),o=t("./repeat");e.exports=n},{"../lang/toString":188,"./repeat":233}],235:[function(t,e,i){arguments[4][78][0].apply(i,arguments)},{"../lang/toString":188,"./WHITE_SPACES":225,dup:78}],236:[function(t,e,i){arguments[4][79][0].apply(i,arguments)},{"../lang/toString":188,"./WHITE_SPACES":225,"./ltrim":231,"./rtrim":235,dup:79}],237:[function(t,e,i){function n(t){return t=r(t).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#0*39;/g,"'").replace(/&quot;/g,'"')}var r=t("../lang/toString");e.exports=n},{"../lang/toString":188}],238:[function(t,e,i){function n(t){return t=r(t),t.replace(/(\w)(-)(\w)/g,"$1 $3")}var r=t("../lang/toString");e.exports=n},{"../lang/toString":188}],239:[function(t,e,i){arguments[4][80][0].apply(i,arguments)},{"../lang/toString":188,dup:80}],240:[function(t,e,i){arguments[4][159][0].apply(i,arguments)},{dup:159}],241:[function(t,e,i){arguments[4][167][0].apply(i,arguments)},{"../array/slice":240,dup:167}],242:[function(t,e,i){function n(t){switch(l(t)){case"Object":return r(t);case"Array":return s(t);case"RegExp":return o(t);case"Date":return a(t);default:return t}}function r(t){return u(t)?c({},t):t}function o(t){var e="";return e+=t.multiline?"m":"",e+=t.global?"g":"",e+=t.ignorecase?"i":"",new RegExp(t.source,e)}function a(t){return new Date(+t)}function s(t){return t.slice()}var l=t("./kindOf"),u=t("./isPlainObject"),c=t("../object/mixIn");e.exports=n},{"../object/mixIn":252,"./isPlainObject":246,"./kindOf":247}],243:[function(t,e,i){arguments[4][174][0].apply(i,arguments)},{"../object/forOwn":249,"./clone":242,"./isPlainObject":246,"./kindOf":247,dup:174}],244:[function(t,e,i){arguments[4][67][0].apply(i,arguments)},{"./kindOf":247,dup:67}],245:[function(t,e,i){arguments[4][68][0].apply(i,arguments)},{"./isKind":244,dup:68}],246:[function(t,e,i){arguments[4][183][0].apply(i,arguments)},{dup:183}],247:[function(t,e,i){arguments[4][70][0].apply(i,arguments)},{dup:70}],248:[function(t,e,i){arguments[4][72][0].apply(i,arguments)},{"./hasOwn":250,dup:72}],249:[function(t,e,i){arguments[4][73][0].apply(i,arguments)},{"./forIn":248,"./hasOwn":250,dup:73}],250:[function(t,e,i){arguments[4][74][0].apply(i,arguments)},{dup:74}],251:[function(t,e,i){
arguments[4][208][0].apply(i,arguments)},{"../lang/deepClone":243,"../lang/isObject":245,"./hasOwn":250,dup:208}],252:[function(t,e,i){arguments[4][75][0].apply(i,arguments)},{"./forOwn":249,dup:75}],253:[function(t,e,i){"use strict";var n=t("prime"),r=t("mout/function/bind"),o=n({bound:function(t){var e=this._bound||(this._bound={});return e[t]||(e[t]=r(this[t],this))}});e.exports=o},{"mout/function/bind":241,prime:257}],254:[function(t,e,i){"use strict";var n=t("prime"),r=t("mout/object/merge"),o=n({setOptions:function(t){var e=[{},this.options];return e.push.apply(e,arguments),this.options=r.apply(null,e),this}});e.exports=o},{"mout/object/merge":251,prime:257}],255:[function(t,e,i){(function(i,n){"use strict";var r=t("mout/lang/kindOf"),o=t("mout/time/now"),a=t("mout/array/forEach"),s=t("mout/array/indexOf"),l={timeout:{},frame:[],immediate:[]},u=function(t,e,i,n){var r=function(){c(t)};t.length||n(r);var o={callback:e,context:i};return t.push(o),function(){var e=s(t,o);e>-1&&t.splice(e,1)}},c=function(t){var e=o();a(t.splice(0),function(t){t.callback.call(t.context,e)})},h=function(t,e,i){return"Number"===r(e)?h.timeout(t,e,i):h.immediate(t,e)};n.process&&i.nextTick?h.immediate=function(t,e){return u(l.immediate,t,e,i.nextTick)}:n.setImmediate?h.immediate=function(t,e){return u(l.immediate,t,e,setImmediate)}:n.postMessage&&n.addEventListener?(addEventListener("message",function(t){t.source===n&&"@deferred"===t.data&&(t.stopPropagation(),c(l.immediate))},!0),h.immediate=function(t,e){return u(l.immediate,t,e,function(){postMessage("@deferred","*")})}):h.immediate=function(t,e){return u(l.immediate,t,e,function(t){setTimeout(t,0)})};var d=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)};h.frame=function(t,e){return u(l.frame,t,e,d)};var p;h.timeout=function(t,e,i){var n=l.timeout;return p||(p=h.immediate(function(){p=null,l.timeout={}})),u(n[e]||(n[e]=[]),t,i,function(t){setTimeout(t,e)})},e.exports=h}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:2,"mout/array/forEach":259,"mout/array/indexOf":260,"mout/lang/kindOf":262,"mout/time/now":267}],256:[function(t,e,i){"use strict";var n=t("mout/array/indexOf"),r=t("mout/array/forEach"),o=t("./index"),a=t("./defer"),s=Array.prototype.slice,l=o({on:function(t,e){var i=this._listeners||(this._listeners={}),r=i[t]||(i[t]=[]);return-1===n(r,e)&&r.push(e),this},off:function(t,e){var i,r=this._listeners;if(r&&(i=r[t])){var o=n(i,e);o>-1&&i.splice(o,1),i.length||delete r[t];for(var a in r)return this;delete this._listeners}return this},emit:function(t){var e=this,i=s.call(arguments,1),n=function(){var n,o=e._listeners;o&&(n=o[t])&&r(n.slice(0),function(t){return t.apply(e,i)})};return i[i.length-1]===l.EMIT_SYNC?(i.pop(),n()):a(n),this}});l.EMIT_SYNC={},e.exports=l},{"./defer":255,"./index":257,"mout/array/forEach":259,"mout/array/indexOf":260}],257:[function(t,e,i){"use strict";var n=t("mout/object/hasOwn"),r=t("mout/object/mixIn"),o=t("mout/lang/createObject"),a=t("mout/lang/kindOf"),s=!0;try{Object.defineProperty({},"~",{}),Object.getOwnPropertyDescriptor({},"~")}catch(l){s=!1}var u=!{valueOf:0}.propertyIsEnumerable("valueOf"),c=["toString","valueOf"],h=/^constructor|inherits|mixin$/,d=function(t){var e=this.prototype;for(var i in t)if(!i.match(h)){if(s){var n=Object.getOwnPropertyDescriptor(t,i);if(n){Object.defineProperty(e,i,n);continue}}e[i]=t[i]}if(u)for(var r=0;i=c[r];r++){var o=t[i];o!==Object.prototype[i]&&(e[i]=o)}return this},p=function(t){"Function"===a(t)&&(t={constructor:t});var e=t.inherits,i=n(t,"constructor")?t.constructor:e?function(){return e.apply(this,arguments)}:function(){};if(e){r(i,e);var s=e.prototype,l=i.prototype=o(s);i.parent=s,l.constructor=i}i.implement||(i.implement=d);var u=t.mixin;if(u){"Array"!==a(u)&&(u=[u]);for(var c=0;c<u.length;c++)i.implement(o(u[c].prototype))}return i.implement(t)};e.exports=p},{"mout/lang/createObject":261,"mout/lang/kindOf":262,"mout/object/hasOwn":265,"mout/object/mixIn":266}],258:[function(t,e,i){"use strict";var n=t("mout/array/indexOf"),r=t("./index"),o=r({constructor:function(){this.length=0,this._values=[],this._keys=[]},set:function(t,e){var i=n(this._keys,t);return-1===i?(this._keys.push(t),this._values.push(e),this.length++):this._values[i]=e,this},get:function(t){var e=n(this._keys,t);return-1===e?null:this._values[e]},count:function(){return this.length},forEach:function(t,e){for(var i=0,n=this.length;n>i&&t.call(e,this._values[i],this._keys[i],this)!==!1;i++);return this},map:function(t,e){var i=new o;return this.forEach(function(n,r){i.set(r,t.call(e,n,r,this))},this),i},filter:function(t,e){var i=new o;return this.forEach(function(n,r){t.call(e,n,r,this)&&i.set(r,n)},this),i},every:function(t,e){var i=!0;return this.forEach(function(n,r){return t.call(e,n,r,this)?void 0:i=!1},this),i},some:function(t,e){var i=!1;return this.forEach(function(n,r){return t.call(e,n,r,this)?!(i=!0):void 0},this),i},indexOf:function(t){var e=n(this._values,t);return e>-1?this._keys[e]:null},remove:function(t){var e=n(this._values,t);return-1!==e?(this._values.splice(e,1),this.length--,this._keys.splice(e,1)[0]):null},unset:function(t){var e=n(this._keys,t);return-1!==e?(this._keys.splice(e,1),this.length--,this._values.splice(e,1)[0]):null},keys:function(){return this._keys.slice()},values:function(){return this._values.slice()}}),a=function(){return new o};a.prototype=o.prototype,e.exports=a},{"./index":257,"mout/array/indexOf":260}],259:[function(t,e,i){arguments[4][62][0].apply(i,arguments)},{dup:62}],260:[function(t,e,i){arguments[4][63][0].apply(i,arguments)},{dup:63}],261:[function(t,e,i){function n(t,e){function i(){}return i.prototype=t,r(new i,e)}var r=t("../object/mixIn");e.exports=n},{"../object/mixIn":266}],262:[function(t,e,i){arguments[4][70][0].apply(i,arguments)},{dup:70}],263:[function(t,e,i){arguments[4][72][0].apply(i,arguments)},{"./hasOwn":265,dup:72}],264:[function(t,e,i){arguments[4][73][0].apply(i,arguments)},{"./forIn":263,"./hasOwn":265,dup:73}],265:[function(t,e,i){arguments[4][74][0].apply(i,arguments)},{dup:74}],266:[function(t,e,i){arguments[4][75][0].apply(i,arguments)},{"./forOwn":264,dup:75}],267:[function(t,e,i){function n(){return n.get()}n.get="function"==typeof Date.now?Date.now:function(){return+new Date},e.exports=n},{}],268:[function(t,e,i){!function(t,n){"function"==typeof define&&define.amd?define(n):"object"==typeof i?e.exports=n():t.Sifter=n()}(this,function(){var t=function(t,e){this.items=t,this.settings=e||{diacritics:!0}};t.prototype.tokenize=function(t){if(t=n(String(t||"").toLowerCase()),!t||!t.length)return[];var e,i,o,s,l=[],u=t.split(/ +/);for(e=0,i=u.length;i>e;e++){if(o=r(u[e]),this.settings.diacritics)for(s in a)a.hasOwnProperty(s)&&(o=o.replace(new RegExp(s,"g"),a[s]));l.push({string:u[e],regex:new RegExp(o,"i")})}return l},t.prototype.iterator=function(t,e){var i;i=o(t)?Array.prototype.forEach||function(t){for(var e=0,i=this.length;i>e;e++)t(this[e],e,this)}:function(t){for(var e in this)this.hasOwnProperty(e)&&t(this[e],e,this)},i.apply(t,[e])},t.prototype.getScoreFunction=function(t,e){var i,n,r,o;i=this,t=i.prepareSearch(t,e),r=t.tokens,n=t.options.fields,o=r.length;var a=function(t,e){var i,n;return t?(t=String(t||""),n=t.search(e.regex),-1===n?0:(i=e.string.length/t.length,0===n&&(i+=.5),i)):0},s=function(){var t=n.length;return t?1===t?function(t,e){return a(e[n[0]],t)}:function(e,i){for(var r=0,o=0;t>r;r++)o+=a(i[n[r]],e);return o/t}:function(){return 0}}();return o?1===o?function(t){return s(r[0],t)}:"and"===t.options.conjunction?function(t){for(var e,i=0,n=0;o>i;i++){if(e=s(r[i],t),0>=e)return 0;n+=e}return n/o}:function(t){for(var e=0,i=0;o>e;e++)i+=s(r[e],t);return i/o}:function(){return 0}},t.prototype.getSortFunction=function(t,i){var n,r,o,a,s,l,u,c,h,d,p;if(o=this,t=o.prepareSearch(t,i),p=!t.query&&i.sort_empty||i.sort,h=function(t,e){return"$score"===t?e.score:o.items[e.id][t]},s=[],p)for(n=0,r=p.length;r>n;n++)(t.query||"$score"!==p[n].field)&&s.push(p[n]);if(t.query){for(d=!0,n=0,r=s.length;r>n;n++)if("$score"===s[n].field){d=!1;break}d&&s.unshift({field:"$score",direction:"desc"})}else for(n=0,r=s.length;r>n;n++)if("$score"===s[n].field){s.splice(n,1);break}for(c=[],n=0,r=s.length;r>n;n++)c.push("desc"===s[n].direction?-1:1);return l=s.length,l?1===l?(a=s[0].field,u=c[0],function(t,i){return u*e(h(a,t),h(a,i))}):function(t,i){var n,r,o;for(n=0;l>n;n++)if(o=s[n].field,r=c[n]*e(h(o,t),h(o,i)))return r;return 0}:null},t.prototype.prepareSearch=function(t,e){if("object"==typeof t)return t;e=i({},e);var n=e.fields,r=e.sort,a=e.sort_empty;return n&&!o(n)&&(e.fields=[n]),r&&!o(r)&&(e.sort=[r]),a&&!o(a)&&(e.sort_empty=[a]),{options:e,query:String(t||"").toLowerCase(),tokens:this.tokenize(t),total:0,items:[]}},t.prototype.search=function(t,e){var i,n,r,o,a=this;return n=this.prepareSearch(t,e),e=n.options,t=n.query,o=e.score||a.getScoreFunction(n),t.length?a.iterator(a.items,function(t,r){i=o(t),(e.filter===!1||i>0)&&n.items.push({score:i,id:r})}):a.iterator(a.items,function(t,e){n.items.push({score:1,id:e})}),r=a.getSortFunction(n,e),r&&n.items.sort(r),n.total=n.items.length,"number"==typeof e.limit&&(n.items=n.items.slice(0,e.limit)),n};var e=function(t,e){return"number"==typeof t&&"number"==typeof e?t>e?1:e>t?-1:0:(t=s(String(t||"")),e=s(String(e||"")),t>e?1:e>t?-1:0)},i=function(t,e){var i,n,r,o;for(i=1,n=arguments.length;n>i;i++)if(o=arguments[i])for(r in o)o.hasOwnProperty(r)&&(t[r]=o[r]);return t},n=function(t){return(t+"").replace(/^\s+|\s+$|/g,"")},r=function(t){return(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},o=Array.isArray||$&&$.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},a={a:"[a]",c:"[c]",d:"[d]",e:"[e]",i:"[i]",l:"[l]",n:"[n]",o:"[o]",r:"[r]",s:"[s]",t:"[t]",u:"[u]",y:"[y]",z:"[z]"},s=function(){var t,e,i,n,r="",o={};for(i in a)if(a.hasOwnProperty(i))for(n=a[i].substring(2,a[i].length-1),r+=n,t=0,e=n.length;e>t;t++)o[n.charAt(t)]=i;var s=new RegExp("["+r+"]","g");return function(t){return t.replace(s,function(t){return o[t]}).toLowerCase()}}();return t})},{}],269:[function(t,e,i){"use strict";var n=t("./parser"),r=0,o=document.__counter=(parseInt(document.__counter||-1,36)+1).toString(36),a="uid:"+o,s=function(t,e){if(t===window)return"window";if(t===document)return"document";if(t===document.documentElement)return"html";if(e){var i=t.getAttribute(a);return i||(i=(r++).toString(36),t.setAttribute(a,i)),i}return t[a]||(t[a]=(r++).toString(36))},l=function(t){return s(t,!0)},u=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},c=0,h={GET_ELEMENT_BY_ID:function(t,e){return e="slick_"+c++,t.innerHTML='<a id="'+e+'"></a>',!!this.getElementById(e)},QUERY_SELECTOR:function(t){return t.innerHTML="_<style>:nth-child(2){}</style>",t.innerHTML='<a class="MiX"></a>',1===t.querySelectorAll(".MiX").length},EXPANDOS:function(t,e){return e="slick_"+c++,t._custom_property_=e,t._custom_property_===e},MATCHES_SELECTOR:function(t){t.className="MiX";var e=t.matchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector;if(e)try{e.call(t,":slick")}catch(i){return e.call(t,".MiX")?e:!1}return!1},GET_ELEMENTS_BY_CLASS_NAME:function(t){return t.innerHTML='<a class="f"></a><a class="b"></a>',1!==t.getElementsByClassName("b").length?!1:(t.firstChild.className="b",2!==t.getElementsByClassName("b").length?!1:(t.innerHTML='<a class="a"></a><a class="f b a"></a>',2!==t.getElementsByClassName("a").length?!1:!0))},GET_ATTRIBUTE:function(t){var e="fus ro dah";return t.innerHTML='<a class="'+e+'"></a>',t.firstChild.getAttribute("class")===e}},d=function(t){this.document=t;var e=this.root=t.documentElement;this.tested={},this.uniqueID=this.has("EXPANDOS")?s:l,this.getAttribute=this.has("GET_ATTRIBUTE")?function(t,e){return t.getAttribute(e)}:function(t,e){return t=t.getAttributeNode(e),t&&t.specified?t.value:null},this.hasAttribute=e.hasAttribute?function(t,e){return t.hasAttribute(e)}:function(t,e){return t=t.getAttributeNode(e),!(!t||!t.specified)},this.contains=t.contains&&e.contains?function(t,e){return t.contains(e)}:e.compareDocumentPosition?function(t,e){return t===e||!!(16&t.compareDocumentPosition(e))}:function(t,e){do if(e===t)return!0;while(e=e.parentNode);return!1},this.sorter=e.compareDocumentPosition?function(t,e){return t.compareDocumentPosition&&e.compareDocumentPosition?4&t.compareDocumentPosition(e)?-1:t===e?0:1:0}:"sourceIndex"in e?function(t,e){return t.sourceIndex&&e.sourceIndex?t.sourceIndex-e.sourceIndex:0}:t.createRange?function(t,e){if(!t.ownerDocument||!e.ownerDocument)return 0;var i=t.ownerDocument.createRange(),n=e.ownerDocument.createRange();return i.setStart(t,0),i.setEnd(t,0),n.setStart(e,0),n.setEnd(e,0),i.compareBoundaryPoints(Range.START_TO_END,n)}:null,this.failed={};var i=this.has("MATCHES_SELECTOR");i&&(this.matchesSelector=function(t,e){if(this.failed[e])return null;try{return i.call(t,e)}catch(n){return v.debug&&console.warn("matchesSelector failed on "+e),this.failed[e]=!0,null}}),this.has("QUERY_SELECTOR")&&(this.querySelectorAll=function(t,e){if(this.failed[e])return!0;var i,n,r,o,a;if(t!==this.document&&(o=e[0].combinator,n=t.getAttribute("id"),r=e,n||(a=t,n="__slick__",a.setAttribute("id",n)),e="#"+n+" "+r,(o.indexOf("~")>-1||o.indexOf("+")>-1)&&(t=t.parentNode,t||(i=!0))),!i)try{i=t.querySelectorAll(e.toString())}catch(s){v.debug&&console.warn("querySelectorAll failed on "+(r||e)),i=this.failed[r||e]=!0}return a&&a.removeAttribute("id"),i})};d.prototype.has=function(t){var e=this.tested,i=e[t];if(null!=i)return i;var n=this.root,r=this.document,o=r.createElement("div");o.setAttribute("style","display: none;"),n.appendChild(o);var a=h[t],s=!1;if(a)try{s=a.call(r,o)}catch(l){}return v.debug&&!s&&console.warn("document has no "+t),n.removeChild(o),e[t]=s};var p={" ":function(t,e,i){var n,r,o=!e.id,a=!e.tag,s=!e.classes;if(e.id&&t.getElementById&&this.has("GET_ELEMENT_BY_ID")&&(n=t.getElementById(e.id),n&&n.getAttribute("id")===e.id&&(r=[n],o=!0,"*"===e.tag&&(a=!0))),!r&&(e.classes&&t.getElementsByClassName&&this.has("GET_ELEMENTS_BY_CLASS_NAME")?(r=t.getElementsByClassName(e.classList),s=!0,"*"===e.tag&&(a=!0)):(r=t.getElementsByTagName(e.tag),"*"!==e.tag&&(a=!0)),!r||!r.length))return!1;for(var l=0;n=r[l++];)(a&&o&&s&&!e.attributes&&!e.pseudos||this.match(n,e,a,o,s))&&i(n);return!0},">":function(t,e,i){if(t=t.firstChild)do 1==t.nodeType&&this.match(t,e)&&i(t);while(t=t.nextSibling)},"+":function(t,e,i){for(;t=t.nextSibling;)if(1==t.nodeType){this.match(t,e)&&i(t);break}},"^":function(t,e,i){t=t.firstChild,t&&(1===t.nodeType?this.match(t,e)&&i(t):p["+"].call(this,t,e,i))},"~":function(t,e,i){for(;t=t.nextSibling;)1===t.nodeType&&this.match(t,e)&&i(t)},"++":function(t,e,i){p["+"].call(this,t,e,i),p["!+"].call(this,t,e,i)},"~~":function(t,e,i){p["~"].call(this,t,e,i),p["!~"].call(this,t,e,i)},"!":function(t,e,i){for(;t=t.parentNode;)t!==this.document&&this.match(t,e)&&i(t)},"!>":function(t,e,i){t=t.parentNode,t!==this.document&&this.match(t,e)&&i(t)},"!+":function(t,e,i){for(;t=t.previousSibling;)if(1==t.nodeType){this.match(t,e)&&i(t);break}},"!^":function(t,e,i){t=t.lastChild,t&&(1==t.nodeType?this.match(t,e)&&i(t):p["!+"].call(this,t,e,i))},"!~":function(t,e,i){for(;t=t.previousSibling;)1===t.nodeType&&this.match(t,e)&&i(t)}};d.prototype.search=function(t,e,i){t?!t.nodeType&&t.document&&(t=t.document):t=this.document;var r=n(e);if(!r||!r.length)throw new Error("invalid expression");i||(i=[]);var o,a=u(i)?function(t){i[i.length]=t}:function(t){i[i.length++]=t};if(r.length>1){o={};var l=a;a=function(t){var e=s(t);o[e]||(o[e]=!0,l(t))}}var c,h,d;t:for(var f=0;e=r[f++];)if(v.noQSA||!this.querySelectorAll||(h=this.querySelectorAll(t,e),h===!0))if(1===e.length)d=e[0],p[d.combinator].call(this,t,d,a);else{for(var m,g,b,y=[t],w=function(t){var e=s(t);b[e]||(b[e]=!0,g[g.length]=t)},k=0;d=e[k++];){g=[],b={};for(var x=0;m=y[x++];)p[d.combinator].call(this,m,d,w);if(!g.length)continue t;y=g}if(0===f)i=g;else for(var S=0;S<g.length;S++)a(g[S])}else if(h&&h.length)for(var k=0;c=h[k++];)c.nodeName>"@"&&a(c);return o&&i&&i.length>1&&this.sort(i),i},d.prototype.sort=function(t){return this.sorter?Array.prototype.sort.call(t,this.sorter):t};var f={empty:function(){return!(this&&1===this.nodeType||(this.innerText||this.textContent||"").length)},not:function(t){return!v.matches(this,t)},contains:function(t){return(this.innerText||this.textContent||"").indexOf(t)>-1},"first-child":function(){for(var t=this;t=t.previousSibling;)if(1==t.nodeType)return!1;return!0},"last-child":function(){for(var t=this;t=t.nextSibling;)if(1==t.nodeType)return!1;return!0},"only-child":function(){for(var t=this;t=t.previousSibling;)if(1==t.nodeType)return!1;for(var e=this;e=e.nextSibling;)if(1==e.nodeType)return!1;return!0},"first-of-type":function(){for(var t=this,e=t.nodeName;t=t.previousSibling;)if(t.nodeName==e)return!1;return!0},"last-of-type":function(){for(var t=this,e=t.nodeName;t=t.nextSibling;)if(t.nodeName==e)return!1;return!0},"only-of-type":function(){for(var t=this,e=this.nodeName;t=t.previousSibling;)if(t.nodeName==e)return!1;for(var i=this;i=i.nextSibling;)if(i.nodeName==e)return!1;return!0},enabled:function(){return!this.disabled},disabled:function(){return this.disabled},checked:function(){return this.checked||this.selected},selected:function(){return this.selected},focus:function(){var t=this.ownerDocument;return t.activeElement===this&&(this.href||this.type||v.hasAttribute(this,"tabindex"))},root:function(){return this===this.ownerDocument.documentElement}};d.prototype.match=function(t,e,i,n,r){if(!v.noQSA&&this.matchesSelector){var o=this.matchesSelector(t,e);if(null!==o)return o}if(!i&&e.tag){var a=t.nodeName.toLowerCase();if("*"===e.tag){if("@">a)return!1}else if(a!=e.tag)return!1}if(!n&&e.id&&t.getAttribute("id")!==e.id)return!1;var s,l;if(!r&&e.classes){var u=this.getAttribute(t,"class");if(!u)return!1;for(l in e.classes)if(!RegExp("(^|\\s)"+e.classes[l]+"(\\s|$)").test(u))return!1}var c,h;if(e.attributes)for(s=0;l=e.attributes[s++];){var d=l.operator,p=l.escapedValue;if(c=l.name,h=l.value,d){var m=this.getAttribute(t,c);if(null==m)return!1;switch(d){case"^=":if(!RegExp("^"+p).test(m))return!1;break;case"$=":if(!RegExp(p+"$").test(m))return!1;break;case"~=":if(!RegExp("(^|\\s)"+p+"(\\s|$)").test(m))return!1;break;case"|=":if(!RegExp("^"+p+"(-|$)").test(m))return!1;break;case"=":if(m!==h)return!1;break;case"*=":if(-1===m.indexOf(h))return!1;break;default:return!1}}else if(!this.hasAttribute(t,c))return!1}if(e.pseudos)for(s=0;l=e.pseudos[s++];){if(c=l.name,h=l.value,f[c])return f[c].call(t,h);if(null!=h){if(this.getAttribute(t,c)!==h)return!1}else if(!this.hasAttribute(t,c))return!1}return!0},d.prototype.matches=function(t,e){var i=n(e);if(1===i.length&&1===i[0].length)return this.match(t,i[0][0]);if(!v.noQSA&&this.matchesSelector){var r=this.matchesSelector(t,i);if(null!==r)return r}for(var o,a=this.search(this.document,e,{length:0}),s=0;o=a[s++];)if(t===o)return!0;return!1};var m={},g=function(t){var e=t||document;if(e.ownerDocument?e=e.ownerDocument:e.document&&(e=e.document),9!==e.nodeType)throw new TypeError("invalid document");var i=s(e);return m[i]||(m[i]=new d(e))},v=function(t,e){return v.search(t,e)};v.search=function(t,e,i){return g(e).search(e,t,i)},v.find=function(t,e){return g(e).search(e,t)[0]||null},v.getAttribute=function(t,e){return g(t).getAttribute(t,e)},v.hasAttribute=function(t,e){return g(t).hasAttribute(t,e)},v.contains=function(t,e){return g(t).contains(t,e)},v.matches=function(t,e){return g(t).matches(t,e)},v.sort=function(t){return t&&t.length>1&&g(t[0]).sort(t),t},v.parse=n,e.exports=v},{"./parser":271}],270:[function(t,e,i){(function(i){"use strict";e.exports="document"in i?t("./finder"):{parse:t("./parser")}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./finder":269,"./parser":271}],271:[function(t,e,i){"use strict";var n=/([-.*+?^${}()|[\]\/\\])/g,r=/\\/g,o=function(t){return(t+"").replace(n,"\\$1")},a=function(t){return(t+"").replace(r,"")},s=RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|(:+)(<unicode>+)(?:\\((?:(?:([\"'])([^\\13]*)\\13)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+o(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])")),l=function(t){this.combinator=t||" ",this.tag="*"};l.prototype.toString=function(){if(!this.raw){var t,e,i="";if(i+=this.tag||"*",this.id&&(i+="#"+this.id),this.classes&&(i+="."+this.classList.join(".")),this.attributes)for(t=0;e=this.attributes[t++];)i+="["+e.name+(e.operator?e.operator+'"'+e.value+'"':"")+"]";if(this.pseudos)for(t=0;e=this.pseudos[t++];)i+=":"+e.name,e.value&&(i+="("+e.value+")");this.raw=i}return this.raw};var u=function(){this.length=0};u.prototype.toString=function(){if(!this.raw){for(var t,e="",i=0;t=this[i++];)1!==i&&(e+=" ")," "!==t.combinator&&(e+=t.combinator+" "),e+=t;this.raw=e}return this.raw};var c=function(t,e,i,n,r,s,c,h,d,p,f,m,g,v,b,y){var w,k;if((e||!this.length)&&(w=this[this.length++]=new u,e))return"";if(w||(w=this[this.length-1]),(i||n||!w.length)&&(k=w[w.length++]=new l(i)),k||(k=w[w.length-1]),r)k.tag=a(r);else if(s)k.id=a(s);else if(c){var x=a(c),S=k.classes||(k.classes={});if(!S[x]){S[x]=o(c);var C=k.classList||(k.classList=[]);C.push(x),C.sort()}}else g?(y=y||b,(k.pseudos||(k.pseudos=[])).push({type:1==m.length?"class":"element",name:a(g),escapedName:o(g),value:y?a(y):null,escapedValue:y?o(y):null})):h&&(f=f?o(f):null,(k.attributes||(k.attributes=[])).push({operator:d,name:a(h),escapedName:o(h),value:f?a(f):null,escapedValue:f?o(f):null}));return""},h=function(t){this.length=0;for(var e,i=this,n=t;t;){if(e=t.replace(s,function(){return c.apply(i,arguments)}),e===t)throw new Error(n+" is an invalid expression");t=e}};h.prototype.toString=function(){if(!this.raw){for(var t,e=[],i=0;t=this[i++];)e.push(t);this.raw=e.join(", ")}return this.raw};var d={},p=function(t){return null==t?null:(t=(""+t).replace(/^\s+|\s+$/g,""),d[t]||(d[t]=new h(t)))};e.exports=p},{}],272:[function(t,e,i){!function(t){"use strict";"function"==typeof define&&define.amd?define(t):"undefined"!=typeof e&&"undefined"!=typeof e.exports?e.exports=t():"undefined"!=typeof Package?Sortable=t():window.Sortable=t()}(function(){"use strict";function t(t,e){this.el=t,this.options=e=e||{};var n={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(t.nodeName)?"li":">*",ghostClass:"sortable-ghost",ignore:"a, img",filter:null,animation:0,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1};for(var r in n)!(r in e)&&(e[r]=n[r]);var a=e.group;a&&"object"==typeof a||(a=e.group={name:a}),["pull","put"].forEach(function(t){t in a||(a[t]=!0)}),P.forEach(function(n){e[n]=i(this,e[n]||R),o(t,n.substr(2).toLowerCase(),e[n])},this),e.groups=" "+a.name+(a.put.join?" "+a.put.join(" "):"")+" ",t[_]=e;for(var s in this)"_"===s.charAt(0)&&(this[s]=i(this,this[s]));o(t,"mousedown",this._onTapStart),o(t,"touchstart",this._onTapStart),o(t,"dragover",this),o(t,"dragenter",this),H.push(this._onDragOver),e.store&&this.sort(e.store.get(this))}function e(t){b&&b.state!==t&&(l(b,"display",t?"none":""),!t&&b.state&&y.insertBefore(b,g),b.state=t)}function i(t,e){var i=$.call(arguments,2);return e.bind?e.bind.apply(e,[t].concat(i)):function(){return e.apply(t,i.concat($.call(arguments)))}}function n(t,e,i){if(t){i=i||N,e=e.split(".");var n=e.shift().toUpperCase(),r=new RegExp("\\s("+e.join("|")+")\\s","g");do if(">*"===n&&t.parentNode===i||(""===n||t.nodeName.toUpperCase()==n)&&(!e.length||((" "+t.className+" ").match(r)||[]).length==e.length))return t;while(t!==i&&(t=t.parentNode))}return null}function r(t){t.dataTransfer.dropEffect="move",t.preventDefault()}function o(t,e,i){t.addEventListener(e,i,!1)}function a(t,e,i){t.removeEventListener(e,i,!1)}function s(t,e,i){if(t)if(t.classList)t.classList[i?"add":"remove"](e);else{var n=(" "+t.className+" ").replace(/\s+/g," ").replace(" "+e+" ","");t.className=n+(i?" "+e:"")}}function l(t,e,i){var n=t&&t.style;if(n){if(void 0===i)return N.defaultView&&N.defaultView.getComputedStyle?i=N.defaultView.getComputedStyle(t,""):t.currentStyle&&(i=t.currentStyle),void 0===e?i:i[e];e in n||(e="-webkit-"+e),n[e]=i+("string"==typeof i?"":"px")}}function u(t,e,i){if(t){var n=t.getElementsByTagName(e),r=0,o=n.length;if(i)for(;o>r;r++)i(n[r],r);return n}return[]}function c(t){t.draggable=!1}function h(){L=!1}function d(t,e){var i=t.lastElementChild,n=i.getBoundingClientRect();return e.clientY-(n.top+n.height)>5&&i}function p(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,i=e.length,n=0;i--;)n+=e.charCodeAt(i);return n.toString(36)}function f(t){for(var e=0;t&&(t=t.previousElementSibling);)"TEMPLATE"!==t.nodeName.toUpperCase()&&e++;return e}function m(t,e){var i,n;return function(){void 0===i&&(i=arguments,n=this,setTimeout(function(){1===i.length?t.call(n,i[0]):t.apply(n,i),i=void 0},e))}}var g,v,b,y,w,k,x,S,C,E,T,O,I,A,z={},_="Sortable"+(new Date).getTime(),D=window,N=D.document,F=D.parseInt,j=!!("draggable"in N.createElement("div")),L=!1,M=function(t,e,i,n,r,o){var a=N.createEvent("Event");a.initEvent(e,!0,!0),a.item=i||t,a.from=n||t,a.clone=b,a.oldIndex=r,a.newIndex=o,t.dispatchEvent(a)},P="onAdd onUpdate onRemove onStart onEnd onFilter onSort".split(" "),R=function(){},B=Math.abs,$=[].slice,H=[],q=m(function(t,e,i){if(i&&e.scroll){var n,r,o,a,s=e.scrollSensitivity,l=e.scrollSpeed,u=t.clientX,c=t.clientY,h=window.innerWidth,d=window.innerHeight;if(x!==i&&(k=e.scroll,x=i,k===!0)){k=i;do if(k.offsetWidth<k.scrollWidth||k.offsetHeight<k.scrollHeight)break;while(k=k.parentNode)}k&&(n=k,r=k.getBoundingClientRect(),o=(B(r.right-u)<=s)-(B(r.left-u)<=s),a=(B(r.bottom-c)<=s)-(B(r.top-c)<=s)),o||a||(o=(s>=h-u)-(s>=u),a=(s>=d-c)-(s>=c),(o||a)&&(n=D)),(z.vx!==o||z.vy!==a||z.el!==n)&&(z.el=n,z.vx=o,z.vy=a,clearInterval(z.pid),n&&(z.pid=setInterval(function(){n===D?D.scrollTo(D.scrollX+o*l,D.scrollY+a*l):(a&&(n.scrollTop+=a*l),o&&(n.scrollLeft+=o*l))},24)))}},30);return t.prototype={constructor:t,_dragStarted:function(){y&&g&&(s(g,this.options.ghostClass,!0),t.active=this,M(y,"start",g,y,E))},_onTapStart:function(t){var e=t.type,i=t.touches&&t.touches[0],r=(i||t).target,a=r,s=this.options,l=this.el,h=s.filter;if(!("mousedown"===e&&0!==t.button||s.disabled)&&(r=n(r,s.draggable,l))){if(E=f(r),"function"==typeof h){if(h.call(this,t,r,this))return M(a,"filter",r,l,E),void t.preventDefault()}else if(h&&(h=h.split(",").some(function(t){return t=n(a,t.trim(),l),t?(M(t,"filter",r,l,E),!0):void 0})))return void t.preventDefault();if((!s.handle||n(a,s.handle,l))&&r&&!g&&r.parentNode===l){I=t,y=this.el,g=r,w=g.nextSibling,O=this.options.group,g.draggable=!0,s.ignore.split(",").forEach(function(t){u(r,t.trim(),c)}),i&&(I={target:r,clientX:i.clientX,clientY:i.clientY},this._onDragStart(I,"touch"),t.preventDefault()),o(N,"mouseup",this._onDrop),o(N,"touchend",this._onDrop),o(N,"touchcancel",this._onDrop),o(g,"dragend",this),o(y,"dragstart",this._onDragStart),j||this._onDragStart(I,!0);try{N.selection?N.selection.empty():window.getSelection().removeAllRanges()}catch(d){}}}},_emulateDragOver:function(){if(A){l(v,"display","none");var t=N.elementFromPoint(A.clientX,A.clientY),e=t,i=" "+this.options.group.name,n=H.length;if(e)do{if(e[_]&&e[_].groups.indexOf(i)>-1){for(;n--;)H[n]({clientX:A.clientX,clientY:A.clientY,target:t,rootEl:e});break}t=e}while(e=e.parentNode);l(v,"display","")}},_onTouchMove:function(t){if(I){var e=t.touches?t.touches[0]:t,i=e.clientX-I.clientX,n=e.clientY-I.clientY,r=t.touches?"translate3d("+i+"px,"+n+"px,0)":"translate("+i+"px,"+n+"px)";A=e,l(v,"webkitTransform",r),l(v,"mozTransform",r),l(v,"msTransform",r),l(v,"transform",r),t.preventDefault()}},_onDragStart:function(t,e){var i=t.dataTransfer,n=this.options;if(this._offUpEvents(),"clone"==O.pull&&(b=g.cloneNode(!0),l(b,"display","none"),y.insertBefore(b,g)),e){var r,a=g.getBoundingClientRect(),s=l(g);v=g.cloneNode(!0),l(v,"top",a.top-F(s.marginTop,10)),l(v,"left",a.left-F(s.marginLeft,10)),l(v,"width",a.width),l(v,"height",a.height),l(v,"opacity","0.8"),l(v,"position","fixed"),l(v,"zIndex","100000"),y.appendChild(v),r=v.getBoundingClientRect(),l(v,"width",2*a.width-r.width),l(v,"height",2*a.height-r.height),"touch"===e?(o(N,"touchmove",this._onTouchMove),o(N,"touchend",this._onDrop),o(N,"touchcancel",this._onDrop)):(o(N,"mousemove",this._onTouchMove),o(N,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,150)}else i&&(i.effectAllowed="move",n.setData&&n.setData.call(this,i,g)),o(N,"drop",this);setTimeout(this._dragStarted,0)},_onDragOver:function(t){var i,r,o,a=this.el,s=this.options,u=s.group,c=u.put,p=O===u,f=s.sort;if(g&&(void 0!==t.preventDefault&&(t.preventDefault(),!s.dragoverBubble&&t.stopPropagation()),O&&!s.disabled&&(p?f||(o=!y.contains(g)):O.pull&&c&&(O.name===u.name||c.indexOf&&~c.indexOf(O.name)))&&(void 0===t.rootEl||t.rootEl===this.el))){if(q(t,s,this.el),L)return;if(i=n(t.target,s.draggable,a),r=g.getBoundingClientRect(),o)return e(!0),void(b||w?y.insertBefore(g,b||w):f||y.appendChild(g));if(0===a.children.length||a.children[0]===v||a===t.target&&(i=d(a,t))){if(i){if(i.animated)return;k=i.getBoundingClientRect()}e(p),a.appendChild(g),this._animate(r,g),i&&this._animate(k,i)}else if(i&&!i.animated&&i!==g&&void 0!==i.parentNode[_]){S!==i&&(S=i,C=l(i));var m,k=i.getBoundingClientRect(),x=k.right-k.left,E=k.bottom-k.top,T=/left|right|inline/.test(C.cssFloat+C.display),I=i.offsetWidth>g.offsetWidth,A=i.offsetHeight>g.offsetHeight,z=(T?(t.clientX-k.left)/x:(t.clientY-k.top)/E)>.5,D=i.nextElementSibling;L=!0,setTimeout(h,30),e(p),m=T?i.previousElementSibling===g&&!I||z&&I:D!==g&&!A||z&&A,m&&!D?a.appendChild(g):i.parentNode.insertBefore(g,m?D:i),this._animate(r,g),this._animate(k,i)}}},_animate:function(t,e){var i=this.options.animation;if(i){var n=e.getBoundingClientRect();l(e,"transition","none"),l(e,"transform","translate3d("+(t.left-n.left)+"px,"+(t.top-n.top)+"px,0)"),e.offsetWidth,l(e,"transition","all "+i+"ms"),l(e,"transform","translate3d(0,0,0)"),clearTimeout(e.animated),e.animated=setTimeout(function(){l(e,"transition",""),l(e,"transform",""),e.animated=!1},i)}},_offUpEvents:function(){a(N,"mouseup",this._onDrop),a(N,"touchmove",this._onTouchMove),a(N,"touchend",this._onDrop),a(N,"touchcancel",this._onDrop)},_onDrop:function(e){var i=this.el,n=this.options;clearInterval(this._loopId),clearInterval(z.pid),a(N,"drop",this),a(N,"mousemove",this._onTouchMove),a(i,"dragstart",this._onDragStart),this._offUpEvents(),e&&(e.preventDefault(),!n.dropBubble&&e.stopPropagation(),v&&v.parentNode.removeChild(v),g&&(a(g,"dragend",this),c(g),s(g,this.options.ghostClass,!1),y!==g.parentNode?(T=f(g),M(g.parentNode,"sort",g,y,E,T),M(y,"sort",g,y,E,T),M(g,"add",g,y,E,T),M(y,"remove",g,y,E,T)):(b&&b.parentNode.removeChild(b),g.nextSibling!==w&&(T=f(g),M(y,"update",g,y,E,T),M(y,"sort",g,y,E,T))),t.active&&M(y,"end",g,y,E,T)),y=g=v=w=b=k=x=I=A=S=C=O=t.active=null,this.save())},handleEvent:function(t){var e=t.type;"dragover"===e||"dragenter"===e?(this._onDragOver(t),r(t)):("drop"===e||"dragend"===e)&&this._onDrop(t)},toArray:function(){for(var t,e=[],i=this.el.children,r=0,o=i.length;o>r;r++)t=i[r],n(t,this.options.draggable,this.el)&&e.push(t.getAttribute("data-id")||p(t));return e},sort:function(t){var e={},i=this.el;this.toArray().forEach(function(t,r){
var o=i.children[r];n(o,this.options.draggable,i)&&(e[t]=o)},this),t.forEach(function(t){e[t]&&(i.removeChild(e[t]),i.appendChild(e[t]))})},save:function(){var t=this.options.store;t&&t.set(this)},closest:function(t,e){return n(t,e||this.options.draggable,this.el)},option:function(t,e){var i=this.options;return void 0===e?i[t]:void(i[t]=e)},destroy:function(){var t=this.el,e=this.options;P.forEach(function(i){a(t,i.substr(2).toLowerCase(),e[i])}),a(t,"mousedown",this._onTapStart),a(t,"touchstart",this._onTapStart),a(t,"dragover",this),a(t,"dragenter",this),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),H.splice(H.indexOf(this._onDragOver),1),this._onDrop(),this.el=null}},t.utils={on:o,off:a,css:l,find:u,bind:i,is:function(t,e){return!!n(t,e,t)},throttle:m,closest:n,toggleClass:s,dispatchEvent:M,index:f},t.version="1.1.1",t.create=function(e,i){return new t(e,i)},t})},{}]},{},[1]);